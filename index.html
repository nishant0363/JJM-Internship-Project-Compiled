<!DOCTYPE html>

<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Complete Python Code</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .pm { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation.Marker */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
  </style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
 * Mozilla scrollbar styling
 */

/* use standard opaque scrollbars for most nodes */
[data-jp-theme-scrollbars='true'] {
  scrollbar-color: rgb(var(--jp-scrollbar-thumb-color))
    var(--jp-scrollbar-background-color);
}

/* for code nodes, use a transparent style of scrollbar. These selectors
 * will match lower in the tree, and so will override the above */
[data-jp-theme-scrollbars='true'] .CodeMirror-hscrollbar,
[data-jp-theme-scrollbars='true'] .CodeMirror-vscrollbar {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
}

/* tiny scrollbar */

.jp-scrollbar-tiny {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
  scrollbar-width: thin;
}

/* tiny scrollbar */

.jp-scrollbar-tiny::-webkit-scrollbar,
.jp-scrollbar-tiny::-webkit-scrollbar-corner {
  background-color: transparent;
  height: 4px;
  width: 4px;
}

.jp-scrollbar-tiny::-webkit-scrollbar-thumb {
  background: rgba(var(--jp-scrollbar-thumb-color), 0.5);
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:horizontal {
  border-left: 0 solid transparent;
  border-right: 0 solid transparent;
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:vertical {
  border-top: 0 solid transparent;
  border-bottom: 0 solid transparent;
}

/*
 * Lumino
 */

.lm-ScrollBar[data-orientation='horizontal'] {
  min-height: 16px;
  max-height: 16px;
  min-width: 45px;
  border-top: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] {
  min-width: 16px;
  max-width: 16px;
  min-height: 45px;
  border-left: 1px solid #a0a0a0;
}

.lm-ScrollBar-button {
  background-color: #f0f0f0;
  background-position: center center;
  min-height: 15px;
  max-height: 15px;
  min-width: 15px;
  max-width: 15px;
}

.lm-ScrollBar-button:hover {
  background-color: #dadada;
}

.lm-ScrollBar-button.lm-mod-active {
  background-color: #cdcdcd;
}

.lm-ScrollBar-track {
  background: #f0f0f0;
}

.lm-ScrollBar-thumb {
  background: #cdcdcd;
}

.lm-ScrollBar-thumb:hover {
  background: #bababa;
}

.lm-ScrollBar-thumb.lm-mod-active {
  background: #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-thumb {
  height: 100%;
  min-width: 15px;
  border-left: 1px solid #a0a0a0;
  border-right: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-thumb {
  width: 100%;
  min-height: 15px;
  border-top: 1px solid #a0a0a0;
  border-bottom: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-left);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-right);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-up);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-down);
  background-size: 17px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Widget {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

.lm-Widget.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.lm-AccordionPanel[data-orientation='horizontal'] > .lm-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  display: flex;
  flex-direction: column;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-CommandPalette-search {
  flex: 0 0 auto;
}

.lm-CommandPalette-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  min-height: 0;
  overflow: auto;
  list-style-type: none;
}

.lm-CommandPalette-header {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-CommandPalette-item {
  display: flex;
  flex-direction: row;
}

.lm-CommandPalette-itemIcon {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemContent {
  flex: 1 1 auto;
  overflow: hidden;
}

.lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemLabel {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-close-icon {
  border: 1px solid transparent;
  background-color: transparent;
  position: absolute;
  z-index: 1;
  right: 3%;
  top: 0;
  bottom: 0;
  margin: auto;
  padding: 7px 0;
  display: none;
  vertical-align: middle;
  outline: 0;
  cursor: pointer;
}
.lm-close-icon:after {
  content: 'X';
  display: block;
  width: 15px;
  height: 15px;
  text-align: center;
  color: #000;
  font-weight: normal;
  font-size: 12px;
  cursor: pointer;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-DockPanel {
  z-index: 0;
}

.lm-DockPanel-widget {
  z-index: 0;
}

.lm-DockPanel-tabBar {
  z-index: 1;
}

.lm-DockPanel-handle {
  z-index: 2;
}

.lm-DockPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-DockPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-DockPanel-handle[data-orientation='horizontal'] {
  cursor: ew-resize;
}

.lm-DockPanel-handle[data-orientation='vertical'] {
  cursor: ns-resize;
}

.lm-DockPanel-handle[data-orientation='horizontal']:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-DockPanel-handle[data-orientation='vertical']:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

.lm-DockPanel-overlay {
  z-index: 3;
  box-sizing: border-box;
  pointer-events: none;
}

.lm-DockPanel-overlay.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Menu {
  z-index: 10000;
  position: absolute;
  white-space: nowrap;
  overflow-x: hidden;
  overflow-y: auto;
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-Menu-content {
  margin: 0;
  padding: 0;
  display: table;
  list-style-type: none;
}

.lm-Menu-item {
  display: table-row;
}

.lm-Menu-item.lm-mod-hidden,
.lm-Menu-item.lm-mod-collapsed {
  display: none !important;
}

.lm-Menu-itemIcon,
.lm-Menu-itemSubmenuIcon {
  display: table-cell;
  text-align: center;
}

.lm-Menu-itemLabel {
  display: table-cell;
  text-align: left;
}

.lm-Menu-itemShortcut {
  display: table-cell;
  text-align: right;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-MenuBar {
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-MenuBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  list-style-type: none;
}

.lm-MenuBar-item {
  box-sizing: border-box;
}

.lm-MenuBar-itemIcon,
.lm-MenuBar-itemLabel {
  display: inline-block;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-ScrollBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-ScrollBar[data-orientation='horizontal'] {
  flex-direction: row;
}

.lm-ScrollBar[data-orientation='vertical'] {
  flex-direction: column;
}

.lm-ScrollBar-button {
  box-sizing: border-box;
  flex: 0 0 auto;
}

.lm-ScrollBar-track {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
}

.lm-ScrollBar-thumb {
  box-sizing: border-box;
  position: absolute;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-SplitPanel-child {
  z-index: 0;
}

.lm-SplitPanel-handle {
  z-index: 1;
}

.lm-SplitPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-SplitPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle {
  cursor: ew-resize;
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle {
  cursor: ns-resize;
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
  align-items: flex-end;
}

.lm-TabBar[data-orientation='vertical'] {
  flex-direction: column;
  align-items: flex-end;
}

.lm-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}

.lm-TabBar[data-orientation='horizontal'] > .lm-TabBar-content {
  flex-direction: row;
}

.lm-TabBar[data-orientation='vertical'] > .lm-TabBar-content {
  flex-direction: column;
}

.lm-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
  touch-action: none; /* Disable native Drag/Drop */
}

.lm-TabBar-tabIcon,
.lm-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}

.lm-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}

.lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
}

.lm-TabBar-tab.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar-addButton.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab {
  position: relative;
}

.lm-TabBar.lm-mod-dragging[data-orientation='horizontal'] .lm-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}

.lm-TabBar.lm-mod-dragging[data-orientation='vertical'] .lm-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab.lm-mod-dragging {
  transition: none;
}

.lm-TabBar-tabLabel .lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
  background: inherit;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabPanel-tabBar {
  z-index: 1;
}

.lm-TabPanel-stackedPanel {
  z-index: 0;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapse {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

.jp-Collapse-header {
  padding: 1px 12px;
  background-color: var(--jp-layout-color1);
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  text-transform: uppercase;
  user-select: none;
}

.jp-Collapser-icon {
  height: 16px;
}

.jp-Collapse-header-collapsed .jp-Collapser-icon {
  transform: rotate(-90deg);
  margin: auto 0;
}

.jp-Collapser-title {
  line-height: 25px;
}

.jp-Collapse-contents {
  padding: 0 12px;
  background-color: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* This file was auto-generated by ensureUiComponents() in @jupyterlab/buildutils */

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

/* Icons urls */

:root {
  --jp-icon-add-above: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5MikiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik00Ljc1IDQuOTMwNjZINi42MjVWNi44MDU2NkM2LjYyNSA3LjAxMTkxIDYuNzkzNzUgNy4xODA2NiA3IDcuMTgwNjZDNy4yMDYyNSA3LjE4MDY2IDcuMzc1IDcuMDExOTEgNy4zNzUgNi44MDU2NlY0LjkzMDY2SDkuMjVDOS40NTYyNSA0LjkzMDY2IDkuNjI1IDQuNzYxOTEgOS42MjUgNC41NTU2NkM5LjYyNSA0LjM0OTQxIDkuNDU2MjUgNC4xODA2NiA5LjI1IDQuMTgwNjZINy4zNzVWMi4zMDU2NkM3LjM3NSAyLjA5OTQxIDcuMjA2MjUgMS45MzA2NiA3IDEuOTMwNjZDNi43OTM3NSAxLjkzMDY2IDYuNjI1IDIuMDk5NDEgNi42MjUgMi4zMDU2NlY0LjE4MDY2SDQuNzVDNC41NDM3NSA0LjE4MDY2IDQuMzc1IDQuMzQ5NDEgNC4zNzUgNC41NTU2NkM0LjM3NSA0Ljc2MTkxIDQuNTQzNzUgNC45MzA2NiA0Ljc1IDQuOTMwNjZaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC43Ii8+CjwvZz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjUgOS41VjExLjVMMi41IDExLjVWOS41TDExLjUgOS41Wk0xMiA4QzEyLjU1MjMgOCAxMyA4LjQ0NzcyIDEzIDlWMTJDMTMgMTIuNTUyMyAxMi41NTIzIDEzIDEyIDEzTDIgMTNDMS40NDc3MiAxMyAxIDEyLjU1MjMgMSAxMlY5QzEgOC40NDc3MiAxLjQ0NzcxIDggMiA4TDEyIDhaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5MiI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEwIDEuNTU1NjYpIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg==);
  --jp-icon-add-below: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5OCkiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik05LjI1IDEwLjA2OTNMNy4zNzUgMTAuMDY5M0w3LjM3NSA4LjE5NDM0QzcuMzc1IDcuOTg4MDkgNy4yMDYyNSA3LjgxOTM0IDcgNy44MTkzNEM2Ljc5Mzc1IDcuODE5MzQgNi42MjUgNy45ODgwOSA2LjYyNSA4LjE5NDM0TDYuNjI1IDEwLjA2OTNMNC43NSAxMC4wNjkzQzQuNTQzNzUgMTAuMDY5MyA0LjM3NSAxMC4yMzgxIDQuMzc1IDEwLjQ0NDNDNC4zNzUgMTAuNjUwNiA0LjU0Mzc1IDEwLjgxOTMgNC43NSAxMC44MTkzTDYuNjI1IDEwLjgxOTNMNi42MjUgMTIuNjk0M0M2LjYyNSAxMi45MDA2IDYuNzkzNzUgMTMuMDY5MyA3IDEzLjA2OTNDNy4yMDYyNSAxMy4wNjkzIDcuMzc1IDEyLjkwMDYgNy4zNzUgMTIuNjk0M0w3LjM3NSAxMC44MTkzTDkuMjUgMTAuODE5M0M5LjQ1NjI1IDEwLjgxOTMgOS42MjUgMTAuNjUwNiA5LjYyNSAxMC40NDQzQzkuNjI1IDEwLjIzODEgOS40NTYyNSAxMC4wNjkzIDkuMjUgMTAuMDY5M1oiIGZpbGw9IiM2MTYxNjEiIHN0cm9rZT0iIzYxNjE2MSIgc3Ryb2tlLXdpZHRoPSIwLjciLz4KPC9nPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMi41IDUuNUwyLjUgMy41TDExLjUgMy41TDExLjUgNS41TDIuNSA1LjVaTTIgN0MxLjQ0NzcyIDcgMSA2LjU1MjI4IDEgNkwxIDNDMSAyLjQ0NzcyIDEuNDQ3NzIgMiAyIDJMMTIgMkMxMi41NTIzIDIgMTMgMi40NDc3MiAxMyAzTDEzIDZDMTMgNi41NTIyOSAxMi41NTIzIDcgMTIgN0wyIDdaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5OCI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KDEgMS43NDg0NmUtMDcgMS43NDg0NmUtMDcgLTEgNCAxMy40NDQzKSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=);
  --jp-icon-add: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDEzaC02djZoLTJ2LTZINXYtMmg2VjVoMnY2aDZ2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bell: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiPgogICA8cGF0aCBjbGFzcz0ianAtaWNvbjIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzMzMzMzIgogICAgICBkPSJtOCAwLjI5Yy0xLjQgMC0yLjcgMC43My0zLjYgMS44LTEuMiAxLjUtMS40IDMuNC0xLjUgNS4yLTAuMTggMi4yLTAuNDQgNC0yLjMgNS4zbDAuMjggMS4zaDVjMC4wMjYgMC42NiAwLjMyIDEuMSAwLjcxIDEuNSAwLjg0IDAuNjEgMiAwLjYxIDIuOCAwIDAuNTItMC40IDAuNi0xIDAuNzEtMS41aDVsMC4yOC0xLjNjLTEuOS0wLjk3LTIuMi0zLjMtMi4zLTUuMy0wLjEzLTEuOC0wLjI2LTMuNy0xLjUtNS4yLTAuODUtMS0yLjItMS44LTMuNi0xLjh6bTAgMS40YzAuODggMCAxLjkgMC41NSAyLjUgMS4zIDAuODggMS4xIDEuMSAyLjcgMS4yIDQuNCAwLjEzIDEuNyAwLjIzIDMuNiAxLjMgNS4yaC0xMGMxLjEtMS42IDEuMi0zLjQgMS4zLTUuMiAwLjEzLTEuNyAwLjMtMy4zIDEuMi00LjQgMC41OS0wLjcyIDEuNi0xLjMgMi41LTEuM3ptLTAuNzQgMTJoMS41Yy0wLjAwMTUgMC4yOCAwLjAxNSAwLjc5LTAuNzQgMC43OS0wLjczIDAuMDAxNi0wLjcyLTAuNTMtMC43NC0wLjc5eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-bug-dot: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiPgogICAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcuMTkgOEgyMFYxMEgxNy45MUMxNy45NiAxMC4zMyAxOCAxMC42NiAxOCAxMVYxMkgyMFYxNEgxOC41SDE4VjE0LjAyNzVDMTUuNzUgMTQuMjc2MiAxNCAxNi4xODM3IDE0IDE4LjVDMTQgMTkuMjA4IDE0LjE2MzUgMTkuODc3OSAxNC40NTQ5IDIwLjQ3MzlDMTMuNzA2MyAyMC44MTE3IDEyLjg3NTcgMjEgMTIgMjFDOS43OCAyMSA3Ljg1IDE5Ljc5IDYuODEgMThINFYxNkg2LjA5QzYuMDQgMTUuNjcgNiAxNS4zNCA2IDE1VjE0SDRWMTJINlYxMUM2IDEwLjY2IDYuMDQgMTAuMzMgNi4wOSAxMEg0VjhINi44MUM3LjI2IDcuMjIgNy44OCA2LjU1IDguNjIgNi4wNEw3IDQuNDFMOC40MSAzTDEwLjU5IDUuMTdDMTEuMDQgNS4wNiAxMS41MSA1IDEyIDVDMTIuNDkgNSAxMi45NiA1LjA2IDEzLjQyIDUuMTdMMTUuNTkgM0wxNyA0LjQxTDE1LjM3IDYuMDRDMTYuMTIgNi41NSAxNi43NCA3LjIyIDE3LjE5IDhaTTEwIDE2SDE0VjE0SDEwVjE2Wk0xMCAxMkgxNFYxMEgxMFYxMloiIGZpbGw9IiM2MTYxNjEiLz4KICAgICAgICA8cGF0aCBkPSJNMjIgMTguNUMyMiAyMC40MzMgMjAuNDMzIDIyIDE4LjUgMjJDMTYuNTY3IDIyIDE1IDIwLjQzMyAxNSAxOC41QzE1IDE2LjU2NyAxNi41NjcgMTUgMTguNSAxNUMyMC40MzMgMTUgMjIgMTYuNTY3IDIyIDE4LjVaIiBmaWxsPSIjNjE2MTYxIi8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bug: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yMCA4aC0yLjgxYy0uNDUtLjc4LTEuMDctMS40NS0xLjgyLTEuOTZMMTcgNC40MSAxNS41OSAzbC0yLjE3IDIuMTdDMTIuOTYgNS4wNiAxMi40OSA1IDEyIDVjLS40OSAwLS45Ni4wNi0xLjQxLjE3TDguNDEgMyA3IDQuNDFsMS42MiAxLjYzQzcuODggNi41NSA3LjI2IDcuMjIgNi44MSA4SDR2MmgyLjA5Yy0uMDUuMzMtLjA5LjY2LS4wOSAxdjFINHYyaDJ2MWMwIC4zNC4wNC42Ny4wOSAxSDR2MmgyLjgxYzEuMDQgMS43OSAyLjk3IDMgNS4xOSAzczQuMTUtMS4yMSA1LjE5LTNIMjB2LTJoLTIuMDljLjA1LS4zMy4wOS0uNjYuMDktMXYtMWgydi0yaC0ydi0xYzAtLjM0LS4wNC0uNjctLjA5LTFIMjBWOHptLTYgOGgtNHYtMmg0djJ6bTAtNGgtNHYtMmg0djJ6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-build: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE0LjkgMTcuNDVDMTYuMjUgMTcuNDUgMTcuMzUgMTYuMzUgMTcuMzUgMTVDMTcuMzUgMTMuNjUgMTYuMjUgMTIuNTUgMTQuOSAxMi41NUMxMy41NCAxMi41NSAxMi40NSAxMy42NSAxMi40NSAxNUMxMi40NSAxNi4zNSAxMy41NCAxNy40NSAxNC45IDE3LjQ1Wk0yMC4xIDE1LjY4TDIxLjU4IDE2Ljg0QzIxLjcxIDE2Ljk1IDIxLjc1IDE3LjEzIDIxLjY2IDE3LjI5TDIwLjI2IDE5LjcxQzIwLjE3IDE5Ljg2IDIwIDE5LjkyIDE5LjgzIDE5Ljg2TDE4LjA5IDE5LjE2QzE3LjczIDE5LjQ0IDE3LjMzIDE5LjY3IDE2LjkxIDE5Ljg1TDE2LjY0IDIxLjdDMTYuNjIgMjEuODcgMTYuNDcgMjIgMTYuMyAyMkgxMy41QzEzLjMyIDIyIDEzLjE4IDIxLjg3IDEzLjE1IDIxLjdMMTIuODkgMTkuODVDMTIuNDYgMTkuNjcgMTIuMDcgMTkuNDQgMTEuNzEgMTkuMTZMOS45NjAwMiAxOS44NkM5LjgxMDAyIDE5LjkyIDkuNjIwMDIgMTkuODYgOS41NDAwMiAxOS43MUw4LjE0MDAyIDE3LjI5QzguMDUwMDIgMTcuMTMgOC4wOTAwMiAxNi45NSA4LjIyMDAyIDE2Ljg0TDkuNzAwMDIgMTUuNjhMOS42NTAwMSAxNUw5LjcwMDAyIDE0LjMxTDguMjIwMDIgMTMuMTZDOC4wOTAwMiAxMy4wNSA4LjA1MDAyIDEyLjg2IDguMTQwMDIgMTIuNzFMOS41NDAwMiAxMC4yOUM5LjYyMDAyIDEwLjEzIDkuODEwMDIgMTAuMDcgOS45NjAwMiAxMC4xM0wxMS43MSAxMC44NEMxMi4wNyAxMC41NiAxMi40NiAxMC4zMiAxMi44OSAxMC4xNUwxMy4xNSA4LjI4OTk4QzEzLjE4IDguMTI5OTggMTMuMzIgNy45OTk5OCAxMy41IDcuOTk5OThIMTYuM0MxNi40NyA3Ljk5OTk4IDE2LjYyIDguMTI5OTggMTYuNjQgOC4yODk5OEwxNi45MSAxMC4xNUMxNy4zMyAxMC4zMiAxNy43MyAxMC41NiAxOC4wOSAxMC44NEwxOS44MyAxMC4xM0MyMCAxMC4wNyAyMC4xNyAxMC4xMyAyMC4yNiAxMC4yOUwyMS42NiAxMi43MUMyMS43NSAxMi44NiAyMS43MSAxMy4wNSAyMS41OCAxMy4xNkwyMC4xIDE0LjMxTDIwLjE1IDE1TDIwLjEgMTUuNjhaIi8+CiAgICA8cGF0aCBkPSJNNy4zMjk2NiA3LjQ0NDU0QzguMDgzMSA3LjAwOTU0IDguMzM5MzIgNi4wNTMzMiA3LjkwNDMyIDUuMjk5ODhDNy40NjkzMiA0LjU0NjQzIDYuNTA4MSA0LjI4MTU2IDUuNzU0NjYgNC43MTY1NkM1LjM5MTc2IDQuOTI2MDggNS4xMjY5NSA1LjI3MTE4IDUuMDE4NDkgNS42NzU5NEM0LjkxMDA0IDYuMDgwNzEgNC45NjY4MiA2LjUxMTk4IDUuMTc2MzQgNi44NzQ4OEM1LjYxMTM0IDcuNjI4MzIgNi41NzYyMiA3Ljg3OTU0IDcuMzI5NjYgNy40NDQ1NFpNOS42NTcxOCA0Ljc5NTkzTDEwLjg2NzIgNC45NTE3OUMxMC45NjI4IDQuOTc3NDEgMTEuMDQwMiA1LjA3MTMzIDExLjAzODIgNS4xODc5M0wxMS4wMzg4IDYuOTg4OTNDMTEuMDQ1NSA3LjEwMDU0IDEwLjk2MTYgNy4xOTUxOCAxMC44NTUgNy4yMTA1NEw5LjY2MDAxIDcuMzgwODNMOS4yMzkxNSA4LjEzMTg4TDkuNjY5NjEgOS4yNTc0NUM5LjcwNzI5IDkuMzYyNzEgOS42NjkzNCA5LjQ3Njk5IDkuNTc0MDggOS41MzE5OUw4LjAxNTIzIDEwLjQzMkM3LjkxMTMxIDEwLjQ5MiA3Ljc5MzM3IDEwLjQ2NzcgNy43MjEwNSAxMC4zODI0TDYuOTg3NDggOS40MzE4OEw2LjEwOTMxIDkuNDMwODNMNS4zNDcwNCAxMC4zOTA1QzUuMjg5MDkgMTAuNDcwMiA1LjE3MzgzIDEwLjQ5MDUgNS4wNzE4NyAxMC40MzM5TDMuNTEyNDUgOS41MzI5M0MzLjQxMDQ5IDkuNDc2MzMgMy4zNzY0NyA5LjM1NzQxIDMuNDEwNzUgOS4yNTY3OUwzLjg2MzQ3IDguMTQwOTNMMy42MTc0OSA3Ljc3NDg4TDMuNDIzNDcgNy4zNzg4M0wyLjIzMDc1IDcuMjEyOTdDMi4xMjY0NyA3LjE5MjM1IDIuMDQwNDkgNy4xMDM0MiAyLjA0MjQ1IDYuOTg2ODJMMi4wNDE4NyA1LjE4NTgyQzIuMDQzODMgNS4wNjkyMiAyLjExOTA5IDQuOTc5NTggMi4yMTcwNCA0Ljk2OTIyTDMuNDIwNjUgNC43OTM5M0wzLjg2NzQ5IDQuMDI3ODhMMy40MTEwNSAyLjkxNzMxQzMuMzczMzcgMi44MTIwNCAzLjQxMTMxIDIuNjk3NzYgMy41MTUyMyAyLjYzNzc2TDUuMDc0MDggMS43Mzc3NkM1LjE2OTM0IDEuNjgyNzYgNS4yODcyOSAxLjcwNzA0IDUuMzU5NjEgMS43OTIzMUw2LjExOTE1IDIuNzI3ODhMNi45ODAwMSAyLjczODkzTDcuNzI0OTYgMS43ODkyMkM3Ljc5MTU2IDEuNzA0NTggNy45MTU0OCAxLjY3OTIyIDguMDA4NzkgMS43NDA4Mkw5LjU2ODIxIDIuNjQxODJDOS42NzAxNyAyLjY5ODQyIDkuNzEyODUgMi44MTIzNCA5LjY4NzIzIDIuOTA3OTdMOS4yMTcxOCA0LjAzMzgzTDkuNDYzMTYgNC4zOTk4OEw5LjY1NzE4IDQuNzk1OTNaIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iOS45LDEzLjYgMy42LDcuNCA0LjQsNi42IDkuOSwxMi4yIDE1LjQsNi43IDE2LjEsNy40ICIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNS45TDksOS43bDMuOC0zLjhsMS4yLDEuMmwtNC45LDVsLTQuOS01TDUuMiw1Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNy41TDksMTEuMmwzLjgtMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-left: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik0xMC44LDEyLjhMNy4xLDlsMy44LTMuOGwwLDcuNkgxMC44eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-right: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik03LjIsNS4yTDEwLjksOWwtMy44LDMuOFY1LjJINy4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-up-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTUuNCwxMy4zIDkuOSw3LjcgNC40LDEzLjIgMy42LDEyLjUgOS45LDYuMyAxNi4xLDEyLjYgIi8+Cgk8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-up: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik01LjIsMTAuNUw5LDYuOGwzLjgsMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-case-sensitive: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWFjY2VudDIiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTcuNiw4aDAuOWwzLjUsOGgtMS4xTDEwLDE0SDZsLTAuOSwySDRMNy42LDh6IE04LDkuMUw2LjQsMTNoMy4yTDgsOS4xeiIvPgogICAgPHBhdGggZD0iTTE2LjYsOS44Yy0wLjIsMC4xLTAuNCwwLjEtMC43LDAuMWMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjEtMC4xLTAuMi0wLjQtMC4yLTAuNyBjLTAuMywwLjMtMC42LDAuNS0wLjksMC43Yy0wLjMsMC4xLTAuNywwLjItMS4xLDAuMmMtMC4zLDAtMC41LDAtMC43LTAuMWMtMC4yLTAuMS0wLjQtMC4yLTAuNi0wLjNjLTAuMi0wLjEtMC4zLTAuMy0wLjQtMC41IGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjdjMC0wLjMsMC4xLTAuNiwwLjItMC44YzAuMS0wLjIsMC4zLTAuNCwwLjQtMC41QzEyLDcsMTIuMiw2LjksMTIuNSw2LjhjMC4yLTAuMSwwLjUtMC4xLDAuNy0wLjIgYzAuMy0wLjEsMC41LTAuMSwwLjctMC4xYzAuMiwwLDAuNC0wLjEsMC42LTAuMWMwLjIsMCwwLjMtMC4xLDAuNC0wLjJjMC4xLTAuMSwwLjItMC4yLDAuMi0wLjRjMC0xLTEuMS0xLTEuMy0xIGMtMC40LDAtMS40LDAtMS40LDEuMmgtMC45YzAtMC40LDAuMS0wLjcsMC4yLTFjMC4xLTAuMiwwLjMtMC40LDAuNS0wLjZjMC4yLTAuMiwwLjUtMC4zLDAuOC0wLjNDMTMuMyw0LDEzLjYsNCwxMy45LDQgYzAuMywwLDAuNSwwLDAuOCwwLjFjMC4zLDAsMC41LDAuMSwwLjcsMC4yYzAuMiwwLjEsMC40LDAuMywwLjUsMC41QzE2LDUsMTYsNS4yLDE2LDUuNnYyLjljMCwwLjIsMCwwLjQsMCwwLjUgYzAsMC4xLDAuMSwwLjIsMC4zLDAuMmMwLjEsMCwwLjIsMCwwLjMsMFY5Ljh6IE0xNS4yLDYuOWMtMS4yLDAuNi0zLjEsMC4yLTMuMSwxLjRjMCwxLjQsMy4xLDEsMy4xLTAuNVY2Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-circle-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDJDNi40NyAyIDIgNi40NyAyIDEyczQuNDcgMTAgMTAgMTAgMTAtNC40NyAxMC0xMFMxNy41MyAyIDEyIDJ6bTAgMThjLTQuNDEgMC04LTMuNTktOC04czMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-circle: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-clear: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8bWFzayBpZD0iZG9udXRIb2xlIj4KICAgIDxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiIC8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSI4IiBmaWxsPSJibGFjayIvPgogIDwvbWFzaz4KCiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxyZWN0IGhlaWdodD0iMTgiIHdpZHRoPSIyIiB4PSIxMSIgeT0iMyIgdHJhbnNmb3JtPSJyb3RhdGUoMzE1LCAxMiwgMTIpIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgbWFzaz0idXJsKCNkb251dEhvbGUpIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-close: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1ub25lIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIGpwLWljb24zLWhvdmVyIiBmaWxsPSJub25lIj4KICAgIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjExIi8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIGpwLWljb24tYWNjZW50Mi1ob3ZlciIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPgogIDwvZz4KCiAgPGcgY2xhc3M9ImpwLWljb24tbm9uZSBqcC1pY29uLWJ1c3kiIGZpbGw9Im5vbmUiPgogICAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CiAgICA8cGF0aCBkPSJNNi41OSwzLjQxTDIsOEw2LjU5LDEyLjZMOCwxMS4xOEw0LjgyLDhMOCw0LjgyTDYuNTksMy40MU0xMi40MSwzLjQxTDExLDQuODJMMTQuMTgsOEwxMSwxMS4xOEwxMi40MSwxMi42TDE3LDhMMTIuNDEsMy40MU0yMS41OSwxMS41OUwxMy41LDE5LjY4TDkuODMsMTZMOC40MiwxNy40MUwxMy41LDIyLjVMMjMsMTNMMjEuNTksMTEuNTlaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTExLjQgMTguNkw2LjggMTRMMTEuNCA5LjRMMTAgOEw0IDE0TDEwIDIwTDExLjQgMTguNlpNMTYuNiAxOC42TDIxLjIgMTRMMTYuNiA5LjRMMTggOEwyNCAxNEwxOCAyMEwxNi42IDE4LjZWMTguNloiLz4KCTwvZz4KPC9zdmc+Cg==);
  --jp-icon-collapse-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNNiAxM3YyaDh2LTJ6IiAvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-console: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwMCAyMDAiPgogIDxnIGNsYXNzPSJqcC1jb25zb2xlLWljb24tYmFja2dyb3VuZC1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMjg4RDEiPgogICAgPHBhdGggZD0iTTIwIDE5LjhoMTYwdjE1OS45SDIweiIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtY29uc29sZS1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIj4KICAgIDxwYXRoIGQ9Ik0xMDUgMTI3LjNoNDB2MTIuOGgtNDB6TTUxLjEgNzdMNzQgOTkuOWwtMjMuMyAyMy4zIDEwLjUgMTAuNSAyMy4zLTIzLjNMOTUgOTkuOSA4NC41IDg5LjQgNjEuNiA2Ni41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copy: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTExLjksMUgzLjJDMi40LDEsMS43LDEuNywxLjcsMi41djEwLjJoMS41VjIuNWg4LjdWMXogTTE0LjEsMy45aC04Yy0wLjgsMC0xLjUsMC43LTEuNSwxLjV2MTAuMmMwLDAuOCwwLjcsMS41LDEuNSwxLjVoOCBjMC44LDAsMS41LTAuNywxLjUtMS41VjUuNEMxNS41LDQuNiwxNC45LDMuOSwxNC4xLDMuOXogTTE0LjEsMTUuNWgtOFY1LjRoOFYxNS41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copyright: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCI+CiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0xMS44OCw5LjE0YzEuMjgsMC4wNiwxLjYxLDEuMTUsMS42MywxLjY2aDEuNzljLTAuMDgtMS45OC0xLjQ5LTMuMTktMy40NS0zLjE5QzkuNjQsNy42MSw4LDksOCwxMi4xNCBjMCwxLjk0LDAuOTMsNC4yNCwzLjg0LDQuMjRjMi4yMiwwLDMuNDEtMS42NSwzLjQ0LTIuOTVoLTEuNzljLTAuMDMsMC41OS0wLjQ1LDEuMzgtMS42MywxLjQ0QzEwLjU1LDE0LjgzLDEwLDEzLjgxLDEwLDEyLjE0IEMxMCw5LjI1LDExLjI4LDkuMTYsMTEuODgsOS4xNHogTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMiwyMGMtNC40MSwwLTgtMy41OS04LTggczMuNTktOCw4LThzOCwzLjU5LDgsOFMxNi40MSwyMCwxMiwyMHoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-cut: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkuNjQgNy42NGMuMjMtLjUuMzYtMS4wNS4zNi0xLjY0IDAtMi4yMS0xLjc5LTQtNC00UzIgMy43OSAyIDZzMS43OSA0IDQgNGMuNTkgMCAxLjE0LS4xMyAxLjY0LS4zNkwxMCAxMmwtMi4zNiAyLjM2QzcuMTQgMTQuMTMgNi41OSAxNCA2IDE0Yy0yLjIxIDAtNCAxLjc5LTQgNHMxLjc5IDQgNCA0IDQtMS43OSA0LTRjMC0uNTktLjEzLTEuMTQtLjM2LTEuNjRMMTIgMTRsNyA3aDN2LTFMOS42NCA3LjY0ek02IDhjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTAgMTJjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTYtNy41Yy0uMjggMC0uNS0uMjItLjUtLjVzLjIyLS41LjUtLjUuNS4yMi41LjUtLjIyLjUtLjUuNXpNMTkgM2wtNiA2IDIgMiA3LTdWM3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-delete: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIiAvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjI2MjYyIiBkPSJNNiAxOWMwIDEuMS45IDIgMiAyaDhjMS4xIDAgMi0uOSAyLTJWN0g2djEyek0xOSA0aC0zLjVsLTEtMWgtNWwtMSAxSDV2MmgxNFY0eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-download: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDloLTRWM0g5djZINWw3IDcgNy03ek01IDE4djJoMTR2LTJINXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-duplicate: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIuNzk5OTggMC44NzVIOC44OTU4MkM5LjIwMDYxIDAuODc1IDkuNDQ5OTggMS4xMzkxNCA5LjQ0OTk4IDEuNDYxOThDOS40NDk5OCAxLjc4NDgyIDkuMjAwNjEgMi4wNDg5NiA4Ljg5NTgyIDIuMDQ4OTZIMy4zNTQxNUMzLjA0OTM2IDIuMDQ4OTYgMi43OTk5OCAyLjMxMzEgMi43OTk5OCAyLjYzNTk0VjkuNjc5NjlDMi43OTk5OCAxMC4wMDI1IDIuNTUwNjEgMTAuMjY2NyAyLjI0NTgyIDEwLjI2NjdDMS45NDEwMyAxMC4yNjY3IDEuNjkxNjUgMTAuMDAyNSAxLjY5MTY1IDkuNjc5NjlWMi4wNDg5NkMxLjY5MTY1IDEuNDAzMjggMi4xOTA0IDAuODc1IDIuNzk5OTggMC44NzVaTTUuMzY2NjUgMTEuOVY0LjU1SDExLjA4MzNWMTEuOUg1LjM2NjY1Wk00LjE0MTY1IDQuMTQxNjdDNC4xNDE2NSAzLjY5MDYzIDQuNTA3MjggMy4zMjUgNC45NTgzMiAzLjMyNUgxMS40OTE3QzExLjk0MjcgMy4zMjUgMTIuMzA4MyAzLjY5MDYzIDEyLjMwODMgNC4xNDE2N1YxMi4zMDgzQzEyLjMwODMgMTIuNzU5NCAxMS45NDI3IDEzLjEyNSAxMS40OTE3IDEzLjEyNUg0Ljk1ODMyQzQuNTA3MjggMTMuMTI1IDQuMTQxNjUgMTIuNzU5NCA0LjE0MTY1IDEyLjMwODNWNC4xNDE2N1oiIGZpbGw9IiM2MTYxNjEiLz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNOS40MzU3NCA4LjI2NTA3SDguMzY0MzFWOS4zMzY1QzguMzY0MzEgOS40NTQzNSA4LjI2Nzg4IDkuNTUwNzggOC4xNTAwMiA5LjU1MDc4QzguMDMyMTcgOS41NTA3OCA3LjkzNTc0IDkuNDU0MzUgNy45MzU3NCA5LjMzNjVWOC4yNjUwN0g2Ljg2NDMxQzYuNzQ2NDUgOC4yNjUwNyA2LjY1MDAyIDguMTY4NjQgNi42NTAwMiA4LjA1MDc4QzYuNjUwMDIgNy45MzI5MiA2Ljc0NjQ1IDcuODM2NSA2Ljg2NDMxIDcuODM2NUg3LjkzNTc0VjYuNzY1MDdDNy45MzU3NCA2LjY0NzIxIDguMDMyMTcgNi41NTA3OCA4LjE1MDAyIDYuNTUwNzhDOC4yNjc4OCA2LjU1MDc4IDguMzY0MzEgNi42NDcyMSA4LjM2NDMxIDYuNzY1MDdWNy44MzY1SDkuNDM1NzRDOS41NTM2IDcuODM2NSA5LjY1MDAyIDcuOTMyOTIgOS42NTAwMiA4LjA1MDc4QzkuNjUwMDIgOC4xNjg2NCA5LjU1MzYgOC4yNjUwNyA5LjQzNTc0IDguMjY1MDdaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC41Ii8+Cjwvc3ZnPgo=);
  --jp-icon-edit: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMgMTcuMjVWMjFoMy43NUwxNy44MSA5Ljk0bC0zLjc1LTMuNzVMMyAxNy4yNXpNMjAuNzEgNy4wNGMuMzktLjM5LjM5LTEuMDIgMC0xLjQxbC0yLjM0LTIuMzRjLS4zOS0uMzktMS4wMi0uMzktMS40MSAwbC0xLjgzIDEuODMgMy43NSAzLjc1IDEuODMtMS44M3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-ellipses: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iNSIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjEyIiByPSIyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-error: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjE5IiByPSIyIi8+PHBhdGggZD0iTTEwIDNoNHYxMmgtNHoiLz48L2c+CjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMjR2MjRIMHoiLz4KPC9zdmc+Cg==);
  --jp-icon-expand-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNMTEgMTBIOXYzSDZ2MmgzdjNoMnYtM2gzdi0yaC0zeiIgLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-extension: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwLjUgMTFIMTlWN2MwLTEuMS0uOS0yLTItMmgtNFYzLjVDMTMgMi4xMiAxMS44OCAxIDEwLjUgMVM4IDIuMTIgOCAzLjVWNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAydjMuOEgzLjVjMS40OSAwIDIuNyAxLjIxIDIuNyAyLjdzLTEuMjEgMi43LTIuNyAyLjdIMlYyMGMwIDEuMS45IDIgMiAyaDMuOHYtMS41YzAtMS40OSAxLjIxLTIuNyAyLjctMi43IDEuNDkgMCAyLjcgMS4yMSAyLjcgMi43VjIySDE3YzEuMSAwIDItLjkgMi0ydi00aDEuNWMxLjM4IDAgMi41LTEuMTIgMi41LTIuNVMyMS44OCAxMSAyMC41IDExeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-fast-forward: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTQgMThsOC41LTZMNCA2djEyem05LTEydjEybDguNS02TDEzIDZ6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-file-upload: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkgMTZoNnYtNmg0bC03LTctNyA3aDR6bS00IDJoMTR2Mkg1eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-file: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuMyA4LjJsLTUuNS01LjVjLS4zLS4zLS43LS41LTEuMi0uNUgzLjljLS44LjEtMS42LjktMS42IDEuOHYxNC4xYzAgLjkuNyAxLjYgMS42IDEuNmgxNC4yYy45IDAgMS42LS43IDEuNi0xLjZWOS40Yy4xLS41LS4xLS45LS40LTEuMnptLTUuOC0zLjNsMy40IDMuNmgtMy40VjQuOXptMy45IDEyLjdINC43Yy0uMSAwLS4yIDAtLjItLjJWNC43YzAtLjIuMS0uMy4yLS4zaDcuMnY0LjRzMCAuOC4zIDEuMWMuMy4zIDEuMS4zIDEuMS4zaDQuM3Y3LjJzLS4xLjItLjIuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-filter-dot: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWRvdCIgZmlsbD0iI0ZGRiI+CiAgICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjE3IiByPSIzIj48L2NpcmNsZT4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-filter-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEwIDE4aDR2LTJoLTR2MnpNMyA2djJoMThWNkgzem0zIDdoMTJ2LTJINnYyeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-filter: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-folder-favorite: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggY2xhc3M9ImpwLWljb24zIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxNjE2MSIgZD0iTTIwIDZoLThsLTItMkg0Yy0xLjEgMC0yIC45LTIgMnYxMmMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJ6bS0yLjA2IDExTDE1IDE1LjI4IDEyLjA2IDE3bC43OC0zLjMzLTIuNTktMi4yNCAzLjQxLS4yOUwxNSA4bDEuMzQgMy4xNCAzLjQxLjI5LTIuNTkgMi4yNC43OCAzLjMzeiIvPgo8L3N2Zz4K);
  --jp-icon-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY4YzAtMS4xLS45LTItMi0yaC04bC0yLTJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-home: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xMCAyMHYtNmg0djZoNXYtOGgzTDEyIDMgMiAxMmgzdjh6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-html5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uMCBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMDAiIGQ9Ik0xMDguNCAwaDIzdjIyLjhoMjEuMlYwaDIzdjY5aC0yM1Y0NmgtMjF2MjNoLTIzLjJNMjA2IDIzaC0yMC4zVjBoNjMuN3YyM0gyMjl2NDZoLTIzbTUzLjUtNjloMjQuMWwxNC44IDI0LjNMMzEzLjIgMGgyNC4xdjY5aC0yM1YzNC44bC0xNi4xIDI0LjgtMTYuMS0yNC44VjY5aC0yMi42bTg5LjItNjloMjN2NDYuMmgzMi42VjY5aC01NS42Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2U0NGQyNiIgZD0iTTEwNy42IDQ3MWwtMzMtMzcwLjRoMzYyLjhsLTMzIDM3MC4yTDI1NS43IDUxMiIvPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNmMTY1MjkiIGQ9Ik0yNTYgNDgwLjVWMTMxaDE0OC4zTDM3NiA0NDciLz4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNlYmViZWIiIGQ9Ik0xNDIgMTc2LjNoMTE0djQ1LjRoLTY0LjJsNC4yIDQ2LjVoNjB2NDUuM0gxNTQuNG0yIDIyLjhIMjAybDMuMiAzNi4zIDUwLjggMTMuNnY0Ny40bC05My4yLTI2Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIiBkPSJNMzY5LjYgMTc2LjNIMjU1Ljh2NDUuNGgxMDkuNm0tNC4xIDQ2LjVIMjU1Ljh2NDUuNGg1NmwtNS4zIDU5LTUwLjcgMTMuNnY0Ny4ybDkzLTI1LjgiLz4KPC9zdmc+Cg==);
  --jp-icon-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1icmFuZDQganAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNGRkYiIGQ9Ik0yLjIgMi4yaDE3LjV2MTcuNUgyLjJ6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzNGNTFCNSIgZD0iTTIuMiAyLjJ2MTcuNWgxNy41bC4xLTE3LjVIMi4yem0xMi4xIDIuMmMxLjIgMCAyLjIgMSAyLjIgMi4ycy0xIDIuMi0yLjIgMi4yLTIuMi0xLTIuMi0yLjIgMS0yLjIgMi4yLTIuMnpNNC40IDE3LjZsMy4zLTguOCAzLjMgNi42IDIuMi0zLjIgNC40IDUuNEg0LjR6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-info: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUwLjk3OCA1MC45NzgiPgoJPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KCQk8cGF0aCBkPSJNNDMuNTIsNy40NThDMzguNzExLDIuNjQ4LDMyLjMwNywwLDI1LjQ4OSwwQzE4LjY3LDAsMTIuMjY2LDIuNjQ4LDcuNDU4LDcuNDU4CgkJCWMtOS45NDMsOS45NDEtOS45NDMsMjYuMTE5LDAsMzYuMDYyYzQuODA5LDQuODA5LDExLjIxMiw3LjQ1NiwxOC4wMzEsNy40NThjMCwwLDAuMDAxLDAsMC4wMDIsMAoJCQljNi44MTYsMCwxMy4yMjEtMi42NDgsMTguMDI5LTcuNDU4YzQuODA5LTQuODA5LDcuNDU3LTExLjIxMiw3LjQ1Ny0xOC4wM0M1MC45NzcsMTguNjcsNDguMzI4LDEyLjI2Niw0My41Miw3LjQ1OHoKCQkJIE00Mi4xMDYsNDIuMTA1Yy00LjQzMiw0LjQzMS0xMC4zMzIsNi44NzItMTYuNjE1LDYuODcyaC0wLjAwMmMtNi4yODUtMC4wMDEtMTIuMTg3LTIuNDQxLTE2LjYxNy02Ljg3MgoJCQljLTkuMTYyLTkuMTYzLTkuMTYyLTI0LjA3MSwwLTMzLjIzM0MxMy4zMDMsNC40NCwxOS4yMDQsMiwyNS40ODksMmM2LjI4NCwwLDEyLjE4NiwyLjQ0LDE2LjYxNyw2Ljg3MgoJCQljNC40MzEsNC40MzEsNi44NzEsMTAuMzMyLDYuODcxLDE2LjYxN0M0OC45NzcsMzEuNzcyLDQ2LjUzNiwzNy42NzUsNDIuMTA2LDQyLjEwNXoiLz4KCQk8cGF0aCBkPSJNMjMuNTc4LDMyLjIxOGMtMC4wMjMtMS43MzQsMC4xNDMtMy4wNTksMC40OTYtMy45NzJjMC4zNTMtMC45MTMsMS4xMS0xLjk5NywyLjI3Mi0zLjI1MwoJCQljMC40NjgtMC41MzYsMC45MjMtMS4wNjIsMS4zNjctMS41NzVjMC42MjYtMC43NTMsMS4xMDQtMS40NzgsMS40MzYtMi4xNzVjMC4zMzEtMC43MDcsMC40OTUtMS41NDEsMC40OTUtMi41CgkJCWMwLTEuMDk2LTAuMjYtMi4wODgtMC43NzktMi45NzljLTAuNTY1LTAuODc5LTEuNTAxLTEuMzM2LTIuODA2LTEuMzY5Yy0xLjgwMiwwLjA1Ny0yLjk4NSwwLjY2Ny0zLjU1LDEuODMyCgkJCWMtMC4zMDEsMC41MzUtMC41MDMsMS4xNDEtMC42MDcsMS44MTRjLTAuMTM5LDAuNzA3LTAuMjA3LDEuNDMyLTAuMjA3LDIuMTc0aC0yLjkzN2MtMC4wOTEtMi4yMDgsMC40MDctNC4xMTQsMS40OTMtNS43MTkKCQkJYzEuMDYyLTEuNjQsMi44NTUtMi40ODEsNS4zNzgtMi41MjdjMi4xNiwwLjAyMywzLjg3NCwwLjYwOCw1LjE0MSwxLjc1OGMxLjI3OCwxLjE2LDEuOTI5LDIuNzY0LDEuOTUsNC44MTEKCQkJYzAsMS4xNDItMC4xMzcsMi4xMTEtMC40MSwyLjkxMWMtMC4zMDksMC44NDUtMC43MzEsMS41OTMtMS4yNjgsMi4yNDNjLTAuNDkyLDAuNjUtMS4wNjgsMS4zMTgtMS43MywyLjAwMgoJCQljLTAuNjUsMC42OTctMS4zMTMsMS40NzktMS45ODcsMi4zNDZjLTAuMjM5LDAuMzc3LTAuNDI5LDAuNzc3LTAuNTY1LDEuMTk5Yy0wLjE2LDAuOTU5LTAuMjE3LDEuOTUxLTAuMTcxLDIuOTc5CgkJCUMyNi41ODksMzIuMjE4LDIzLjU3OCwzMi4yMTgsMjMuNTc4LDMyLjIxOHogTTIzLjU3OCwzOC4yMnYtMy40ODRoMy4wNzZ2My40ODRIMjMuNTc4eiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-inspector: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaW5zcGVjdG9yLWljb24tY29sb3IganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY2YzAtMS4xLS45LTItMi0yem0tNSAxNEg0di00aDExdjR6bTAtNUg0VjloMTF2NHptNSA1aC00VjloNHY5eiIvPgo8L3N2Zz4K);
  --jp-icon-json: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtanNvbi1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0Y5QTgyNSI+CiAgICA8cGF0aCBkPSJNMjAuMiAxMS44Yy0xLjYgMC0xLjcuNS0xLjcgMSAwIC40LjEuOS4xIDEuMy4xLjUuMS45LjEgMS4zIDAgMS43LTEuNCAyLjMtMy41IDIuM2gtLjl2LTEuOWguNWMxLjEgMCAxLjQgMCAxLjQtLjggMC0uMyAwLS42LS4xLTEgMC0uNC0uMS0uOC0uMS0xLjIgMC0xLjMgMC0xLjggMS4zLTItMS4zLS4yLTEuMy0uNy0xLjMtMiAwLS40LjEtLjguMS0xLjIuMS0uNC4xLS43LjEtMSAwLS44LS40LS43LTEuNC0uOGgtLjVWNC4xaC45YzIuMiAwIDMuNS43IDMuNSAyLjMgMCAuNC0uMS45LS4xIDEuMy0uMS41LS4xLjktLjEgMS4zIDAgLjUuMiAxIDEuNyAxdjEuOHpNMS44IDEwLjFjMS42IDAgMS43LS41IDEuNy0xIDAtLjQtLjEtLjktLjEtMS4zLS4xLS41LS4xLS45LS4xLTEuMyAwLTEuNiAxLjQtMi4zIDMuNS0yLjNoLjl2MS45aC0uNWMtMSAwLTEuNCAwLTEuNC44IDAgLjMgMCAuNi4xIDEgMCAuMi4xLjYuMSAxIDAgMS4zIDAgMS44LTEuMyAyQzYgMTEuMiA2IDExLjcgNiAxM2MwIC40LS4xLjgtLjEgMS4yLS4xLjMtLjEuNy0uMSAxIDAgLjguMy44IDEuNC44aC41djEuOWgtLjljLTIuMSAwLTMuNS0uNi0zLjUtMi4zIDAtLjQuMS0uOS4xLTEuMy4xLS41LjEtLjkuMS0xLjMgMC0uNS0uMi0xLTEuNy0xdi0xLjl6Ii8+CiAgICA8Y2lyY2xlIGN4PSIxMSIgY3k9IjEzLjgiIHI9IjIuMSIvPgogICAgPGNpcmNsZSBjeD0iMTEiIGN5PSI4LjIiIHI9IjIuMSIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-julia: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDMyNSAzMDAiPgogIDxnIGNsYXNzPSJqcC1icmFuZDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjY2IzYzMzIj4KICAgIDxwYXRoIGQ9Ik0gMTUwLjg5ODQzOCAyMjUgQyAxNTAuODk4NDM4IDI2Ni40MjE4NzUgMTE3LjMyMDMxMiAzMDAgNzUuODk4NDM4IDMwMCBDIDM0LjQ3NjU2MiAzMDAgMC44OTg0MzggMjY2LjQyMTg3NSAwLjg5ODQzOCAyMjUgQyAwLjg5ODQzOCAxODMuNTc4MTI1IDM0LjQ3NjU2MiAxNTAgNzUuODk4NDM4IDE1MCBDIDExNy4zMjAzMTIgMTUwIDE1MC44OTg0MzggMTgzLjU3ODEyNSAxNTAuODk4NDM4IDIyNSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzM4OTgyNiI+CiAgICA8cGF0aCBkPSJNIDIzNy41IDc1IEMgMjM3LjUgMTE2LjQyMTg3NSAyMDMuOTIxODc1IDE1MCAxNjIuNSAxNTAgQyAxMjEuMDc4MTI1IDE1MCA4Ny41IDExNi40MjE4NzUgODcuNSA3NSBDIDg3LjUgMzMuNTc4MTI1IDEyMS4wNzgxMjUgMCAxNjIuNSAwIEMgMjAzLjkyMTg3NSAwIDIzNy41IDMzLjU3ODEyNSAyMzcuNSA3NSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzk1NThiMiI+CiAgICA8cGF0aCBkPSJNIDMyNC4xMDE1NjIgMjI1IEMgMzI0LjEwMTU2MiAyNjYuNDIxODc1IDI5MC41MjM0MzggMzAwIDI0OS4xMDE1NjIgMzAwIEMgMjA3LjY3OTY4OCAzMDAgMTc0LjEwMTU2MiAyNjYuNDIxODc1IDE3NC4xMDE1NjIgMjI1IEMgMTc0LjEwMTU2MiAxODMuNTc4MTI1IDIwNy42Nzk2ODggMTUwIDI0OS4xMDE1NjIgMTUwIEMgMjkwLjUyMzQzOCAxNTAgMzI0LjEwMTU2MiAxODMuNTc4MTI1IDMyNC4xMDE1NjIgMjI1Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-jupyter-favicon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUyIiBoZWlnaHQ9IjE2NSIgdmlld0JveD0iMCAwIDE1MiAxNjUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgPGcgY2xhc3M9ImpwLWp1cHl0ZXItaWNvbi1jb2xvciIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA3ODk0NywgMTEwLjU4MjkyNykiIGQ9Ik03NS45NDIyODQyLDI5LjU4MDQ1NjEgQzQzLjMwMjM5NDcsMjkuNTgwNDU2MSAxNC43OTY3ODMyLDE3LjY1MzQ2MzQgMCwwIEM1LjUxMDgzMjExLDE1Ljg0MDY4MjkgMTUuNzgxNTM4OSwyOS41NjY3NzMyIDI5LjM5MDQ5NDcsMzkuMjc4NDE3MSBDNDIuOTk5Nyw0OC45ODk4NTM3IDU5LjI3MzcsNTQuMjA2NzgwNSA3NS45NjA1Nzg5LDU0LjIwNjc4MDUgQzkyLjY0NzQ1NzksNTQuMjA2NzgwNSAxMDguOTIxNDU4LDQ4Ljk4OTg1MzcgMTIyLjUzMDY2MywzOS4yNzg0MTcxIEMxMzYuMTM5NDUzLDI5LjU2Njc3MzIgMTQ2LjQxMDI4NCwxNS44NDA2ODI5IDE1MS45MjExNTgsMCBDMTM3LjA4Nzg2OCwxNy42NTM0NjM0IDEwOC41ODI1ODksMjkuNTgwNDU2MSA3NS45NDIyODQyLDI5LjU4MDQ1NjEgTDc1Ljk0MjI4NDIsMjkuNTgwNDU2MSBaIiAvPgogICAgPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzczNjgsIDAuNzA0ODc4KSIgZD0iTTc1Ljk3ODQ1NzksMjQuNjI2NDA3MyBDMTA4LjYxODc2MywyNC42MjY0MDczIDEzNy4xMjQ0NTgsMzYuNTUzNDQxNSAxNTEuOTIxMTU4LDU0LjIwNjc4MDUgQzE0Ni40MTAyODQsMzguMzY2MjIyIDEzNi4xMzk0NTMsMjQuNjQwMTMxNyAxMjIuNTMwNjYzLDE0LjkyODQ4NzggQzEwOC45MjE0NTgsNS4yMTY4NDM5IDkyLjY0NzQ1NzksMCA3NS45NjA1Nzg5LDAgQzU5LjI3MzcsMCA0Mi45OTk3LDUuMjE2ODQzOSAyOS4zOTA0OTQ3LDE0LjkyODQ4NzggQzE1Ljc4MTUzODksMjQuNjQwMTMxNyA1LjUxMDgzMjExLDM4LjM2NjIyMiAwLDU0LjIwNjc4MDUgQzE0LjgzMzA4MTYsMzYuNTg5OTI5MyA0My4zMzg1Njg0LDI0LjYyNjQwNzMgNzUuOTc4NDU3OSwyNC42MjY0MDczIEw3NS45Nzg0NTc5LDI0LjYyNjQwNzMgWiIgLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-jupyter: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzkiIGhlaWdodD0iNTEiIHZpZXdCb3g9IjAgMCAzOSA1MSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYzOCAtMjI4MSkiPgogICAgIDxnIGNsYXNzPSJqcC1qdXB5dGVyLWljb24tY29sb3IiIGZpbGw9IiNGMzc3MjYiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5Ljc0IDIzMTEuOTgpIiBkPSJNIDE4LjI2NDYgNy4xMzQxMUMgMTAuNDE0NSA3LjEzNDExIDMuNTU4NzIgNC4yNTc2IDAgMEMgMS4zMjUzOSAzLjgyMDQgMy43OTU1NiA3LjEzMDgxIDcuMDY4NiA5LjQ3MzAzQyAxMC4zNDE3IDExLjgxNTIgMTQuMjU1NyAxMy4wNzM0IDE4LjI2OSAxMy4wNzM0QyAyMi4yODIzIDEzLjA3MzQgMjYuMTk2MyAxMS44MTUyIDI5LjQ2OTQgOS40NzMwM0MgMzIuNzQyNCA3LjEzMDgxIDM1LjIxMjYgMy44MjA0IDM2LjUzOCAwQyAzMi45NzA1IDQuMjU3NiAyNi4xMTQ4IDcuMTM0MTEgMTguMjY0NiA3LjEzNDExWiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5LjczIDIyODUuNDgpIiBkPSJNIDE4LjI3MzMgNS45MzkzMUMgMjYuMTIzNSA1LjkzOTMxIDMyLjk3OTMgOC44MTU4MyAzNi41MzggMTMuMDczNEMgMzUuMjEyNiA5LjI1MzAzIDMyLjc0MjQgNS45NDI2MiAyOS40Njk0IDMuNjAwNEMgMjYuMTk2MyAxLjI1ODE4IDIyLjI4MjMgMCAxOC4yNjkgMEMgMTQuMjU1NyAwIDEwLjM0MTcgMS4yNTgxOCA3LjA2ODYgMy42MDA0QyAzLjc5NTU2IDUuOTQyNjIgMS4zMjUzOSA5LjI1MzAzIDAgMTMuMDczNEMgMy41Njc0NSA4LjgyNDYzIDEwLjQyMzIgNS45MzkzMSAxOC4yNzMzIDUuOTM5MzFaIi8+CiAgICA8L2c+CiAgICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjY5LjMgMjI4MS4zMSkiIGQ9Ik0gNS44OTM1MyAyLjg0NEMgNS45MTg4OSAzLjQzMTY1IDUuNzcwODUgNC4wMTM2NyA1LjQ2ODE1IDQuNTE2NDVDIDUuMTY1NDUgNS4wMTkyMiA0LjcyMTY4IDUuNDIwMTUgNC4xOTI5OSA1LjY2ODUxQyAzLjY2NDMgNS45MTY4OCAzLjA3NDQ0IDYuMDAxNTEgMi40OTgwNSA1LjkxMTcxQyAxLjkyMTY2IDUuODIxOSAxLjM4NDYzIDUuNTYxNyAwLjk1NDg5OCA1LjE2NDAxQyAwLjUyNTE3IDQuNzY2MzMgMC4yMjIwNTYgNC4yNDkwMyAwLjA4MzkwMzcgMy42Nzc1N0MgLTAuMDU0MjQ4MyAzLjEwNjExIC0wLjAyMTIzIDIuNTA2MTcgMC4xNzg3ODEgMS45NTM2NEMgMC4zNzg3OTMgMS40MDExIDAuNzM2ODA5IDAuOTIwODE3IDEuMjA3NTQgMC41NzM1MzhDIDEuNjc4MjYgMC4yMjYyNTkgMi4yNDA1NSAwLjAyNzU5MTkgMi44MjMyNiAwLjAwMjY3MjI5QyAzLjYwMzg5IC0wLjAzMDcxMTUgNC4zNjU3MyAwLjI0OTc4OSA0Ljk0MTQyIDAuNzgyNTUxQyA1LjUxNzExIDEuMzE1MzEgNS44NTk1NiAyLjA1Njc2IDUuODkzNTMgMi44NDRaIi8+CiAgICAgIDxwYXRoIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MzkuOCAyMzIzLjgxKSIgZD0iTSA3LjQyNzg5IDMuNTgzMzhDIDcuNDYwMDggNC4zMjQzIDcuMjczNTUgNS4wNTgxOSA2Ljg5MTkzIDUuNjkyMTNDIDYuNTEwMzEgNi4zMjYwNyA1Ljk1MDc1IDYuODMxNTYgNS4yODQxMSA3LjE0NDZDIDQuNjE3NDcgNy40NTc2MyAzLjg3MzcxIDcuNTY0MTQgMy4xNDcwMiA3LjQ1MDYzQyAyLjQyMDMyIDcuMzM3MTIgMS43NDMzNiA3LjAwODcgMS4yMDE4NCA2LjUwNjk1QyAwLjY2MDMyOCA2LjAwNTIgMC4yNzg2MSA1LjM1MjY4IDAuMTA1MDE3IDQuNjMyMDJDIC0wLjA2ODU3NTcgMy45MTEzNSAtMC4wMjYyMzYxIDMuMTU0OTQgMC4yMjY2NzUgMi40NTg1NkMgMC40Nzk1ODcgMS43NjIxNyAwLjkzMTY5NyAxLjE1NzEzIDEuNTI1NzYgMC43MjAwMzNDIDIuMTE5ODMgMC4yODI5MzUgMi44MjkxNCAwLjAzMzQzOTUgMy41NjM4OSAwLjAwMzEzMzQ0QyA0LjU0NjY3IC0wLjAzNzQwMzMgNS41MDUyOSAwLjMxNjcwNiA2LjIyOTYxIDAuOTg3ODM1QyA2Ljk1MzkzIDEuNjU4OTYgNy4zODQ4NCAyLjU5MjM1IDcuNDI3ODkgMy41ODMzOEwgNy40Mjc4OSAzLjU4MzM4WiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM4LjM2IDIyODYuMDYpIiBkPSJNIDIuMjc0NzEgNC4zOTYyOUMgMS44NDM2MyA0LjQxNTA4IDEuNDE2NzEgNC4zMDQ0NSAxLjA0Nzk5IDQuMDc4NDNDIDAuNjc5MjY4IDMuODUyNCAwLjM4NTMyOCAzLjUyMTE0IDAuMjAzMzcxIDMuMTI2NTZDIDAuMDIxNDEzNiAyLjczMTk4IC0wLjA0MDM3OTggMi4yOTE4MyAwLjAyNTgxMTYgMS44NjE4MUMgMC4wOTIwMDMxIDEuNDMxOCAwLjI4MzIwNCAxLjAzMTI2IDAuNTc1MjEzIDAuNzEwODgzQyAwLjg2NzIyMiAwLjM5MDUxIDEuMjQ2OTEgMC4xNjQ3MDggMS42NjYyMiAwLjA2MjA1OTJDIDIuMDg1NTMgLTAuMDQwNTg5NyAyLjUyNTYxIC0wLjAxNTQ3MTQgMi45MzA3NiAwLjEzNDIzNUMgMy4zMzU5MSAwLjI4Mzk0MSAzLjY4NzkyIDAuNTUxNTA1IDMuOTQyMjIgMC45MDMwNkMgNC4xOTY1MiAxLjI1NDYyIDQuMzQxNjkgMS42NzQzNiA0LjM1OTM1IDIuMTA5MTZDIDQuMzgyOTkgMi42OTEwNyA0LjE3Njc4IDMuMjU4NjkgMy43ODU5NyAzLjY4NzQ2QyAzLjM5NTE2IDQuMTE2MjQgMi44NTE2NiA0LjM3MTE2IDIuMjc0NzEgNC4zOTYyOUwgMi4yNzQ3MSA0LjM5NjI5WiIvPgogICAgPC9nPgogIDwvZz4+Cjwvc3ZnPgo=);
  --jp-icon-jupyterlab-wordmark: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIHZpZXdCb3g9IjAgMCAxODYwLjggNDc1Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0RTRFNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4MC4xMzY0MDEsIDY0LjI3MTQ5MykiPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDU4Ljg3NTU2NikiPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA4NzYwMywgMC4xNDAyOTQpIj4KICAgICAgICA8cGF0aCBkPSJNLTQyNi45LDE2OS44YzAsNDguNy0zLjcsNjQuNy0xMy42LDc2LjRjLTEwLjgsMTAtMjUsMTUuNS0zOS43LDE1LjVsMy43LDI5IGMyMi44LDAuMyw0NC44LTcuOSw2MS45LTIzLjFjMTcuOC0xOC41LDI0LTQ0LjEsMjQtODMuM1YwSC00Mjd2MTcwLjFMLTQyNi45LDE2OS44TC00MjYuOSwxNjkuOHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU1LjA0NTI5NiwgNTYuODM3MTA0KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuNTYyNDUzLCAxLjc5OTg0MikiPgogICAgICAgIDxwYXRoIGQ9Ik0tMzEyLDE0OGMwLDIxLDAsMzkuNSwxLjcsNTUuNGgtMzEuOGwtMi4xLTMzLjNoLTAuOGMtNi43LDExLjYtMTYuNCwyMS4zLTI4LDI3LjkgYy0xMS42LDYuNi0yNC44LDEwLTM4LjIsOS44Yy0zMS40LDAtNjktMTcuNy02OS04OVYwaDM2LjR2MTEyLjdjMCwzOC43LDExLjYsNjQuNyw0NC42LDY0LjdjMTAuMy0wLjIsMjAuNC0zLjUsMjguOS05LjQgYzguNS01LjksMTUuMS0xNC4zLDE4LjktMjMuOWMyLjItNi4xLDMuMy0xMi41LDMuMy0xOC45VjAuMmgzNi40VjE0OEgtMzEyTC0zMTIsMTQ4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOTAuMDEzMzIyLCA1My40Nzk2MzgpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS43MDY0NTgsIDAuMjMxNDI1KSI+CiAgICAgICAgPHBhdGggZD0iTS00NzguNiw3MS40YzAtMjYtMC44LTQ3LTEuNy02Ni43aDMyLjdsMS43LDM0LjhoMC44YzcuMS0xMi41LDE3LjUtMjIuOCwzMC4xLTI5LjcgYzEyLjUtNywyNi43LTEwLjMsNDEtOS44YzQ4LjMsMCw4NC43LDQxLjcsODQuNywxMDMuM2MwLDczLjEtNDMuNywxMDkuMi05MSwxMDkuMmMtMTIuMSwwLjUtMjQuMi0yLjItMzUtNy44IGMtMTAuOC01LjYtMTkuOS0xMy45LTI2LjYtMjQuMmgtMC44VjI5MWgtMzZ2LTIyMEwtNDc4LjYsNzEuNEwtNDc4LjYsNzEuNHogTS00NDIuNiwxMjUuNmMwLjEsNS4xLDAuNiwxMC4xLDEuNywxNS4xIGMzLDEyLjMsOS45LDIzLjMsMTkuOCwzMS4xYzkuOSw3LjgsMjIuMSwxMi4xLDM0LjcsMTIuMWMzOC41LDAsNjAuNy0zMS45LDYwLjctNzguNWMwLTQwLjctMjEuMS03NS42LTU5LjUtNzUuNiBjLTEyLjksMC40LTI1LjMsNS4xLTM1LjMsMTMuNGMtOS45LDguMy0xNi45LDE5LjctMTkuNiwzMi40Yy0xLjUsNC45LTIuMywxMC0yLjUsMTUuMVYxMjUuNkwtNDQyLjYsMTI1LjZMLTQ0Mi42LDEyNS42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDYuNzQwNzI2LCA1Ni44MzcxMDQpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC43NTEyMjYsIDEuOTg5Mjk5KSI+CiAgICAgICAgPHBhdGggZD0iTS00NDAuOCwwbDQzLjcsMTIwLjFjNC41LDEzLjQsOS41LDI5LjQsMTIuOCw0MS43aDAuOGMzLjctMTIuMiw3LjktMjcuNywxMi44LTQyLjQgbDM5LjctMTE5LjJoMzguNUwtMzQ2LjksMTQ1Yy0yNiw2OS43LTQzLjcsMTA1LjQtNjguNiwxMjcuMmMtMTIuNSwxMS43LTI3LjksMjAtNDQuNiwyMy45bC05LjEtMzEuMSBjMTEuNy0zLjksMjIuNS0xMC4xLDMxLjgtMTguMWMxMy4yLTExLjEsMjMuNy0yNS4yLDMwLjYtNDEuMmMxLjUtMi44LDIuNS01LjcsMi45LTguOGMtMC4zLTMuMy0xLjItNi42LTIuNS05LjdMLTQ4MC4yLDAuMSBoMzkuN0wtNDQwLjgsMEwtNDQwLjgsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODIyLjc0ODEwNCwgMC4wMDAwMDApIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS40NjQwNTAsIDAuMzc4OTE0KSI+CiAgICAgICAgPHBhdGggZD0iTS00MTMuNywwdjU4LjNoNTJ2MjguMmgtNTJWMTk2YzAsMjUsNywzOS41LDI3LjMsMzkuNWM3LjEsMC4xLDE0LjItMC43LDIxLjEtMi41IGwxLjcsMjcuN2MtMTAuMywzLjctMjEuMyw1LjQtMzIuMiw1Yy03LjMsMC40LTE0LjYtMC43LTIxLjMtMy40Yy02LjgtMi43LTEyLjktNi44LTE3LjktMTIuMWMtMTAuMy0xMC45LTE0LjEtMjktMTQuMS01Mi45IFY4Ni41aC0zMVY1OC4zaDMxVjkuNkwtNDEzLjcsMEwtNDEzLjcsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTc0LjQzMzI4NiwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuOTkwMDM0LCAwLjYxMDMzOSkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDQ1LjgsMTEzYzAuOCw1MCwzMi4yLDcwLjYsNjguNiw3MC42YzE5LDAuNiwzNy45LTMsNTUuMy0xMC41bDYuMiwyNi40IGMtMjAuOSw4LjktNDMuNSwxMy4xLTY2LjIsMTIuNmMtNjEuNSwwLTk4LjMtNDEuMi05OC4zLTEwMi41Qy00ODAuMiw0OC4yLTQ0NC43LDAtMzg2LjUsMGM2NS4yLDAsODIuNyw1OC4zLDgyLjcsOTUuNyBjLTAuMSw1LjgtMC41LDExLjUtMS4yLDE3LjJoLTE0MC42SC00NDUuOEwtNDQ1LjgsMTEzeiBNLTMzOS4yLDg2LjZjMC40LTIzLjUtOS41LTYwLjEtNTAuNC02MC4xIGMtMzYuOCwwLTUyLjgsMzQuNC01NS43LDYwLjFILTMzOS4yTC0zMzkuMiw4Ni42TC0zMzkuMiw4Ni42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjAxLjk2MTA1OCwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMTc5NjQwLCAwLjcwNTA2OCkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDc4LjYsNjhjMC0yMy45LTAuNC00NC41LTEuNy02My40aDMxLjhsMS4yLDM5LjloMS43YzkuMS0yNy4zLDMxLTQ0LjUsNTUuMy00NC41IGMzLjUtMC4xLDcsMC40LDEwLjMsMS4ydjM0LjhjLTQuMS0wLjktOC4yLTEuMy0xMi40LTEuMmMtMjUuNiwwLTQzLjcsMTkuNy00OC43LDQ3LjRjLTEsNS43LTEuNiwxMS41LTEuNywxNy4ydjEwOC4zaC0zNlY2OCBMLTQ3OC42LDY4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi13YXJuMCIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCBkPSJNMTM1Mi4zLDMyNi4yaDM3VjI4aC0zN1YzMjYuMnogTTE2MDQuOCwzMjYuMmMtMi41LTEzLjktMy40LTMxLjEtMy40LTQ4Ljd2LTc2IGMwLTQwLjctMTUuMS04My4xLTc3LjMtODMuMWMtMjUuNiwwLTUwLDcuMS02Ni44LDE4LjFsOC40LDI0LjRjMTQuMy05LjIsMzQtMTUuMSw1My0xNS4xYzQxLjYsMCw0Ni4yLDMwLjIsNDYuMiw0N3Y0LjIgYy03OC42LTAuNC0xMjIuMywyNi41LTEyMi4zLDc1LjZjMCwyOS40LDIxLDU4LjQsNjIuMiw1OC40YzI5LDAsNTAuOS0xNC4zLDYyLjItMzAuMmgxLjNsMi45LDI1LjZIMTYwNC44eiBNMTU2NS43LDI1Ny43IGMwLDMuOC0wLjgsOC0yLjEsMTEuOGMtNS45LDE3LjItMjIuNywzNC00OS4yLDM0Yy0xOC45LDAtMzQuOS0xMS4zLTM0LjktMzUuM2MwLTM5LjUsNDUuOC00Ni42LDg2LjItNDUuOFYyNTcuN3ogTTE2OTguNSwzMjYuMiBsMS43LTMzLjZoMS4zYzE1LjEsMjYuOSwzOC43LDM4LjIsNjguMSwzOC4yYzQ1LjQsMCw5MS4yLTM2LjEsOTEuMi0xMDguOGMwLjQtNjEuNy0zNS4zLTEwMy43LTg1LjctMTAzLjcgYy0zMi44LDAtNTYuMywxNC43LTY5LjMsMzcuNGgtMC44VjI4aC0zNi42djI0NS43YzAsMTguMS0wLjgsMzguNi0xLjcsNTIuNUgxNjk4LjV6IE0xNzA0LjgsMjA4LjJjMC01LjksMS4zLTEwLjksMi4xLTE1LjEgYzcuNi0yOC4xLDMxLjEtNDUuNCw1Ni4zLTQ1LjRjMzkuNSwwLDYwLjUsMzQuOSw2MC41LDc1LjZjMCw0Ni42LTIzLjEsNzguMS02MS44LDc4LjFjLTI2LjksMC00OC4zLTE3LjYtNTUuNS00My4zIGMtMC44LTQuMi0xLjctOC44LTEuNy0xMy40VjIwOC4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzYxNjE2MSIgZD0iTTE1IDlIOXY2aDZWOXptLTIgNGgtMnYtMmgydjJ6bTgtMlY5aC0yVjdjMC0xLjEtLjktMi0yLTJoLTJWM2gtMnYyaC0yVjNIOXYySDdjLTEuMSAwLTIgLjktMiAydjJIM3YyaDJ2MkgzdjJoMnYyYzAgMS4xLjkgMiAyIDJoMnYyaDJ2LTJoMnYyaDJ2LTJoMmMxLjEgMCAyLS45IDItMnYtMmgydi0yaC0ydi0yaDJ6bS00IDZIN1Y3aDEwdjEweiIvPgo8L3N2Zz4K);
  --jp-icon-keyboard: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMTdjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY3YzAtMS4xLS45LTItMi0yem0tOSAzaDJ2MmgtMlY4em0wIDNoMnYyaC0ydi0yek04IDhoMnYySDhWOHptMCAzaDJ2Mkg4di0yem0tMSAySDV2LTJoMnYyem0wLTNINVY4aDJ2MnptOSA3SDh2LTJoOHYyem0wLTRoLTJ2LTJoMnYyem0wLTNoLTJWOGgydjJ6bTMgM2gtMnYtMmgydjJ6bTAtM2gtMlY4aDJ2MnoiLz4KPC9zdmc+Cg==);
  --jp-icon-launch: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzIgMzIiIHdpZHRoPSIzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yNiwyOEg2YTIuMDAyNywyLjAwMjcsMCwwLDEtMi0yVjZBMi4wMDI3LDIuMDAyNywwLDAsMSw2LDRIMTZWNkg2VjI2SDI2VjE2aDJWMjZBMi4wMDI3LDIuMDAyNywwLDAsMSwyNiwyOFoiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjAgMiAyMCA0IDI2LjU4NiA0IDE4IDEyLjU4NiAxOS40MTQgMTQgMjggNS40MTQgMjggMTIgMzAgMTIgMzAgMiAyMCAyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-launcher: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkgMTlINVY1aDdWM0g1YTIgMiAwIDAwLTIgMnYxNGEyIDIgMCAwMDIgMmgxNGMxLjEgMCAyLS45IDItMnYtN2gtMnY3ek0xNCAzdjJoMy41OWwtOS44MyA5LjgzIDEuNDEgMS40MUwxOSA2LjQxVjEwaDJWM2gtN3oiLz4KPC9zdmc+Cg==);
  --jp-icon-line-form: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNNS44OCA0LjEyTDEzLjc2IDEybC03Ljg4IDcuODhMOCAyMmwxMC0xMEw4IDJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-link: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMuOSAxMmMwLTEuNzEgMS4zOS0zLjEgMy4xLTMuMWg0VjdIN2MtMi43NiAwLTUgMi4yNC01IDVzMi4yNCA1IDUgNWg0di0xLjlIN2MtMS43MSAwLTMuMS0xLjM5LTMuMS0zLjF6TTggMTNoOHYtMkg4djJ6bTktNmgtNHYxLjloNGMxLjcxIDAgMy4xIDEuMzkgMy4xIDMuMXMtMS4zOSAzLjEtMy4xIDMuMWgtNFYxN2g0YzIuNzYgMCA1LTIuMjQgNS01cy0yLjI0LTUtNS01eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xOSA1djE0SDVWNWgxNG0xLjEtMkgzLjljLS41IDAtLjkuNC0uOS45djE2LjJjMCAuNC40LjkuOS45aDE2LjJjLjQgMCAuOS0uNS45LS45VjMuOWMwLS41LS41LS45LS45LS45ek0xMSA3aDZ2MmgtNlY3em0wIDRoNnYyaC02di0yem0wIDRoNnYyaC02ek03IDdoMnYySDd6bTAgNGgydjJIN3ptMCA0aDJ2Mkg3eiIvPgo8L3N2Zz4K);
  --jp-icon-markdown: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjN0IxRkEyIiBkPSJNNSAxNC45aDEybC02LjEgNnptOS40LTYuOGMwLTEuMy0uMS0yLjktLjEtNC41LS40IDEuNC0uOSAyLjktMS4zIDQuM2wtMS4zIDQuM2gtMkw4LjUgNy45Yy0uNC0xLjMtLjctMi45LTEtNC4zLS4xIDEuNi0uMSAzLjItLjIgNC42TDcgMTIuNEg0LjhsLjctMTFoMy4zTDEwIDVjLjQgMS4yLjcgMi43IDEgMy45LjMtMS4yLjctMi42IDEtMy45bDEuMi0zLjdoMy4zbC42IDExaC0yLjRsLS4zLTQuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-move-down: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMTIuNDcxIDcuNTI4OTlDMTIuNzYzMiA3LjIzNjg0IDEyLjc2MzIgNi43NjMxNiAxMi40NzEgNi40NzEwMVY2LjQ3MTAxQzEyLjE3OSA2LjE3OTA1IDExLjcwNTcgNi4xNzg4NCAxMS40MTM1IDYuNDcwNTRMNy43NSAxMC4xMjc1VjEuNzVDNy43NSAxLjMzNTc5IDcuNDE0MjEgMSA3IDFWMUM2LjU4NTc5IDEgNi4yNSAxLjMzNTc5IDYuMjUgMS43NVYxMC4xMjc1TDIuNTk3MjYgNi40NjgyMkMyLjMwMzM4IDYuMTczODEgMS44MjY0MSA2LjE3MzU5IDEuNTMyMjYgNi40Njc3NFY2LjQ2Nzc0QzEuMjM4MyA2Ljc2MTcgMS4yMzgzIDcuMjM4MyAxLjUzMjI2IDcuNTMyMjZMNi4yOTI4OSAxMi4yOTI5QzYuNjgzNDIgMTIuNjgzNCA3LjMxNjU4IDEyLjY4MzQgNy43MDcxMSAxMi4yOTI5TDEyLjQ3MSA3LjUyODk5WiIgZmlsbD0iIzYxNjE2MSIvPgo8L3N2Zz4K);
  --jp-icon-move-up: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMS41Mjg5OSA2LjQ3MTAxQzEuMjM2ODQgNi43NjMxNiAxLjIzNjg0IDcuMjM2ODQgMS41Mjg5OSA3LjUyODk5VjcuNTI4OTlDMS44MjA5NSA3LjgyMDk1IDIuMjk0MjYgNy44MjExNiAyLjU4NjQ5IDcuNTI5NDZMNi4yNSAzLjg3MjVWMTIuMjVDNi4yNSAxMi42NjQyIDYuNTg1NzkgMTMgNyAxM1YxM0M3LjQxNDIxIDEzIDcuNzUgMTIuNjY0MiA3Ljc1IDEyLjI1VjMuODcyNUwxMS40MDI3IDcuNTMxNzhDMTEuNjk2NiA3LjgyNjE5IDEyLjE3MzYgNy44MjY0MSAxMi40Njc3IDcuNTMyMjZWNy41MzIyNkMxMi43NjE3IDcuMjM4MyAxMi43NjE3IDYuNzYxNyAxMi40Njc3IDYuNDY3NzRMNy43MDcxMSAxLjcwNzExQzcuMzE2NTggMS4zMTY1OCA2LjY4MzQyIDEuMzE2NTggNi4yOTI4OSAxLjcwNzExTDEuNTI4OTkgNi40NzEwMVoiIGZpbGw9IiM2MTYxNjEiLz4KPC9zdmc+Cg==);
  --jp-icon-new-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwIDZoLThsLTItMkg0Yy0xLjExIDAtMS45OS44OS0xLjk5IDJMMiAxOGMwIDEuMTEuODkgMiAyIDJoMTZjMS4xMSAwIDItLjg5IDItMlY4YzAtMS4xMS0uODktMi0yLTJ6bS0xIDhoLTN2M2gtMnYtM2gtM3YtMmgzVjloMnYzaDN2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-not-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMTkgMTcuMTg0NCAyLjk2OTY4IDE0LjMwMzIgMS44NjA5NCAxMS40NDA5WiIvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24yIiBzdHJva2U9IiMzMzMzMzMiIHN0cm9rZS13aWR0aD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOS4zMTU5MiA5LjMyMDMxKSIgZD0iTTcuMzY4NDIgMEwwIDcuMzY0NzkiLz4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuMzE1OTIgMTYuNjgzNikgc2NhbGUoMSAtMSkiIGQ9Ik03LjM2ODQyIDBMMCA3LjM2NDc5Ii8+Cjwvc3ZnPgo=);
  --jp-icon-notebook: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtbm90ZWJvb2staWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNFRjZDMDAiPgogICAgPHBhdGggZD0iTTE4LjcgMy4zdjE1LjRIMy4zVjMuM2gxNS40bTEuNS0xLjVIMS44djE4LjNoMTguM2wuMS0xOC4zeiIvPgogICAgPHBhdGggZD0iTTE2LjUgMTYuNWwtNS40LTQuMy01LjYgNC4zdi0xMWgxMXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-numbering: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTQgMTlINlYxOS41SDVWMjAuNUg2VjIxSDRWMjJIN1YxOEg0VjE5Wk01IDEwSDZWNkg0VjdINVYxMFpNNCAxM0g1LjhMNCAxNS4xVjE2SDdWMTVINS4yTDcgMTIuOVYxMkg0VjEzWk05IDdWOUgyM1Y3SDlaTTkgMjFIMjNWMTlIOVYyMVpNOSAxNUgyM1YxM0g5VjE1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-offline-bolt: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDIuMDJjLTUuNTEgMC05Ljk4IDQuNDctOS45OCA5Ljk4czQuNDcgOS45OCA5Ljk4IDkuOTggOS45OC00LjQ3IDkuOTgtOS45OFMxNy41MSAyLjAyIDEyIDIuMDJ6TTExLjQ4IDIwdi02LjI2SDhMMTMgNHY2LjI2aDMuMzVMMTEuNDggMjB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-palette: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE4IDEzVjIwSDRWNkg5LjAyQzkuMDcgNS4yOSA5LjI0IDQuNjIgOS41IDRINEMyLjkgNCAyIDQuOSAyIDZWMjBDMiAyMS4xIDIuOSAyMiA0IDIySDE4QzE5LjEgMjIgMjAgMjEuMSAyMCAyMFYxNUwxOCAxM1pNMTkuMyA4Ljg5QzE5Ljc0IDguMTkgMjAgNy4zOCAyMCA2LjVDMjAgNC4wMSAxNy45OSAyIDE1LjUgMkMxMy4wMSAyIDExIDQuMDEgMTEgNi41QzExIDguOTkgMTMuMDEgMTEgMTUuNDkgMTFDMTYuMzcgMTEgMTcuMTkgMTAuNzQgMTcuODggMTAuM0wyMSAxMy40MkwyMi40MiAxMkwxOS4zIDguODlaTTE1LjUgOUMxNC4xMiA5IDEzIDcuODggMTMgNi41QzEzIDUuMTIgMTQuMTIgNCAxNS41IDRDMTYuODggNCAxOCA1LjEyIDE4IDYuNUMxOCA3Ljg4IDE2Ljg4IDkgMTUuNSA5WiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDZIOS4wMTg5NEM5LjAwNjM5IDYuMTY1MDIgOSA2LjMzMTc2IDkgNi41QzkgOC44MTU3NyAxMC4yMTEgMTAuODQ4NyAxMi4wMzQzIDEySDlWMTRIMTZWMTIuOTgxMUMxNi41NzAzIDEyLjkzNzcgMTcuMTIgMTIuODIwNyAxNy42Mzk2IDEyLjYzOTZMMTggMTNWMjBINFY2Wk04IDhINlYxMEg4VjhaTTYgMTJIOFYxNEg2VjEyWk04IDE2SDZWMThIOFYxNlpNOSAxNkgxNlYxOEg5VjE2WiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-paste: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE5IDJoLTQuMThDMTQuNC44NCAxMy4zIDAgMTIgMGMtMS4zIDAtMi40Ljg0LTIuODIgMkg1Yy0xLjEgMC0yIC45LTIgMnYxNmMwIDEuMS45IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjRjMC0xLjEtLjktMi0yLTJ6bS03IDBjLjU1IDAgMSAuNDUgMSAxcy0uNDUgMS0xIDEtMS0uNDUtMS0xIC40NS0xIDEtMXptNyAxOEg1VjRoMnYzaDEwVjRoMnYxNnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-pdf: url(data:image/svg+xml;base64,PHN2ZwogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMiAyMiIgd2lkdGg9IjE2Ij4KICAgIDxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDQ1KSIgY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0ZGMkEyQSIKICAgICAgIGQ9Im0gMjIuMzQ0MzY5LC0zLjAxNjM2NDIgaCA1LjYzODYwNCB2IDEuNTc5MjQzMyBoIC0zLjU0OTIyNyB2IDEuNTA4NjkyOTkgaCAzLjMzNzU3NiBWIDEuNjUwODE1NCBoIC0zLjMzNzU3NiB2IDMuNDM1MjYxMyBoIC0yLjA4OTM3NyB6IG0gLTcuMTM2NDQ0LDEuNTc5MjQzMyB2IDQuOTQzOTU0MyBoIDAuNzQ4OTIgcSAxLjI4MDc2MSwwIDEuOTUzNzAzLC0wLjYzNDk1MzUgMC42NzgzNjksLTAuNjM0OTUzNSAwLjY3ODM2OSwtMS44NDUxNjQxIDAsLTEuMjA0NzgzNTUgLTAuNjcyOTQyLC0xLjgzNDMxMDExIC0wLjY3Mjk0MiwtMC42Mjk1MjY1OSAtMS45NTkxMywtMC42Mjk1MjY1OSB6IG0gLTIuMDg5Mzc3LC0xLjU3OTI0MzMgaCAyLjIwMzM0MyBxIDEuODQ1MTY0LDAgMi43NDYwMzksMC4yNjU5MjA3IDAuOTA2MzAxLDAuMjYwNDkzNyAxLjU1MjEwOCwwLjg5MDAyMDMgMC41Njk4MywwLjU0ODEyMjMgMC44NDY2MDUsMS4yNjQ0ODAwNiAwLjI3Njc3NCwwLjcxNjM1NzgxIDAuMjc2Nzc0LDEuNjIyNjU4OTQgMCwwLjkxNzE1NTEgLTAuMjc2Nzc0LDEuNjM4OTM5OSAtMC4yNzY3NzUsMC43MTYzNTc4IC0wLjg0NjYwNSwxLjI2NDQ4IC0wLjY1MTIzNCwwLjYyOTUyNjYgLTEuNTYyOTYyLDAuODk1NDQ3MyAtMC45MTE3MjgsMC4yNjA0OTM3IC0yLjczNTE4NSwwLjI2MDQ5MzcgaCAtMi4yMDMzNDMgeiBtIC04LjE0NTg1NjUsMCBoIDMuNDY3ODIzIHEgMS41NDY2ODE2LDAgMi4zNzE1Nzg1LDAuNjg5MjIzIDAuODMwMzI0LDAuNjgzNzk2MSAwLjgzMDMyNCwxLjk1MzcwMzE0IDAsMS4yNzUzMzM5NyAtMC44MzAzMjQsMS45NjQ1NTcwNiBRIDkuOTg3MTk2MSwyLjI3NDkxNSA4LjQ0MDUxNDUsMi4yNzQ5MTUgSCA3LjA2MjA2ODQgViA1LjA4NjA3NjcgSCA0Ljk3MjY5MTUgWiBtIDIuMDg5Mzc2OSwxLjUxNDExOTkgdiAyLjI2MzAzOTQzIGggMS4xNTU5NDEgcSAwLjYwNzgxODgsMCAwLjkzODg2MjksLTAuMjkzMDU1NDcgMC4zMzEwNDQxLC0wLjI5ODQ4MjQxIDAuMzMxMDQ0MSwtMC44NDExNzc3MiAwLC0wLjU0MjY5NTMxIC0wLjMzMTA0NDEsLTAuODM1NzUwNzQgLTAuMzMxMDQ0MSwtMC4yOTMwNTU1IC0wLjkzODg2MjksLTAuMjkzMDU1NSB6IgovPgo8L3N2Zz4K);
  --jp-icon-python: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iLTEwIC0xMCAxMzEuMTYxMzYxNjk0MzM1OTQgMTMyLjM4ODk5OTkzODk2NDg0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzA2OTk4IiBkPSJNIDU0LjkxODc4NSw5LjE5Mjc0MjFlLTQgQyA1MC4zMzUxMzIsMC4wMjIyMTcyNyA0NS45NTc4NDYsMC40MTMxMzY5NyA0Mi4xMDYyODUsMS4wOTQ2NjkzIDMwLjc2MDA2OSwzLjA5OTE3MzEgMjguNzAwMDM2LDcuMjk0NzcxNCAyOC43MDAwMzUsMTUuMDMyMTY5IHYgMTAuMjE4NzUgaCAyNi44MTI1IHYgMy40MDYyNSBoIC0yNi44MTI1IC0xMC4wNjI1IGMgLTcuNzkyNDU5LDAgLTE0LjYxNTc1ODgsNC42ODM3MTcgLTE2Ljc0OTk5OTgsMTMuNTkzNzUgLTIuNDYxODE5OTgsMTAuMjEyOTY2IC0yLjU3MTAxNTA4LDE2LjU4NjAyMyAwLDI3LjI1IDEuOTA1OTI4Myw3LjkzNzg1MiA2LjQ1NzU0MzIsMTMuNTkzNzQ4IDE0LjI0OTk5OTgsMTMuNTkzNzUgaCA5LjIxODc1IHYgLTEyLjI1IGMgMCwtOC44NDk5MDIgNy42NTcxNDQsLTE2LjY1NjI0OCAxNi43NSwtMTYuNjU2MjUgaCAyNi43ODEyNSBjIDcuNDU0OTUxLDAgMTMuNDA2MjUzLC02LjEzODE2NCAxMy40MDYyNSwtMTMuNjI1IHYgLTI1LjUzMTI1IGMgMCwtNy4yNjYzMzg2IC02LjEyOTk4LC0xMi43MjQ3NzcxIC0xMy40MDYyNSwtMTMuOTM3NDk5NyBDIDY0LjI4MTU0OCwwLjMyNzk0Mzk3IDU5LjUwMjQzOCwtMC4wMjAzNzkwMyA1NC45MTg3ODUsOS4xOTI3NDIxZS00IFogbSAtMTQuNSw4LjIxODc1MDEyNTc5IGMgMi43Njk1NDcsMCA1LjAzMTI1LDIuMjk4NjQ1NiA1LjAzMTI1LDUuMTI0OTk5NiAtMmUtNiwyLjgxNjMzNiAtMi4yNjE3MDMsNS4wOTM3NSAtNS4wMzEyNSw1LjA5Mzc1IC0yLjc3OTQ3NiwtMWUtNiAtNS4wMzEyNSwtMi4yNzc0MTUgLTUuMDMxMjUsLTUuMDkzNzUgLTEwZS03LC0yLjgyNjM1MyAyLjI1MTc3NCwtNS4xMjQ5OTk2IDUuMDMxMjUsLTUuMTI0OTk5NiB6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2ZmZDQzYiIgZD0ibSA4NS42Mzc1MzUsMjguNjU3MTY5IHYgMTEuOTA2MjUgYyAwLDkuMjMwNzU1IC03LjgyNTg5NSwxNi45OTk5OTkgLTE2Ljc1LDE3IGggLTI2Ljc4MTI1IGMgLTcuMzM1ODMzLDAgLTEzLjQwNjI0OSw2LjI3ODQ4MyAtMTMuNDA2MjUsMTMuNjI1IHYgMjUuNTMxMjQ3IGMgMCw3LjI2NjM0NCA2LjMxODU4OCwxMS41NDAzMjQgMTMuNDA2MjUsMTMuNjI1MDA0IDguNDg3MzMxLDIuNDk1NjEgMTYuNjI2MjM3LDIuOTQ2NjMgMjYuNzgxMjUsMCA2Ljc1MDE1NSwtMS45NTQzOSAxMy40MDYyNTMsLTUuODg3NjEgMTMuNDA2MjUsLTEzLjYyNTAwNCBWIDg2LjUwMDkxOSBoIC0yNi43ODEyNSB2IC0zLjQwNjI1IGggMjYuNzgxMjUgMTMuNDA2MjU0IGMgNy43OTI0NjEsMCAxMC42OTYyNTEsLTUuNDM1NDA4IDEzLjQwNjI0MSwtMTMuNTkzNzUgMi43OTkzMywtOC4zOTg4ODYgMi42ODAyMiwtMTYuNDc1Nzc2IDAsLTI3LjI1IC0xLjkyNTc4LC03Ljc1NzQ0MSAtNS42MDM4NywtMTMuNTkzNzUgLTEzLjQwNjI0MSwtMTMuNTkzNzUgeiBtIC0xNS4wNjI1LDY0LjY1NjI1IGMgMi43Nzk0NzgsM2UtNiA1LjAzMTI1LDIuMjc3NDE3IDUuMDMxMjUsNS4wOTM3NDcgLTJlLTYsMi44MjYzNTQgLTIuMjUxNzc1LDUuMTI1MDA0IC01LjAzMTI1LDUuMTI1MDA0IC0yLjc2OTU1LDAgLTUuMDMxMjUsLTIuMjk4NjUgLTUuMDMxMjUsLTUuMTI1MDA0IDJlLTYsLTIuODE2MzMgMi4yNjE2OTcsLTUuMDkzNzQ3IDUuMDMxMjUsLTUuMDkzNzQ3IHoiLz4KPC9zdmc+Cg==);
  --jp-icon-r-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjE5NkYzIiBkPSJNNC40IDIuNWMxLjItLjEgMi45LS4zIDQuOS0uMyAyLjUgMCA0LjEuNCA1LjIgMS4zIDEgLjcgMS41IDEuOSAxLjUgMy41IDAgMi0xLjQgMy41LTIuOSA0LjEgMS4yLjQgMS43IDEuNiAyLjIgMyAuNiAxLjkgMSAzLjkgMS4zIDQuNmgtMy44Yy0uMy0uNC0uOC0xLjctMS4yLTMuN3MtMS4yLTIuNi0yLjYtMi42aC0uOXY2LjRINC40VjIuNXptMy43IDYuOWgxLjRjMS45IDAgMi45LS45IDIuOS0yLjNzLTEtMi4zLTIuOC0yLjNjLS43IDAtMS4zIDAtMS42LjJ2NC41aC4xdi0uMXoiLz4KPC9zdmc+Cg==);
  --jp-icon-react: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMTUwIDE1MCA1NDEuOSAyOTUuMyI+CiAgPGcgY2xhc3M9ImpwLWljb24tYnJhbmQyIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxREFGQiI+CiAgICA8cGF0aCBkPSJNNjY2LjMgMjk2LjVjMC0zMi41LTQwLjctNjMuMy0xMDMuMS04Mi40IDE0LjQtNjMuNiA4LTExNC4yLTIwLjItMTMwLjQtNi41LTMuOC0xNC4xLTUuNi0yMi40LTUuNnYyMi4zYzQuNiAwIDguMy45IDExLjQgMi42IDEzLjYgNy44IDE5LjUgMzcuNSAxNC45IDc1LjctMS4xIDkuNC0yLjkgMTkuMy01LjEgMjkuNC0xOS42LTQuOC00MS04LjUtNjMuNS0xMC45LTEzLjUtMTguNS0yNy41LTM1LjMtNDEuNi01MCAzMi42LTMwLjMgNjMuMi00Ni45IDg0LTQ2LjlWNzhjLTI3LjUgMC02My41IDE5LjYtOTkuOSA1My42LTM2LjQtMzMuOC03Mi40LTUzLjItOTkuOS01My4ydjIyLjNjMjAuNyAwIDUxLjQgMTYuNSA4NCA0Ni42LTE0IDE0LjctMjggMzEuNC00MS4zIDQ5LjktMjIuNiAyLjQtNDQgNi4xLTYzLjYgMTEtMi4zLTEwLTQtMTkuNy01LjItMjktNC43LTM4LjIgMS4xLTY3LjkgMTQuNi03NS44IDMtMS44IDYuOS0yLjYgMTEuNS0yLjZWNzguNWMtOC40IDAtMTYgMS44LTIyLjYgNS42LTI4LjEgMTYuMi0zNC40IDY2LjctMTkuOSAxMzAuMS02Mi4yIDE5LjItMTAyLjcgNDkuOS0xMDIuNyA4Mi4zIDAgMzIuNSA0MC43IDYzLjMgMTAzLjEgODIuNC0xNC40IDYzLjYtOCAxMTQuMiAyMC4yIDEzMC40IDYuNSAzLjggMTQuMSA1LjYgMjIuNSA1LjYgMjcuNSAwIDYzLjUtMTkuNiA5OS45LTUzLjYgMzYuNCAzMy44IDcyLjQgNTMuMiA5OS45IDUzLjIgOC40IDAgMTYtMS44IDIyLjYtNS42IDI4LjEtMTYuMiAzNC40LTY2LjcgMTkuOS0xMzAuMSA2Mi0xOS4xIDEwMi41LTQ5LjkgMTAyLjUtODIuM3ptLTEzMC4yLTY2LjdjLTMuNyAxMi45LTguMyAyNi4yLTEzLjUgMzkuNS00LjEtOC04LjQtMTYtMTMuMS0yNC00LjYtOC05LjUtMTUuOC0xNC40LTIzLjQgMTQuMiAyLjEgMjcuOSA0LjcgNDEgNy45em0tNDUuOCAxMDYuNWMtNy44IDEzLjUtMTUuOCAyNi4zLTI0LjEgMzguMi0xNC45IDEuMy0zMCAyLTQ1LjIgMi0xNS4xIDAtMzAuMi0uNy00NS0xLjktOC4zLTExLjktMTYuNC0yNC42LTI0LjItMzgtNy42LTEzLjEtMTQuNS0yNi40LTIwLjgtMzkuOCA2LjItMTMuNCAxMy4yLTI2LjggMjAuNy0zOS45IDcuOC0xMy41IDE1LjgtMjYuMyAyNC4xLTM4LjIgMTQuOS0xLjMgMzAtMiA0NS4yLTIgMTUuMSAwIDMwLjIuNyA0NSAxLjkgOC4zIDExLjkgMTYuNCAyNC42IDI0LjIgMzggNy42IDEzLjEgMTQuNSAyNi40IDIwLjggMzkuOC02LjMgMTMuNC0xMy4yIDI2LjgtMjAuNyAzOS45em0zMi4zLTEzYzUuNCAxMy40IDEwIDI2LjggMTMuOCAzOS44LTEzLjEgMy4yLTI2LjkgNS45LTQxLjIgOCA0LjktNy43IDkuOC0xNS42IDE0LjQtMjMuNyA0LjYtOCA4LjktMTYuMSAxMy0yNC4xek00MjEuMiA0MzBjLTkuMy05LjYtMTguNi0yMC4zLTI3LjgtMzIgOSAuNCAxOC4yLjcgMjcuNS43IDkuNCAwIDE4LjctLjIgMjcuOC0uNy05IDExLjctMTguMyAyMi40LTI3LjUgMzJ6bS03NC40LTU4LjljLTE0LjItMi4xLTI3LjktNC43LTQxLTcuOSAzLjctMTIuOSA4LjMtMjYuMiAxMy41LTM5LjUgNC4xIDggOC40IDE2IDEzLjEgMjQgNC43IDggOS41IDE1LjggMTQuNCAyMy40ek00MjAuNyAxNjNjOS4zIDkuNiAxOC42IDIwLjMgMjcuOCAzMi05LS40LTE4LjItLjctMjcuNS0uNy05LjQgMC0xOC43LjItMjcuOC43IDktMTEuNyAxOC4zLTIyLjQgMjcuNS0zMnptLTc0IDU4LjljLTQuOSA3LjctOS44IDE1LjYtMTQuNCAyMy43LTQuNiA4LTguOSAxNi0xMyAyNC01LjQtMTMuNC0xMC0yNi44LTEzLjgtMzkuOCAxMy4xLTMuMSAyNi45LTUuOCA0MS4yLTcuOXptLTkwLjUgMTI1LjJjLTM1LjQtMTUuMS01OC4zLTM0LjktNTguMy01MC42IDAtMTUuNyAyMi45LTM1LjYgNTguMy01MC42IDguNi0zLjcgMTgtNyAyNy43LTEwLjEgNS43IDE5LjYgMTMuMiA0MCAyMi41IDYwLjktOS4yIDIwLjgtMTYuNiA0MS4xLTIyLjIgNjAuNi05LjktMy4xLTE5LjMtNi41LTI4LTEwLjJ6TTMxMCA0OTBjLTEzLjYtNy44LTE5LjUtMzcuNS0xNC45LTc1LjcgMS4xLTkuNCAyLjktMTkuMyA1LjEtMjkuNCAxOS42IDQuOCA0MSA4LjUgNjMuNSAxMC45IDEzLjUgMTguNSAyNy41IDM1LjMgNDEuNiA1MC0zMi42IDMwLjMtNjMuMiA0Ni45LTg0IDQ2LjktNC41LS4xLTguMy0xLTExLjMtMi43em0yMzcuMi03Ni4yYzQuNyAzOC4yLTEuMSA2Ny45LTE0LjYgNzUuOC0zIDEuOC02LjkgMi42LTExLjUgMi42LTIwLjcgMC01MS40LTE2LjUtODQtNDYuNiAxNC0xNC43IDI4LTMxLjQgNDEuMy00OS45IDIyLjYtMi40IDQ0LTYuMSA2My42LTExIDIuMyAxMC4xIDQuMSAxOS44IDUuMiAyOS4xem0zOC41LTY2LjdjLTguNiAzLjctMTggNy0yNy43IDEwLjEtNS43LTE5LjYtMTMuMi00MC0yMi41LTYwLjkgOS4yLTIwLjggMTYuNi00MS4xIDIyLjItNjAuNiA5LjkgMy4xIDE5LjMgNi41IDI4LjEgMTAuMiAzNS40IDE1LjEgNTguMyAzNC45IDU4LjMgNTAuNi0uMSAxNS43LTIzIDM1LjYtNTguNCA1MC42ek0zMjAuOCA3OC40eiIvPgogICAgPGNpcmNsZSBjeD0iNDIwLjkiIGN5PSIyOTYuNSIgcj0iNDUuNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-redo: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTE4LjQgMTAuNkMxNi41NSA4Ljk5IDE0LjE1IDggMTEuNSA4Yy00LjY1IDAtOC41OCAzLjAzLTkuOTYgNy4yMkwzLjkgMTZjMS4wNS0zLjE5IDQuMDUtNS41IDcuNi01LjUgMS45NSAwIDMuNzMuNzIgNS4xMiAxLjg4TDEzIDE2aDlWN2wtMy42IDMuNnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-refresh: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTkgMTMuNWMtMi40OSAwLTQuNS0yLjAxLTQuNS00LjVTNi41MSA0LjUgOSA0LjVjMS4yNCAwIDIuMzYuNTIgMy4xNyAxLjMzTDEwIDhoNVYzbC0xLjc2IDEuNzZDMTIuMTUgMy42OCAxMC42NiAzIDkgMyA1LjY5IDMgMy4wMSA1LjY5IDMuMDEgOVM1LjY5IDE1IDkgMTVjMi45NyAwIDUuNDMtMi4xNiA1LjktNWgtMS41MmMtLjQ2IDItMi4yNCAzLjUtNC4zOCAzLjV6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-regex: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiBmaWxsPSIjRkZGIj4KICAgIDxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjUuNSIgY3k9IjE0LjUiIHI9IjEuNSIvPgogICAgPHJlY3QgeD0iMTIiIHk9IjQiIGNsYXNzPSJzdDIiIHdpZHRoPSIxIiBoZWlnaHQ9IjgiLz4KICAgIDxyZWN0IHg9IjguNSIgeT0iNy41IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjg2NiAtMC41IDAuNSAwLjg2NiAtMi4zMjU1IDcuMzIxOSkiIGNsYXNzPSJzdDIiIHdpZHRoPSI4IiBoZWlnaHQ9IjEiLz4KICAgIDxyZWN0IHg9IjEyIiB5PSI0IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjUgLTAuODY2IDAuODY2IDAuNSAtMC42Nzc5IDE0LjgyNTIpIiBjbGFzcz0ic3QyIiB3aWR0aD0iMSIgaGVpZ2h0PSI4Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-run: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTggNXYxNGwxMS03eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-running: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptOTYgMzI4YzAgOC44LTcuMiAxNi0xNiAxNkgxNzZjLTguOCAwLTE2LTcuMi0xNi0xNlYxNzZjMC04LjggNy4yLTE2IDE2LTE2aDE2MGM4LjggMCAxNiA3LjIgMTYgMTZ2MTYweiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-save: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE3IDNINWMtMS4xMSAwLTIgLjktMiAydjE0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjdsLTQtNHptLTUgMTZjLTEuNjYgMC0zLTEuMzQtMy0zczEuMzQtMyAzLTMgMyAxLjM0IDMgMy0xLjM0IDMtMyAzem0zLTEwSDVWNWgxMHY0eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-search: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjEsMTAuOWgtMC43bC0wLjItMC4yYzAuOC0wLjksMS4zLTIuMiwxLjMtMy41YzAtMy0yLjQtNS40LTUuNC01LjRTMS44LDQuMiwxLjgsNy4xczIuNCw1LjQsNS40LDUuNCBjMS4zLDAsMi41LTAuNSwzLjUtMS4zbDAuMiwwLjJ2MC43bDQuMSw0LjFsMS4yLTEuMkwxMi4xLDEwLjl6IE03LjEsMTAuOWMtMi4xLDAtMy43LTEuNy0zLjctMy43czEuNy0zLjcsMy43LTMuN3MzLjcsMS43LDMuNywzLjcgUzkuMiwxMC45LDcuMSwxMC45eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-settings: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVBLjQ4OC40ODggMCAwMDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==);
  --jp-icon-share: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTSAxOCAyIEMgMTYuMzU0OTkgMiAxNSAzLjM1NDk5MDQgMTUgNSBDIDE1IDUuMTkwOTUyOSAxNS4wMjE3OTEgNS4zNzcxMjI0IDE1LjA1NjY0MSA1LjU1ODU5MzggTCA3LjkyMTg3NSA5LjcyMDcwMzEgQyA3LjM5ODUzOTkgOS4yNzc4NTM5IDYuNzMyMDc3MSA5IDYgOSBDIDQuMzU0OTkwNCA5IDMgMTAuMzU0OTkgMyAxMiBDIDMgMTMuNjQ1MDEgNC4zNTQ5OTA0IDE1IDYgMTUgQyA2LjczMjA3NzEgMTUgNy4zOTg1Mzk5IDE0LjcyMjE0NiA3LjkyMTg3NSAxNC4yNzkyOTcgTCAxNS4wNTY2NDEgMTguNDM5NDUzIEMgMTUuMDIxNTU1IDE4LjYyMTUxNCAxNSAxOC44MDgzODYgMTUgMTkgQyAxNSAyMC42NDUwMSAxNi4zNTQ5OSAyMiAxOCAyMiBDIDE5LjY0NTAxIDIyIDIxIDIwLjY0NTAxIDIxIDE5IEMgMjEgMTcuMzU0OTkgMTkuNjQ1MDEgMTYgMTggMTYgQyAxNy4yNjc0OCAxNiAxNi42MDE1OTMgMTYuMjc5MzI4IDE2LjA3ODEyNSAxNi43MjI2NTYgTCA4Ljk0MzM1OTQgMTIuNTU4NTk0IEMgOC45NzgyMDk1IDEyLjM3NzEyMiA5IDEyLjE5MDk1MyA5IDEyIEMgOSAxMS44MDkwNDcgOC45NzgyMDk1IDExLjYyMjg3OCA4Ljk0MzM1OTQgMTEuNDQxNDA2IEwgMTYuMDc4MTI1IDcuMjc5Mjk2OSBDIDE2LjYwMTQ2IDcuNzIyMTQ2MSAxNy4yNjc5MjMgOCAxOCA4IEMgMTkuNjQ1MDEgOCAyMSA2LjY0NTAwOTYgMjEgNSBDIDIxIDMuMzU0OTkwNCAxOS42NDUwMSAyIDE4IDIgeiBNIDE4IDQgQyAxOC41NjQxMjkgNCAxOSA0LjQzNTg3MDYgMTkgNSBDIDE5IDUuNTY0MTI5NCAxOC41NjQxMjkgNiAxOCA2IEMgMTcuNDM1ODcxIDYgMTcgNS41NjQxMjk0IDE3IDUgQyAxNyA0LjQzNTg3MDYgMTcuNDM1ODcxIDQgMTggNCB6IE0gNiAxMSBDIDYuNTY0MTI5NCAxMSA3IDExLjQzNTg3MSA3IDEyIEMgNyAxMi41NjQxMjkgNi41NjQxMjk0IDEzIDYgMTMgQyA1LjQzNTg3MDYgMTMgNSAxMi41NjQxMjkgNSAxMiBDIDUgMTEuNDM1ODcxIDUuNDM1ODcwNiAxMSA2IDExIHogTSAxOCAxOCBDIDE4LjU2NDEyOSAxOCAxOSAxOC40MzU4NzEgMTkgMTkgQyAxOSAxOS41NjQxMjkgMTguNTY0MTI5IDIwIDE4IDIwIEMgMTcuNDM1ODcxIDIwIDE3IDE5LjU2NDEyOSAxNyAxOSBDIDE3IDE4LjQzNTg3MSAxNy40MzU4NzEgMTggMTggMTggeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-spreadsheet: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNENBRjUwIiBkPSJNMi4yIDIuMnYxNy42aDE3LjZWMi4ySDIuMnptMTUuNCA3LjdoLTUuNVY0LjRoNS41djUuNXpNOS45IDQuNHY1LjVINC40VjQuNGg1LjV6bS01LjUgNy43aDUuNXY1LjVINC40di01LjV6bTcuNyA1LjV2LTUuNWg1LjV2NS41aC01LjV6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-stop: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tab: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIxIDNIM2MtMS4xIDAtMiAuOS0yIDJ2MTRjMCAxLjEuOSAyIDIgMmgxOGMxLjEgMCAyLS45IDItMlY1YzAtMS4xLS45LTItMi0yem0wIDE2SDNWNWgxMHY0aDh2MTB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-table-rows: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMSw4SDNWNGgxOFY4eiBNMjEsMTBIM3Y0aDE4VjEweiBNMjEsMTZIM3Y0aDE4VjE2eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-tag: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCA0MyAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTI4LjgzMzIgMTIuMzM0TDMyLjk5OTggMTYuNTAwN0wzNy4xNjY1IDEyLjMzNEgyOC44MzMyWiIvPgoJCTxwYXRoIGQ9Ik0xNi4yMDk1IDIxLjYxMDRDMTUuNjg3MyAyMi4xMjk5IDE0Ljg0NDMgMjIuMTI5OSAxNC4zMjQ4IDIxLjYxMDRMNi45ODI5IDE0LjcyNDVDNi41NzI0IDE0LjMzOTQgNi4wODMxMyAxMy42MDk4IDYuMDQ3ODYgMTMuMDQ4MkM1Ljk1MzQ3IDExLjUyODggNi4wMjAwMiA4LjYxOTQ0IDYuMDY2MjEgNy4wNzY5NUM2LjA4MjgxIDYuNTE0NzcgNi41NTU0OCA2LjA0MzQ3IDcuMTE4MDQgNi4wMzA1NUM5LjA4ODYzIDUuOTg0NzMgMTMuMjYzOCA1LjkzNTc5IDEzLjY1MTggNi4zMjQyNUwyMS43MzY5IDEzLjYzOUMyMi4yNTYgMTQuMTU4NSAyMS43ODUxIDE1LjQ3MjQgMjEuMjYyIDE1Ljk5NDZMMTYuMjA5NSAyMS42MTA0Wk05Ljc3NTg1IDguMjY1QzkuMzM1NTEgNy44MjU2NiA4LjYyMzUxIDcuODI1NjYgOC4xODI4IDguMjY1QzcuNzQzNDYgOC43MDU3MSA3Ljc0MzQ2IDkuNDE3MzMgOC4xODI4IDkuODU2NjdDOC42MjM4MiAxMC4yOTY0IDkuMzM1ODIgMTAuMjk2NCA5Ljc3NTg1IDkuODU2NjdDMTAuMjE1NiA5LjQxNzMzIDEwLjIxNTYgOC43MDUzMyA5Ljc3NTg1IDguMjY1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-terminal: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiA+CiAgICA8cmVjdCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1iYWNrZ3JvdW5kLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIiBmaWxsPSIjMzMzMzMzIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUtaW52ZXJzZSIgZD0iTTUuMDU2NjQgOC43NjE3MkM1LjA1NjY0IDguNTk3NjYgNS4wMzEyNSA4LjQ1MzEyIDQuOTgwNDcgOC4zMjgxMkM0LjkzMzU5IDguMTk5MjIgNC44NTU0NyA4LjA4MjAzIDQuNzQ2MDkgNy45NzY1NkM0LjY0MDYyIDcuODcxMDkgNC41IDcuNzc1MzkgNC4zMjQyMiA3LjY4OTQ1QzQuMTUyMzQgNy41OTk2MSAzLjk0MzM2IDcuNTExNzIgMy42OTcyNyA3LjQyNTc4QzMuMzAyNzMgNy4yODUxNiAyLjk0MzM2IDcuMTM2NzIgMi42MTkxNCA2Ljk4MDQ3QzIuMjk0OTIgNi44MjQyMiAyLjAxNzU4IDYuNjQyNTggMS43ODcxMSA2LjQzNTU1QzEuNTYwNTUgNi4yMjg1MiAxLjM4NDc3IDUuOTg4MjggMS4yNTk3NyA1LjcxNDg0QzEuMTM0NzcgNS40Mzc1IDEuMDcyMjcgNS4xMDkzOCAxLjA3MjI3IDQuNzMwNDdDMS4wNzIyNyA0LjM5ODQ0IDEuMTI4OTEgNC4wOTU3IDEuMjQyMTkgMy44MjIyN0MxLjM1NTQ3IDMuNTQ0OTIgMS41MTU2MiAzLjMwNDY5IDEuNzIyNjYgMy4xMDE1NkMxLjkyOTY5IDIuODk4NDQgMi4xNzk2OSAyLjczNDM3IDIuNDcyNjYgMi42MDkzOEMyLjc2NTYyIDIuNDg0MzggMy4wOTE4IDIuNDA0MyAzLjQ1MTE3IDIuMzY5MTRWMS4xMDkzOEg0LjM4ODY3VjIuMzgwODZDNC43NDAyMyAyLjQyNzczIDUuMDU2NjQgMi41MjM0NCA1LjMzNzg5IDIuNjY3OTdDNS42MTkxNCAyLjgxMjUgNS44NTc0MiAzLjAwMTk1IDYuMDUyNzMgMy4yMzYzM0M2LjI1MTk1IDMuNDY2OCA2LjQwNDMgMy43NDAyMyA2LjUwOTc3IDQuMDU2NjRDNi42MTkxNCA0LjM2OTE0IDYuNjczODMgNC43MjA3IDYuNjczODMgNS4xMTEzM0g1LjA0NDkyQzUuMDQ0OTIgNC42Mzg2NyA0LjkzNzUgNC4yODEyNSA0LjcyMjY2IDQuMDM5MDZDNC41MDc4MSAzLjc5Mjk3IDQuMjE2OCAzLjY2OTkyIDMuODQ5NjEgMy42Njk5MkMzLjY1MDM5IDMuNjY5OTIgMy40NzY1NiAzLjY5NzI3IDMuMzI4MTIgMy43NTE5NUMzLjE4MzU5IDMuODAyNzMgMy4wNjQ0NSAzLjg3Njk1IDIuOTcwNyAzLjk3NDYxQzIuODc2OTUgNC4wNjgzNiAyLjgwNjY0IDQuMTc5NjkgMi43NTk3NyA0LjMwODU5QzIuNzE2OCA0LjQzNzUgMi42OTUzMSA0LjU3ODEyIDIuNjk1MzEgNC43MzA0N0MyLjY5NTMxIDQuODgyODEgMi43MTY4IDUuMDE5NTMgMi43NTk3NyA1LjE0MDYyQzIuODA2NjQgNS4yNTc4MSAyLjg4MjgxIDUuMzY3MTkgMi45ODgyOCA1LjQ2ODc1QzMuMDk3NjYgNS41NzAzMSAzLjI0MDIzIDUuNjY3OTcgMy40MTYwMiA1Ljc2MTcyQzMuNTkxOCA1Ljg1MTU2IDMuODEwNTUgNS45NDMzNiA0LjA3MjI3IDYuMDM3MTFDNC40NjY4IDYuMTg1NTUgNC44MjQyMiA2LjMzOTg0IDUuMTQ0NTMgNi41QzUuNDY0ODQgNi42NTYyNSA1LjczODI4IDYuODM5ODQgNS45NjQ4NCA3LjA1MDc4QzYuMTk1MzEgNy4yNTc4MSA2LjM3MTA5IDcuNSA2LjQ5MjE5IDcuNzc3MzRDNi42MTcxOSA4LjA1MDc4IDYuNjc5NjkgOC4zNzUgNi42Nzk2OSA4Ljc1QzYuNjc5NjkgOS4wOTM3NSA2LjYyMzA1IDkuNDA0MyA2LjUwOTc3IDkuNjgxNjRDNi4zOTY0OCA5Ljk1NTA4IDYuMjM0MzggMTAuMTkxNCA2LjAyMzQ0IDEwLjM5MDZDNS44MTI1IDEwLjU4OTggNS41NTg1OSAxMC43NSA1LjI2MTcyIDEwLjg3MTFDNC45NjQ4NCAxMC45ODgzIDQuNjMyODEgMTEuMDY0NSA0LjI2NTYyIDExLjA5OTZWMTIuMjQ4SDMuMzMzOThWMTEuMDk5NkMzLjAwMTk1IDExLjA2ODQgMi42Nzk2OSAxMC45OTYxIDIuMzY3MTkgMTAuODgyOEMyLjA1NDY5IDEwLjc2NTYgMS43NzczNCAxMC41OTc3IDEuNTM1MTYgMTAuMzc4OUMxLjI5Njg4IDEwLjE2MDIgMS4xMDU0NyA5Ljg4NDc3IDAuOTYwOTM4IDkuNTUyNzNDMC44MTY0MDYgOS4yMTY4IDAuNzQ0MTQxIDguODE0NDUgMC43NDQxNDEgOC4zNDU3SDIuMzc4OTFDMi4zNzg5MSA4LjYyNjk1IDIuNDE5OTIgOC44NjMyOCAyLjUwMTk1IDkuMDU0NjlDMi41ODM5OCA5LjI0MjE5IDIuNjg5NDUgOS4zOTI1OCAyLjgxODM2IDkuNTA1ODZDMi45NTExNyA5LjYxNTIzIDMuMTAxNTYgOS42OTMzNiAzLjI2OTUzIDkuNzQwMjNDMy40Mzc1IDkuNzg3MTEgMy42MDkzOCA5LjgxMDU1IDMuNzg1MTYgOS44MTA1NUM0LjIwMzEyIDkuODEwNTUgNC41MTk1MyA5LjcxMjg5IDQuNzM0MzggOS41MTc1OEM0Ljk0OTIyIDkuMzIyMjcgNS4wNTY2NCA5LjA3MDMxIDUuMDU2NjQgOC43NjE3MlpNMTMuNDE4IDEyLjI3MTVIOC4wNzQyMlYxMUgxMy40MThWMTIuMjcxNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuOTUyNjQgNikiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
  --jp-icon-text-editor: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtdGV4dC1lZGl0b3ItaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xNSAxNUgzdjJoMTJ2LTJ6bTAtOEgzdjJoMTJWN3pNMyAxM2gxOHYtMkgzdjJ6bTAgOGgxOHYtMkgzdjJ6TTMgM3YyaDE4VjNIM3oiLz4KPC9zdmc+Cg==);
  --jp-icon-toc: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik03LDVIMjFWN0g3VjVNNywxM1YxMUgyMVYxM0g3TTQsNC41QTEuNSwxLjUgMCAwLDEgNS41LDZBMS41LDEuNSAwIDAsMSA0LDcuNUExLjUsMS41IDAgMCwxIDIuNSw2QTEuNSwxLjUgMCAwLDEgNCw0LjVNNCwxMC41QTEuNSwxLjUgMCAwLDEgNS41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMy41QTEuNSwxLjUgMCAwLDEgMi41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMC41TTcsMTlWMTdIMjFWMTlIN000LDE2LjVBMS41LDEuNSAwIDAsMSA1LjUsMThBMS41LDEuNSAwIDAsMSA0LDE5LjVBMS41LDEuNSAwIDAsMSAyLjUsMThBMS41LDEuNSAwIDAsMSA0LDE2LjVaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tree-view: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMiAxMVYzaC03djNIOVYzSDJ2OGg3VjhoMnYxMGg0djNoN3YtOGgtN3YzaC0yVjhoMnYzeiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMiAxNy4xODQ0IDIuOTY5NjggMTQuMzAzMiAxLjg2MDk0IDExLjQ0MDlaIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiMzMzMzMzMiIHN0cm9rZT0iIzMzMzMzMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCA5Ljg2NzE5KSIgZD0iTTIuODYwMTUgNC44NjUzNUwwLjcyNjU0OSAyLjk5OTU5TDAgMy42MzA0NUwyLjg2MDE1IDYuMTMxNTdMOCAwLjYzMDg3Mkw3LjI3ODU3IDBMMi44NjAxNSA0Ljg2NTM1WiIvPgo8L3N2Zz4K);
  --jp-icon-undo: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjUgOGMtMi42NSAwLTUuMDUuOTktNi45IDIuNkwyIDd2OWg5bC0zLjYyLTMuNjJjMS4zOS0xLjE2IDMuMTYtMS44OCA1LjEyLTEuODggMy41NCAwIDYuNTUgMi4zMSA3LjYgNS41bDIuMzctLjc4QzIxLjA4IDExLjAzIDE3LjE1IDggMTIuNSA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-user: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE2IDdhNCA0IDAgMTEtOCAwIDQgNCAwIDAxOCAwek0xMiAxNGE3IDcgMCAwMC03IDdoMTRhNyA3IDAgMDAtNy03eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-users: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM2IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogPGcgY2xhc3M9ImpwLWljb24zIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjczMjcgMCAwIDEuNzMyNyAtMy42MjgyIC4wOTk1NzcpIiBmaWxsPSIjNjE2MTYxIj4KICA8cGF0aCB0cmFuc2Zvcm09Im1hdHJpeCgxLjUsMCwwLDEuNSwwLC02KSIgZD0ibTEyLjE4NiA3LjUwOThjLTEuMDUzNSAwLTEuOTc1NyAwLjU2NjUtMi40Nzg1IDEuNDEwMiAwLjc1MDYxIDAuMzEyNzcgMS4zOTc0IDAuODI2NDggMS44NzMgMS40NzI3aDMuNDg2M2MwLTEuNTkyLTEuMjg4OS0yLjg4MjgtMi44ODA5LTIuODgyOHoiLz4KICA8cGF0aCBkPSJtMjAuNDY1IDIuMzg5NWEyLjE4ODUgMi4xODg1IDAgMCAxLTIuMTg4NCAyLjE4ODUgMi4xODg1IDIuMTg4NSAwIDAgMS0yLjE4ODUtMi4xODg1IDIuMTg4NSAyLjE4ODUgMCAwIDEgMi4xODg1LTIuMTg4NSAyLjE4ODUgMi4xODg1IDAgMCAxIDIuMTg4NCAyLjE4ODV6Ii8+CiAgPHBhdGggdHJhbnNmb3JtPSJtYXRyaXgoMS41LDAsMCwxLjUsMCwtNikiIGQ9Im0zLjU4OTggOC40MjE5Yy0xLjExMjYgMC0yLjAxMzcgMC45MDExMS0yLjAxMzcgMi4wMTM3aDIuODE0NWMwLjI2Nzk3LTAuMzczMDkgMC41OTA3LTAuNzA0MzUgMC45NTg5OC0wLjk3ODUyLTAuMzQ0MzMtMC42MTY4OC0xLjAwMzEtMS4wMzUyLTEuNzU5OC0xLjAzNTJ6Ii8+CiAgPHBhdGggZD0ibTYuOTE1NCA0LjYyM2ExLjUyOTQgMS41Mjk0IDAgMCAxLTEuNTI5NCAxLjUyOTQgMS41Mjk0IDEuNTI5NCAwIDAgMS0xLjUyOTQtMS41Mjk0IDEuNTI5NCAxLjUyOTQgMCAwIDEgMS41Mjk0LTEuNTI5NCAxLjUyOTQgMS41Mjk0IDAgMCAxIDEuNTI5NCAxLjUyOTR6Ii8+CiAgPHBhdGggZD0ibTYuMTM1IDEzLjUzNWMwLTMuMjM5MiAyLjYyNTktNS44NjUgNS44NjUtNS44NjUgMy4yMzkyIDAgNS44NjUgMi42MjU5IDUuODY1IDUuODY1eiIvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMy43Njg1IiByPSIyLjk2ODUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-vega: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbjEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjEyMTIxIj4KICAgIDxwYXRoIGQ9Ik0xMC42IDUuNGwyLjItMy4ySDIuMnY3LjNsNC02LjZ6Ii8+CiAgICA8cGF0aCBkPSJNMTUuOCAyLjJsLTQuNCA2LjZMNyA2LjNsLTQuOCA4djUuNWgxNy42VjIuMmgtNHptLTcgMTUuNEg1LjV2LTQuNGgzLjN2NC40em00LjQgMEg5LjhWOS44aDMuNHY3Ljh6bTQuNCAwaC0zLjRWNi41aDMuNHYxMS4xeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-word: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KIDxnIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzQxNDE0MSI+CiAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiA8L2c+CiA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNDMgLjA0MDEpIiBmaWxsPSIjZmZmIj4KICA8cGF0aCBkPSJtNC4xNCA4Ljc2cTAuMDY4Mi0xLjg5IDIuNDItMS44OSAxLjE2IDAgMS42OCAwLjQyIDAuNTY3IDAuNDEgMC41NjcgMS4xNnYzLjQ3cTAgMC40NjIgMC41MTQgMC40NjIgMC4xMDMgMCAwLjItMC4wMjMxdjAuNzE0cS0wLjM5OSAwLjEwMy0wLjY1MSAwLjEwMy0wLjQ1MiAwLTAuNjkzLTAuMjItMC4yMzEtMC4yLTAuMjg0LTAuNjYyLTAuOTU2IDAuODcyLTIgMC44NzItMC45MDMgMC0xLjQ3LTAuNDcyLTAuNTI1LTAuNDcyLTAuNTI1LTEuMjYgMC0wLjI2MiAwLjA0NTItMC40NzIgMC4wNTY3LTAuMjIgMC4xMTYtMC4zNzggMC4wNjgyLTAuMTY4IDAuMjMxLTAuMzA0IDAuMTU4LTAuMTQ3IDAuMjYyLTAuMjQyIDAuMTE2LTAuMDkxNCAwLjM2OC0wLjE2OCAwLjI2Mi0wLjA5MTQgMC4zOTktMC4xMjYgMC4xMzYtMC4wNDUyIDAuNDcyLTAuMTAzIDAuMzM2LTAuMDU3OCAwLjUwNC0wLjA3OTggMC4xNTgtMC4wMjMxIDAuNTY3LTAuMDc5OCAwLjU1Ni0wLjA2ODIgMC43NzctMC4yMjEgMC4yMi0wLjE1MiAwLjIyLTAuNDQxdi0wLjI1MnEwLTAuNDMtMC4zNTctMC42NjItMC4zMzYtMC4yMzEtMC45NzYtMC4yMzEtMC42NjIgMC0wLjk5OCAwLjI2Mi0wLjMzNiAwLjI1Mi0wLjM5OSAwLjc5OHptMS44OSAzLjY4cTAuNzg4IDAgMS4yNi0wLjQxIDAuNTA0LTAuNDIgMC41MDQtMC45MDN2LTEuMDVxLTAuMjg0IDAuMTM2LTAuODYxIDAuMjMxLTAuNTY3IDAuMDkxNC0wLjk4NyAwLjE1OC0wLjQyIDAuMDY4Mi0wLjc2NiAwLjMyNi0wLjMzNiAwLjI1Mi0wLjMzNiAwLjcwNHQwLjMwNCAwLjcwNCAwLjg2MSAwLjI1MnoiIHN0cm9rZS13aWR0aD0iMS4wNSIvPgogIDxwYXRoIGQ9Im0xMCA0LjU2aDAuOTQ1djMuMTVxMC42NTEtMC45NzYgMS44OS0wLjk3NiAxLjE2IDAgMS44OSAwLjg0IDAuNjgyIDAuODQgMC42ODIgMi4zMSAwIDEuNDctMC43MDQgMi40Mi0wLjcwNCAwLjg4Mi0xLjg5IDAuODgyLTEuMjYgMC0xLjg5LTEuMDJ2MC43NjZoLTAuODV6bTIuNjIgMy4wNHEtMC43NDYgMC0xLjE2IDAuNjQtMC40NTIgMC42My0wLjQ1MiAxLjY4IDAgMS4wNSAwLjQ1MiAxLjY4dDEuMTYgMC42M3EwLjc3NyAwIDEuMjYtMC42MyAwLjQ5NC0wLjY0IDAuNDk0LTEuNjggMC0xLjA1LTAuNDcyLTEuNjgtMC40NjItMC42NC0xLjI2LTAuNjR6IiBzdHJva2Utd2lkdGg9IjEuMDUiLz4KICA8cGF0aCBkPSJtMi43MyAxNS44IDEzLjYgMC4wMDgxYzAuMDA2OSAwIDAtMi42IDAtMi42IDAtMC4wMDc4LTEuMTUgMC0xLjE1IDAtMC4wMDY5IDAtMC4wMDgzIDEuNS0wLjAwODMgMS41LTJlLTMgLTAuMDAxNC0xMS4zLTAuMDAxNC0xMS4zLTAuMDAxNGwtMC4wMDU5Mi0xLjVjMC0wLjAwNzgtMS4xNyAwLjAwMTMtMS4xNyAwLjAwMTN6IiBzdHJva2Utd2lkdGg9Ii45NzUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-yaml: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1jb250cmFzdDIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjRDgxQjYwIj4KICAgIDxwYXRoIGQ9Ik03LjIgMTguNnYtNS40TDMgNS42aDMuM2wxLjQgMy4xYy4zLjkuNiAxLjYgMSAyLjUuMy0uOC42LTEuNiAxLTIuNWwxLjQtMy4xaDMuNGwtNC40IDcuNnY1LjVsLTIuOS0uMXoiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxNi41IiByPSIyLjEiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxMSIgcj0iMi4xIi8+CiAgPC9nPgo8L3N2Zz4K);
}

/* Icon CSS class declarations */

.jp-AddAboveIcon {
  background-image: var(--jp-icon-add-above);
}

.jp-AddBelowIcon {
  background-image: var(--jp-icon-add-below);
}

.jp-AddIcon {
  background-image: var(--jp-icon-add);
}

.jp-BellIcon {
  background-image: var(--jp-icon-bell);
}

.jp-BugDotIcon {
  background-image: var(--jp-icon-bug-dot);
}

.jp-BugIcon {
  background-image: var(--jp-icon-bug);
}

.jp-BuildIcon {
  background-image: var(--jp-icon-build);
}

.jp-CaretDownEmptyIcon {
  background-image: var(--jp-icon-caret-down-empty);
}

.jp-CaretDownEmptyThinIcon {
  background-image: var(--jp-icon-caret-down-empty-thin);
}

.jp-CaretDownIcon {
  background-image: var(--jp-icon-caret-down);
}

.jp-CaretLeftIcon {
  background-image: var(--jp-icon-caret-left);
}

.jp-CaretRightIcon {
  background-image: var(--jp-icon-caret-right);
}

.jp-CaretUpEmptyThinIcon {
  background-image: var(--jp-icon-caret-up-empty-thin);
}

.jp-CaretUpIcon {
  background-image: var(--jp-icon-caret-up);
}

.jp-CaseSensitiveIcon {
  background-image: var(--jp-icon-case-sensitive);
}

.jp-CheckIcon {
  background-image: var(--jp-icon-check);
}

.jp-CircleEmptyIcon {
  background-image: var(--jp-icon-circle-empty);
}

.jp-CircleIcon {
  background-image: var(--jp-icon-circle);
}

.jp-ClearIcon {
  background-image: var(--jp-icon-clear);
}

.jp-CloseIcon {
  background-image: var(--jp-icon-close);
}

.jp-CodeCheckIcon {
  background-image: var(--jp-icon-code-check);
}

.jp-CodeIcon {
  background-image: var(--jp-icon-code);
}

.jp-CollapseAllIcon {
  background-image: var(--jp-icon-collapse-all);
}

.jp-ConsoleIcon {
  background-image: var(--jp-icon-console);
}

.jp-CopyIcon {
  background-image: var(--jp-icon-copy);
}

.jp-CopyrightIcon {
  background-image: var(--jp-icon-copyright);
}

.jp-CutIcon {
  background-image: var(--jp-icon-cut);
}

.jp-DeleteIcon {
  background-image: var(--jp-icon-delete);
}

.jp-DownloadIcon {
  background-image: var(--jp-icon-download);
}

.jp-DuplicateIcon {
  background-image: var(--jp-icon-duplicate);
}

.jp-EditIcon {
  background-image: var(--jp-icon-edit);
}

.jp-EllipsesIcon {
  background-image: var(--jp-icon-ellipses);
}

.jp-ErrorIcon {
  background-image: var(--jp-icon-error);
}

.jp-ExpandAllIcon {
  background-image: var(--jp-icon-expand-all);
}

.jp-ExtensionIcon {
  background-image: var(--jp-icon-extension);
}

.jp-FastForwardIcon {
  background-image: var(--jp-icon-fast-forward);
}

.jp-FileIcon {
  background-image: var(--jp-icon-file);
}

.jp-FileUploadIcon {
  background-image: var(--jp-icon-file-upload);
}

.jp-FilterDotIcon {
  background-image: var(--jp-icon-filter-dot);
}

.jp-FilterIcon {
  background-image: var(--jp-icon-filter);
}

.jp-FilterListIcon {
  background-image: var(--jp-icon-filter-list);
}

.jp-FolderFavoriteIcon {
  background-image: var(--jp-icon-folder-favorite);
}

.jp-FolderIcon {
  background-image: var(--jp-icon-folder);
}

.jp-HomeIcon {
  background-image: var(--jp-icon-home);
}

.jp-Html5Icon {
  background-image: var(--jp-icon-html5);
}

.jp-ImageIcon {
  background-image: var(--jp-icon-image);
}

.jp-InfoIcon {
  background-image: var(--jp-icon-info);
}

.jp-InspectorIcon {
  background-image: var(--jp-icon-inspector);
}

.jp-JsonIcon {
  background-image: var(--jp-icon-json);
}

.jp-JuliaIcon {
  background-image: var(--jp-icon-julia);
}

.jp-JupyterFaviconIcon {
  background-image: var(--jp-icon-jupyter-favicon);
}

.jp-JupyterIcon {
  background-image: var(--jp-icon-jupyter);
}

.jp-JupyterlabWordmarkIcon {
  background-image: var(--jp-icon-jupyterlab-wordmark);
}

.jp-KernelIcon {
  background-image: var(--jp-icon-kernel);
}

.jp-KeyboardIcon {
  background-image: var(--jp-icon-keyboard);
}

.jp-LaunchIcon {
  background-image: var(--jp-icon-launch);
}

.jp-LauncherIcon {
  background-image: var(--jp-icon-launcher);
}

.jp-LineFormIcon {
  background-image: var(--jp-icon-line-form);
}

.jp-LinkIcon {
  background-image: var(--jp-icon-link);
}

.jp-ListIcon {
  background-image: var(--jp-icon-list);
}

.jp-MarkdownIcon {
  background-image: var(--jp-icon-markdown);
}

.jp-MoveDownIcon {
  background-image: var(--jp-icon-move-down);
}

.jp-MoveUpIcon {
  background-image: var(--jp-icon-move-up);
}

.jp-NewFolderIcon {
  background-image: var(--jp-icon-new-folder);
}

.jp-NotTrustedIcon {
  background-image: var(--jp-icon-not-trusted);
}

.jp-NotebookIcon {
  background-image: var(--jp-icon-notebook);
}

.jp-NumberingIcon {
  background-image: var(--jp-icon-numbering);
}

.jp-OfflineBoltIcon {
  background-image: var(--jp-icon-offline-bolt);
}

.jp-PaletteIcon {
  background-image: var(--jp-icon-palette);
}

.jp-PasteIcon {
  background-image: var(--jp-icon-paste);
}

.jp-PdfIcon {
  background-image: var(--jp-icon-pdf);
}

.jp-PythonIcon {
  background-image: var(--jp-icon-python);
}

.jp-RKernelIcon {
  background-image: var(--jp-icon-r-kernel);
}

.jp-ReactIcon {
  background-image: var(--jp-icon-react);
}

.jp-RedoIcon {
  background-image: var(--jp-icon-redo);
}

.jp-RefreshIcon {
  background-image: var(--jp-icon-refresh);
}

.jp-RegexIcon {
  background-image: var(--jp-icon-regex);
}

.jp-RunIcon {
  background-image: var(--jp-icon-run);
}

.jp-RunningIcon {
  background-image: var(--jp-icon-running);
}

.jp-SaveIcon {
  background-image: var(--jp-icon-save);
}

.jp-SearchIcon {
  background-image: var(--jp-icon-search);
}

.jp-SettingsIcon {
  background-image: var(--jp-icon-settings);
}

.jp-ShareIcon {
  background-image: var(--jp-icon-share);
}

.jp-SpreadsheetIcon {
  background-image: var(--jp-icon-spreadsheet);
}

.jp-StopIcon {
  background-image: var(--jp-icon-stop);
}

.jp-TabIcon {
  background-image: var(--jp-icon-tab);
}

.jp-TableRowsIcon {
  background-image: var(--jp-icon-table-rows);
}

.jp-TagIcon {
  background-image: var(--jp-icon-tag);
}

.jp-TerminalIcon {
  background-image: var(--jp-icon-terminal);
}

.jp-TextEditorIcon {
  background-image: var(--jp-icon-text-editor);
}

.jp-TocIcon {
  background-image: var(--jp-icon-toc);
}

.jp-TreeViewIcon {
  background-image: var(--jp-icon-tree-view);
}

.jp-TrustedIcon {
  background-image: var(--jp-icon-trusted);
}

.jp-UndoIcon {
  background-image: var(--jp-icon-undo);
}

.jp-UserIcon {
  background-image: var(--jp-icon-user);
}

.jp-UsersIcon {
  background-image: var(--jp-icon-users);
}

.jp-VegaIcon {
  background-image: var(--jp-icon-vega);
}

.jp-WordIcon {
  background-image: var(--jp-icon-word);
}

.jp-YamlIcon {
  background-image: var(--jp-icon-yaml);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

.jp-Icon,
.jp-MaterialIcon {
  background-position: center;
  background-repeat: no-repeat;
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-cover {
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
}

/**
 * (DEPRECATED) Support for specific CSS icon sizes
 */

.jp-Icon-16 {
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-18 {
  background-size: 18px;
  min-width: 18px;
  min-height: 18px;
}

.jp-Icon-20 {
  background-size: 20px;
  min-width: 20px;
  min-height: 20px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.lm-TabBar .lm-TabBar-addButton {
  align-items: center;
  display: flex;
  padding: 4px;
  padding-bottom: 5px;
  margin-right: 1px;
  background-color: var(--jp-layout-color2);
}

.lm-TabBar .lm-TabBar-addButton:hover {
  background-color: var(--jp-layout-color1);
}

.lm-DockPanel-tabBar .lm-TabBar-tab {
  width: var(--jp-private-horizontal-tab-width);
}

.lm-DockPanel-tabBar .lm-TabBar-content {
  flex: unset;
}

.lm-DockPanel-tabBar[data-orientation='horizontal'] {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for icons as inline SVG HTMLElements
 */

/* recolor the primary elements of an icon */
.jp-icon0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-accent0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-accent1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-accent2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-accent3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-accent4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-accent0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-accent1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-accent2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-accent3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-accent4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-none[fill] {
  fill: none;
}

.jp-icon-none[stroke] {
  stroke: none;
}

/* brand icon colors. Same for light and dark */
.jp-icon-brand0[fill] {
  fill: var(--jp-brand-color0);
}

.jp-icon-brand1[fill] {
  fill: var(--jp-brand-color1);
}

.jp-icon-brand2[fill] {
  fill: var(--jp-brand-color2);
}

.jp-icon-brand3[fill] {
  fill: var(--jp-brand-color3);
}

.jp-icon-brand4[fill] {
  fill: var(--jp-brand-color4);
}

.jp-icon-brand0[stroke] {
  stroke: var(--jp-brand-color0);
}

.jp-icon-brand1[stroke] {
  stroke: var(--jp-brand-color1);
}

.jp-icon-brand2[stroke] {
  stroke: var(--jp-brand-color2);
}

.jp-icon-brand3[stroke] {
  stroke: var(--jp-brand-color3);
}

.jp-icon-brand4[stroke] {
  stroke: var(--jp-brand-color4);
}

/* warn icon colors. Same for light and dark */
.jp-icon-warn0[fill] {
  fill: var(--jp-warn-color0);
}

.jp-icon-warn1[fill] {
  fill: var(--jp-warn-color1);
}

.jp-icon-warn2[fill] {
  fill: var(--jp-warn-color2);
}

.jp-icon-warn3[fill] {
  fill: var(--jp-warn-color3);
}

.jp-icon-warn0[stroke] {
  stroke: var(--jp-warn-color0);
}

.jp-icon-warn1[stroke] {
  stroke: var(--jp-warn-color1);
}

.jp-icon-warn2[stroke] {
  stroke: var(--jp-warn-color2);
}

.jp-icon-warn3[stroke] {
  stroke: var(--jp-warn-color3);
}

/* icon colors that contrast well with each other and most backgrounds */
.jp-icon-contrast0[fill] {
  fill: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[fill] {
  fill: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[fill] {
  fill: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[fill] {
  fill: var(--jp-icon-contrast-color3);
}

.jp-icon-contrast0[stroke] {
  stroke: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[stroke] {
  stroke: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[stroke] {
  stroke: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[stroke] {
  stroke: var(--jp-icon-contrast-color3);
}

.jp-icon-dot[fill] {
  fill: var(--jp-warn-color0);
}

.jp-jupyter-icon-color[fill] {
  fill: var(--jp-jupyter-icon-color, var(--jp-warn-color0));
}

.jp-notebook-icon-color[fill] {
  fill: var(--jp-notebook-icon-color, var(--jp-warn-color0));
}

.jp-json-icon-color[fill] {
  fill: var(--jp-json-icon-color, var(--jp-warn-color1));
}

.jp-console-icon-color[fill] {
  fill: var(--jp-console-icon-color, white);
}

.jp-console-icon-background-color[fill] {
  fill: var(--jp-console-icon-background-color, var(--jp-brand-color1));
}

.jp-terminal-icon-color[fill] {
  fill: var(--jp-terminal-icon-color, var(--jp-layout-color2));
}

.jp-terminal-icon-background-color[fill] {
  fill: var(
    --jp-terminal-icon-background-color,
    var(--jp-inverse-layout-color2)
  );
}

.jp-text-editor-icon-color[fill] {
  fill: var(--jp-text-editor-icon-color, var(--jp-inverse-layout-color3));
}

.jp-inspector-icon-color[fill] {
  fill: var(--jp-inspector-icon-color, var(--jp-inverse-layout-color3));
}

/* CSS for icons in selected filebrowser listing items */
.jp-DirListing-item.jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

.jp-DirListing-item.jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* stylelint-disable selector-max-class, selector-max-compound-selectors */

/**
* TODO: come up with non css-hack solution for showing the busy icon on top
*  of the close icon
* CSS for complex behavior of close icon of tabs in the main area tabbar
*/
.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon3[fill] {
  fill: none;
}

.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon-busy[fill] {
  fill: var(--jp-inverse-layout-color3);
}

/* stylelint-enable selector-max-class, selector-max-compound-selectors */

/* CSS for icons in status bar */
#jp-main-statusbar .jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

#jp-main-statusbar .jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* special handling for splash icon CSS. While the theme CSS reloads during
   splash, the splash icon can loose theming. To prevent that, we set a
   default for its color variable */
:root {
  --jp-warn-color0: var(--md-orange-700);
}

/* not sure what to do with this one, used in filebrowser listing */
.jp-DragIcon {
  margin-right: 4px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for alt colors for icons as inline SVG HTMLElements
 */

/* alt recolor the primary elements of an icon */
.jp-icon-alt .jp-icon0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-alt .jp-icon0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* alt recolor the accent elements of an icon */
.jp-icon-alt .jp-icon-accent0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-alt .jp-icon-accent0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-icon-hoverShow:not(:hover) .jp-icon-hoverShow-content {
  display: none !important;
}

/**
 * Support for hover colors for icons as inline SVG HTMLElements
 */

/**
 * regular colors
 */

/* recolor the primary elements of an icon */
.jp-icon-hover :hover .jp-icon0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-hover :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-hover :hover .jp-icon-none-hover[fill] {
  fill: none;
}

.jp-icon-hover :hover .jp-icon-none-hover[stroke] {
  stroke: none;
}

/**
 * inverse colors
 */

/* inverse recolor the primary elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* inverse recolor the accent elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-IFrame {
  width: 100%;
  height: 100%;
}

.jp-IFrame > iframe {
  border: none;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-IFrame {
  position: relative;
}

body.lm-mod-override-cursor .jp-IFrame::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-HoverBox {
  position: fixed;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FormGroup-content fieldset {
  border: none;
  padding: 0;
  min-width: 0;
  width: 100%;
}

/* stylelint-disable selector-max-type */

.jp-FormGroup-content fieldset .jp-inputFieldWrapper input,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper select,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper textarea {
  font-size: var(--jp-content-font-size2);
  border-color: var(--jp-input-border-color);
  border-style: solid;
  border-radius: var(--jp-border-radius);
  border-width: 1px;
  padding: 6px 8px;
  background: none;
  color: var(--jp-ui-font-color0);
  height: inherit;
}

.jp-FormGroup-content fieldset input[type='checkbox'] {
  position: relative;
  top: 2px;
  margin-left: 0;
}

.jp-FormGroup-content button.jp-mod-styled {
  cursor: pointer;
}

.jp-FormGroup-content .checkbox label {
  cursor: pointer;
  font-size: var(--jp-content-font-size1);
}

.jp-FormGroup-content .jp-root > fieldset > legend {
  display: none;
}

.jp-FormGroup-content .jp-root > fieldset > p {
  display: none;
}

/** copy of `input.jp-mod-styled:focus` style */
.jp-FormGroup-content fieldset input:focus,
.jp-FormGroup-content fieldset select:focus {
  -moz-outline-radius: unset;
  outline: var(--jp-border-width) solid var(--md-blue-500);
  outline-offset: -1px;
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-FormGroup-content fieldset input:hover:not(:focus),
.jp-FormGroup-content fieldset select:hover:not(:focus) {
  background-color: var(--jp-border-color2);
}

/* stylelint-enable selector-max-type */

.jp-FormGroup-content .checkbox .field-description {
  /* Disable default description field for checkbox:
   because other widgets do not have description fields,
   we add descriptions to each widget on the field level.
  */
  display: none;
}

.jp-FormGroup-content #root__description {
  display: none;
}

.jp-FormGroup-content .jp-modifiedIndicator {
  width: 5px;
  background-color: var(--jp-brand-color2);
  margin-top: 0;
  margin-left: calc(var(--jp-private-settingeditor-modifier-indent) * -1);
  flex-shrink: 0;
}

.jp-FormGroup-content .jp-modifiedIndicator.jp-errorIndicator {
  background-color: var(--jp-error-color0);
  margin-right: 0.5em;
}

/* RJSF ARRAY style */

.jp-arrayFieldWrapper legend {
  font-size: var(--jp-content-font-size2);
  color: var(--jp-ui-font-color0);
  flex-basis: 100%;
  padding: 4px 0;
  font-weight: var(--jp-content-heading-font-weight);
  border-bottom: 1px solid var(--jp-border-color2);
}

.jp-arrayFieldWrapper .field-description {
  padding: 4px 0;
  white-space: pre-wrap;
}

.jp-arrayFieldWrapper .array-item {
  width: 100%;
  border: 1px solid var(--jp-border-color2);
  border-radius: 4px;
  margin: 4px;
}

.jp-ArrayOperations {
  display: flex;
  margin-left: 8px;
}

.jp-ArrayOperationsButton {
  margin: 2px;
}

.jp-ArrayOperationsButton .jp-icon3[fill] {
  fill: var(--jp-ui-font-color0);
}

button.jp-ArrayOperationsButton.jp-mod-styled:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* RJSF form validation error */

.jp-FormGroup-content .validationErrors {
  color: var(--jp-error-color0);
}

/* Hide panel level error as duplicated the field level error */
.jp-FormGroup-content .panel.errors {
  display: none;
}

/* RJSF normal content (settings-editor) */

.jp-FormGroup-contentNormal {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-FormGroup-contentItem {
  margin-left: 7px;
  color: var(--jp-ui-font-color0);
}

.jp-FormGroup-contentNormal .jp-FormGroup-description {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-default {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-fieldLabel {
  font-size: var(--jp-content-font-size1);
  font-weight: normal;
  min-width: 120px;
}

.jp-FormGroup-contentNormal fieldset:not(:first-child) {
  margin-left: 7px;
}

.jp-FormGroup-contentNormal .field-array-of-string .array-item {
  /* Display `jp-ArrayOperations` buttons side-by-side with content except
    for small screens where flex-wrap will place them one below the other.
  */
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-objectFieldWrapper .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

/* RJSF compact content (metadata-form) */

.jp-FormGroup-content.jp-FormGroup-contentCompact {
  width: 100%;
}

.jp-FormGroup-contentCompact .form-group {
  display: flex;
  padding: 0.5em 0.2em 0.5em 0;
}

.jp-FormGroup-contentCompact
  .jp-FormGroup-compactTitle
  .jp-FormGroup-description {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color2);
}

.jp-FormGroup-contentCompact .jp-FormGroup-fieldLabel {
  padding-bottom: 0.3em;
}

.jp-FormGroup-contentCompact .jp-inputFieldWrapper .form-control {
  width: 100%;
  box-sizing: border-box;
}

.jp-FormGroup-contentCompact .jp-arrayFieldWrapper .jp-FormGroup-compactTitle {
  padding-bottom: 7px;
}

.jp-FormGroup-contentCompact
  .jp-objectFieldWrapper
  .jp-objectFieldWrapper
  .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

.jp-FormGroup-contentCompact ul.error-detail {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
  padding-inline-start: 1em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-SidePanel {
  display: flex;
  flex-direction: column;
  min-width: var(--jp-sidebar-min-width);
  overflow-y: auto;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);
  font-size: var(--jp-ui-font-size1);
}

.jp-SidePanel-header {
  flex: 0 0 auto;
  display: flex;
  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin: 0;
  padding: 2px;
  text-transform: uppercase;
}

.jp-SidePanel-toolbar {
  flex: 0 0 auto;
}

.jp-SidePanel-content {
  flex: 1 1 auto;
}

.jp-SidePanel-toolbar,
.jp-AccordionPanel-toolbar {
  height: var(--jp-private-toolbar-height);
}

.jp-SidePanel-toolbar.jp-Toolbar-micro {
  display: none;
}

.lm-AccordionPanel .jp-AccordionPanel-title {
  box-sizing: border-box;
  line-height: 25px;
  margin: 0;
  display: flex;
  align-items: center;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  font-size: var(--jp-ui-font-size0);
}

.jp-AccordionPanel-title {
  cursor: pointer;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  text-transform: uppercase;
}

.lm-AccordionPanel[data-orientation='horizontal'] > .jp-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleLabel {
  user-select: none;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleCollapser {
  transform: rotate(-90deg);
  margin: auto 0;
  height: 16px;
}

.jp-AccordionPanel-title.lm-mod-expanded .lm-AccordionPanel-titleCollapser {
  transform: rotate(0deg);
}

.lm-AccordionPanel .jp-AccordionPanel-toolbar {
  background: none;
  box-shadow: none;
  border: none;
  margin-left: auto;
}

.lm-AccordionPanel .lm-SplitPanel-handle:hover {
  background: var(--jp-layout-color3);
}

.jp-text-truncated {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Spinner {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-layout-color0);
  outline: none;
}

.jp-SpinnerContent {
  font-size: 10px;
  margin: 50px auto;
  text-indent: -9999em;
  width: 3em;
  height: 3em;
  border-radius: 50%;
  background: var(--jp-brand-color3);
  background: linear-gradient(
    to right,
    #f37626 10%,
    rgba(255, 255, 255, 0) 42%
  );
  position: relative;
  animation: load3 1s infinite linear, fadeIn 1s;
}

.jp-SpinnerContent::before {
  width: 50%;
  height: 50%;
  background: #f37626;
  border-radius: 100% 0 0;
  position: absolute;
  top: 0;
  left: 0;
  content: '';
}

.jp-SpinnerContent::after {
  background: var(--jp-layout-color0);
  width: 75%;
  height: 75%;
  border-radius: 50%;
  content: '';
  margin: auto;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

@keyframes fadeIn {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 1;
  }
}

@keyframes load3 {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

button.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: none;
  box-sizing: border-box;
  text-align: center;
  line-height: 32px;
  height: 32px;
  padding: 0 12px;
  letter-spacing: 0.8px;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input.jp-mod-styled {
  background: var(--jp-input-background);
  height: 28px;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color1);
  padding-left: 7px;
  padding-right: 7px;
  font-size: var(--jp-ui-font-size2);
  color: var(--jp-ui-font-color0);
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input[type='checkbox'].jp-mod-styled {
  appearance: checkbox;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
  height: auto;
}

input.jp-mod-styled:focus {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-select-wrapper {
  display: flex;
  position: relative;
  flex-direction: column;
  padding: 1px;
  background-color: var(--jp-layout-color1);
  box-sizing: border-box;
  margin-bottom: 12px;
}

.jp-select-wrapper:not(.multiple) {
  height: 28px;
}

.jp-select-wrapper.jp-mod-focused select.jp-mod-styled {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-input-active-background);
}

select.jp-mod-styled:hover {
  cursor: pointer;
  color: var(--jp-ui-font-color0);
  background-color: var(--jp-input-hover-background);
  box-shadow: inset 0 0 1px rgba(0, 0, 0, 0.5);
}

select.jp-mod-styled {
  flex: 1 1 auto;
  width: 100%;
  font-size: var(--jp-ui-font-size2);
  background: var(--jp-input-background);
  color: var(--jp-ui-font-color0);
  padding: 0 25px 0 8px;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

select.jp-mod-styled:not([multiple]) {
  height: 32px;
}

select.jp-mod-styled[multiple] {
  max-height: 200px;
  overflow-y: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-switch {
  display: flex;
  align-items: center;
  padding-left: 4px;
  padding-right: 4px;
  font-size: var(--jp-ui-font-size1);
  background-color: transparent;
  color: var(--jp-ui-font-color1);
  border: none;
  height: 20px;
}

.jp-switch:hover {
  background-color: var(--jp-layout-color2);
}

.jp-switch-label {
  margin-right: 5px;
  font-family: var(--jp-ui-font-family);
}

.jp-switch-track {
  cursor: pointer;
  background-color: var(--jp-switch-color, var(--jp-border-color1));
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 34px;
  height: 16px;
  width: 35px;
  position: relative;
}

.jp-switch-track::before {
  content: '';
  position: absolute;
  height: 10px;
  width: 10px;
  margin: 3px;
  left: 0;
  background-color: var(--jp-ui-inverse-font-color1);
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 50%;
}

.jp-switch[aria-checked='true'] .jp-switch-track {
  background-color: var(--jp-switch-true-position-color, var(--jp-warn-color0));
}

.jp-switch[aria-checked='true'] .jp-switch-track::before {
  /* track width (35) - margins (3 + 3) - thumb width (10) */
  left: 19px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toolbar-height: calc(
    28px + var(--jp-border-width)
  ); /* leave 28px for content */
}

.jp-Toolbar {
  color: var(--jp-ui-font-color1);
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: 2px;
  z-index: 8;
  overflow-x: hidden;
}

/* Toolbar items */

.jp-Toolbar > .jp-Toolbar-item.jp-Toolbar-spacer {
  flex-grow: 1;
  flex-shrink: 1;
}

.jp-Toolbar-item.jp-Toolbar-kernelStatus {
  display: inline-block;
  width: 32px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 16px;
}

.jp-Toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  display: flex;
  padding-left: 1px;
  padding-right: 1px;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-private-toolbar-height);
  height: 100%;
}

/* Toolbar buttons */

/* This is the div we use to wrap the react component into a Widget */
div.jp-ToolbarButton {
  color: transparent;
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0;
  margin: 0;
}

button.jp-ToolbarButtonComponent {
  background: var(--jp-layout-color1);
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0 6px;
  margin: 0;
  height: 24px;
  border-radius: var(--jp-border-radius);
  display: flex;
  align-items: center;
  text-align: center;
  font-size: 14px;
  min-width: unset;
  min-height: unset;
}

button.jp-ToolbarButtonComponent:disabled {
  opacity: 0.4;
}

button.jp-ToolbarButtonComponent > span {
  padding: 0;
  flex: 0 0 auto;
}

button.jp-ToolbarButtonComponent .jp-ToolbarButtonComponent-label {
  font-size: var(--jp-ui-font-size1);
  line-height: 100%;
  padding-left: 2px;
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar.jp-Toolbar-micro {
  padding: 0;
  min-height: 0;
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar {
  border: none;
  box-shadow: none;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-WindowedPanel-outer {
  position: relative;
  overflow-y: auto;
}

.jp-WindowedPanel-inner {
  position: relative;
}

.jp-WindowedPanel-window {
  position: absolute;
  left: 0;
  right: 0;
  overflow: visible;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* Sibling imports */

body {
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
}

/* Disable native link decoration styles everywhere outside of dialog boxes */
a {
  text-decoration: unset;
  color: unset;
}

a:hover {
  text-decoration: unset;
  color: unset;
}

/* Accessibility for links inside dialog box text */
.jp-Dialog-content a {
  text-decoration: revert;
  color: var(--jp-content-link-color);
}

.jp-Dialog-content a:hover {
  text-decoration: revert;
}

/* Styles for ui-components */
.jp-Button {
  color: var(--jp-ui-font-color2);
  border-radius: var(--jp-border-radius);
  padding: 0 12px;
  font-size: var(--jp-ui-font-size1);

  /* Copy from blueprint 3 */
  display: inline-flex;
  flex-direction: row;
  border: none;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  text-align: left;
  vertical-align: middle;
  min-height: 30px;
  min-width: 30px;
}

.jp-Button:disabled {
  cursor: not-allowed;
}

.jp-Button:empty {
  padding: 0 !important;
}

.jp-Button.jp-mod-small {
  min-height: 24px;
  min-width: 24px;
  font-size: 12px;
  padding: 0 7px;
}

/* Use our own theme for hover styles */
.jp-Button.jp-mod-minimal:hover {
  background-color: var(--jp-layout-color2);
}

.jp-Button.jp-mod-minimal {
  background: none;
}

.jp-InputGroup {
  display: block;
  position: relative;
}

.jp-InputGroup input {
  box-sizing: border-box;
  border: none;
  border-radius: 0;
  background-color: transparent;
  color: var(--jp-ui-font-color0);
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
  padding-bottom: 0;
  padding-top: 0;
  padding-left: 10px;
  padding-right: 28px;
  position: relative;
  width: 100%;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  font-size: 14px;
  font-weight: 400;
  height: 30px;
  line-height: 30px;
  outline: none;
  vertical-align: middle;
}

.jp-InputGroup input:focus {
  box-shadow: inset 0 0 0 var(--jp-border-width)
      var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-InputGroup input:disabled {
  cursor: not-allowed;
  resize: block;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input:disabled ~ span {
  cursor: not-allowed;
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input::placeholder,
input::placeholder {
  color: var(--jp-ui-font-color2);
}

.jp-InputGroupAction {
  position: absolute;
  bottom: 1px;
  right: 0;
  padding: 6px;
}

.jp-HTMLSelect.jp-DefaultStyle select {
  background-color: initial;
  border: none;
  border-radius: 0;
  box-shadow: none;
  color: var(--jp-ui-font-color0);
  display: block;
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  height: 24px;
  line-height: 14px;
  padding: 0 25px 0 10px;
  text-align: left;
  -moz-appearance: none;
  -webkit-appearance: none;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
  cursor: not-allowed;
  resize: block;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled ~ span {
  cursor: not-allowed;
}

/* Use our own theme for hover and option styles */
/* stylelint-disable-next-line selector-max-type */
.jp-HTMLSelect.jp-DefaultStyle select:hover,
.jp-HTMLSelect.jp-DefaultStyle select > option {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color0);
}

select {
  box-sizing: border-box;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-StatusBar-Widget {
  display: flex;
  align-items: center;
  background: var(--jp-layout-color2);
  min-height: var(--jp-statusbar-height);
  justify-content: space-between;
  padding: 0 10px;
}

.jp-StatusBar-Left {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-StatusBar-Middle {
  display: flex;
  align-items: center;
}

.jp-StatusBar-Right {
  display: flex;
  align-items: center;
  flex-direction: row-reverse;
}

.jp-StatusBar-Item {
  max-height: var(--jp-statusbar-height);
  margin: 0 2px;
  height: var(--jp-statusbar-height);
  white-space: nowrap;
  text-overflow: ellipsis;
  color: var(--jp-ui-font-color1);
  padding: 0 6px;
}

.jp-mod-highlighted:hover {
  background-color: var(--jp-layout-color3);
}

.jp-mod-clicked {
  background-color: var(--jp-brand-color1);
}

.jp-mod-clicked:hover {
  background-color: var(--jp-brand-color0);
}

.jp-mod-clicked .jp-StatusBar-TextItem {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-StatusBar-HoverItem {
  box-shadow: '0px 4px 4px rgba(0, 0, 0, 0.25)';
}

.jp-StatusBar-TextItem {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  line-height: 24px;
  color: var(--jp-ui-font-color1);
}

.jp-StatusBar-GroupItem {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-Statusbar-ProgressCircle svg {
  display: block;
  margin: 0 auto;
  width: 16px;
  height: 24px;
  align-self: normal;
}

.jp-Statusbar-ProgressCircle path {
  fill: var(--jp-inverse-layout-color3);
}

.jp-Statusbar-ProgressBar-progress-bar {
  height: 10px;
  width: 100px;
  border: solid 0.25px var(--jp-brand-color2);
  border-radius: 3px;
  overflow: hidden;
  align-self: center;
}

.jp-Statusbar-ProgressBar-progress-bar > div {
  background-color: var(--jp-brand-color2);
  background-image: linear-gradient(
    -45deg,
    rgba(255, 255, 255, 0.2) 25%,
    transparent 25%,
    transparent 50%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.2) 75%,
    transparent 75%,
    transparent
  );
  background-size: 40px 40px;
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 14px;
  color: #fff;
  text-align: center;
  animation: jp-Statusbar-ExecutionTime-progress-bar 2s linear infinite;
}

.jp-Statusbar-ProgressBar-progress-bar p {
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  line-height: 10px;
  width: 100px;
}

@keyframes jp-Statusbar-ExecutionTime-progress-bar {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 40px 40px;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-commandpalette-search-height: 28px;
}

/*-----------------------------------------------------------------------------
| Overall styles
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  padding-bottom: 0;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Modal variant
|----------------------------------------------------------------------------*/

.jp-ModalCommandPalette {
  position: absolute;
  z-index: 10000;
  top: 38px;
  left: 30%;
  margin: 0;
  padding: 4px;
  width: 40%;
  box-shadow: var(--jp-elevation-z4);
  border-radius: 4px;
  background: var(--jp-layout-color0);
}

.jp-ModalCommandPalette .lm-CommandPalette {
  max-height: 40vh;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-close-icon::after {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-header {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item {
  margin-left: 4px;
  margin-right: 4px;
}

.jp-ModalCommandPalette
  .lm-CommandPalette
  .lm-CommandPalette-item.lm-mod-disabled {
  display: none;
}

/*-----------------------------------------------------------------------------
| Search
|----------------------------------------------------------------------------*/

.lm-CommandPalette-search {
  padding: 4px;
  background-color: var(--jp-layout-color1);
  z-index: 2;
}

.lm-CommandPalette-wrapper {
  overflow: overlay;
  padding: 0 9px;
  background-color: var(--jp-input-active-background);
  height: 30px;
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
}

.lm-CommandPalette.lm-mod-focused .lm-CommandPalette-wrapper {
  box-shadow: inset 0 0 0 1px var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-SearchIconGroup {
  color: white;
  background-color: var(--jp-brand-color1);
  position: absolute;
  top: 4px;
  right: 4px;
  padding: 5px 5px 1px;
}

.jp-SearchIconGroup svg {
  height: 20px;
  width: 20px;
}

.jp-SearchIconGroup .jp-icon3[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-input {
  background: transparent;
  width: calc(100% - 18px);
  float: left;
  border: none;
  outline: none;
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  line-height: var(--jp-private-commandpalette-search-height);
}

.lm-CommandPalette-input::-webkit-input-placeholder,
.lm-CommandPalette-input::-moz-placeholder,
.lm-CommandPalette-input:-ms-input-placeholder {
  color: var(--jp-ui-font-color2);
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Results
|----------------------------------------------------------------------------*/

.lm-CommandPalette-header:first-child {
  margin-top: 0;
}

.lm-CommandPalette-header {
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin-top: 8px;
  padding: 8px 0 8px 12px;
  text-transform: uppercase;
}

.lm-CommandPalette-header.lm-mod-active {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-header > mark {
  background-color: transparent;
  font-weight: bold;
  color: var(--jp-ui-font-color1);
}

.lm-CommandPalette-item {
  padding: 4px 12px 4px 4px;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  font-weight: 400;
  display: flex;
}

.lm-CommandPalette-item.lm-mod-disabled {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item.lm-mod-active {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item.lm-mod-active .lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-inverse-font-color0);
}

.lm-CommandPalette-item.lm-mod-active .jp-icon-selectable[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-item.lm-mod-active:hover:not(.lm-mod-disabled) {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item:hover:not(.lm-mod-active):not(.lm-mod-disabled) {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-itemContent {
  overflow: hidden;
}

.lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.lm-CommandPalette-item.lm-mod-disabled mark {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item .lm-CommandPalette-itemIcon {
  margin: 0 4px 0 0;
  position: relative;
  width: 16px;
  top: 2px;
  flex: 0 0 auto;
}

.lm-CommandPalette-item.lm-mod-disabled .lm-CommandPalette-itemIcon {
  opacity: 0.6;
}

.lm-CommandPalette-item .lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemCaption {
  display: none;
}

.lm-CommandPalette-content {
  background-color: var(--jp-layout-color1);
}

.lm-CommandPalette-content:empty::after {
  content: 'No results';
  margin: auto;
  margin-top: 20px;
  width: 100px;
  display: block;
  font-size: var(--jp-ui-font-size2);
  font-family: var(--jp-ui-font-family);
  font-weight: lighter;
}

.lm-CommandPalette-emptyMessage {
  text-align: center;
  margin-top: 24px;
  line-height: 1.32;
  padding: 0 8px;
  color: var(--jp-content-font-color3);
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Dialog {
  position: absolute;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-dialog-background);
}

.jp-Dialog-content {
  display: flex;
  flex-direction: column;
  margin-left: auto;
  margin-right: auto;
  background: var(--jp-layout-color1);
  padding: 24px 24px 12px;
  min-width: 300px;
  min-height: 150px;
  max-width: 1000px;
  max-height: 500px;
  box-sizing: border-box;
  box-shadow: var(--jp-elevation-z20);
  word-wrap: break-word;
  border-radius: var(--jp-border-radius);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color1);
  resize: both;
}

.jp-Dialog-content.jp-Dialog-content-small {
  max-width: 500px;
}

.jp-Dialog-button {
  overflow: visible;
}

button.jp-Dialog-button:focus {
  outline: 1px solid var(--jp-brand-color1);
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button:focus::-moz-focus-inner {
  border: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus {
  outline: 1px solid var(--jp-accept-color-normal, var(--jp-brand-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus {
  outline: 1px solid var(--jp-warn-color-normal, var(--jp-error-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline: 1px solid var(--jp-reject-color-normal, var(--md-grey-600));
}

button.jp-Dialog-close-button {
  padding: 0;
  height: 100%;
  min-width: unset;
  min-height: unset;
}

.jp-Dialog-header {
  display: flex;
  justify-content: space-between;
  flex: 0 0 auto;
  padding-bottom: 12px;
  font-size: var(--jp-ui-font-size3);
  font-weight: 400;
  color: var(--jp-ui-font-color1);
}

.jp-Dialog-body {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  font-size: var(--jp-ui-font-size1);
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

.jp-Dialog-footer {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  flex: 0 0 auto;
  margin-left: -12px;
  margin-right: -12px;
  padding: 12px;
}

.jp-Dialog-checkbox {
  padding-right: 5px;
}

.jp-Dialog-checkbox > input:focus-visible {
  outline: 1px solid var(--jp-input-active-border-color);
  outline-offset: 1px;
}

.jp-Dialog-spacer {
  flex: 1 1 auto;
}

.jp-Dialog-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.jp-Dialog-body > .jp-select-wrapper {
  width: 100%;
}

.jp-Dialog-body > button {
  padding: 0 16px;
}

.jp-Dialog-body > label {
  line-height: 1.4;
  color: var(--jp-ui-font-color0);
}

.jp-Dialog-button.jp-mod-styled:not(:last-child) {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Input-Boolean-Dialog {
  flex-direction: row-reverse;
  align-items: end;
  width: 100%;
}

.jp-Input-Boolean-Dialog > label {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MainAreaWidget > :focus {
  outline: none;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error {
  padding: 6px;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error > pre {
  width: auto;
  padding: 10px;
  background: var(--jp-error-color3);
  border: var(--jp-border-width) solid var(--jp-error-color1);
  border-radius: var(--jp-border-radius);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  white-space: pre-wrap;
  word-wrap: break-word;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/**
 * google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 */
:root {
  --md-red-50: #ffebee;
  --md-red-100: #ffcdd2;
  --md-red-200: #ef9a9a;
  --md-red-300: #e57373;
  --md-red-400: #ef5350;
  --md-red-500: #f44336;
  --md-red-600: #e53935;
  --md-red-700: #d32f2f;
  --md-red-800: #c62828;
  --md-red-900: #b71c1c;
  --md-red-A100: #ff8a80;
  --md-red-A200: #ff5252;
  --md-red-A400: #ff1744;
  --md-red-A700: #d50000;
  --md-pink-50: #fce4ec;
  --md-pink-100: #f8bbd0;
  --md-pink-200: #f48fb1;
  --md-pink-300: #f06292;
  --md-pink-400: #ec407a;
  --md-pink-500: #e91e63;
  --md-pink-600: #d81b60;
  --md-pink-700: #c2185b;
  --md-pink-800: #ad1457;
  --md-pink-900: #880e4f;
  --md-pink-A100: #ff80ab;
  --md-pink-A200: #ff4081;
  --md-pink-A400: #f50057;
  --md-pink-A700: #c51162;
  --md-purple-50: #f3e5f5;
  --md-purple-100: #e1bee7;
  --md-purple-200: #ce93d8;
  --md-purple-300: #ba68c8;
  --md-purple-400: #ab47bc;
  --md-purple-500: #9c27b0;
  --md-purple-600: #8e24aa;
  --md-purple-700: #7b1fa2;
  --md-purple-800: #6a1b9a;
  --md-purple-900: #4a148c;
  --md-purple-A100: #ea80fc;
  --md-purple-A200: #e040fb;
  --md-purple-A400: #d500f9;
  --md-purple-A700: #a0f;
  --md-deep-purple-50: #ede7f6;
  --md-deep-purple-100: #d1c4e9;
  --md-deep-purple-200: #b39ddb;
  --md-deep-purple-300: #9575cd;
  --md-deep-purple-400: #7e57c2;
  --md-deep-purple-500: #673ab7;
  --md-deep-purple-600: #5e35b1;
  --md-deep-purple-700: #512da8;
  --md-deep-purple-800: #4527a0;
  --md-deep-purple-900: #311b92;
  --md-deep-purple-A100: #b388ff;
  --md-deep-purple-A200: #7c4dff;
  --md-deep-purple-A400: #651fff;
  --md-deep-purple-A700: #6200ea;
  --md-indigo-50: #e8eaf6;
  --md-indigo-100: #c5cae9;
  --md-indigo-200: #9fa8da;
  --md-indigo-300: #7986cb;
  --md-indigo-400: #5c6bc0;
  --md-indigo-500: #3f51b5;
  --md-indigo-600: #3949ab;
  --md-indigo-700: #303f9f;
  --md-indigo-800: #283593;
  --md-indigo-900: #1a237e;
  --md-indigo-A100: #8c9eff;
  --md-indigo-A200: #536dfe;
  --md-indigo-A400: #3d5afe;
  --md-indigo-A700: #304ffe;
  --md-blue-50: #e3f2fd;
  --md-blue-100: #bbdefb;
  --md-blue-200: #90caf9;
  --md-blue-300: #64b5f6;
  --md-blue-400: #42a5f5;
  --md-blue-500: #2196f3;
  --md-blue-600: #1e88e5;
  --md-blue-700: #1976d2;
  --md-blue-800: #1565c0;
  --md-blue-900: #0d47a1;
  --md-blue-A100: #82b1ff;
  --md-blue-A200: #448aff;
  --md-blue-A400: #2979ff;
  --md-blue-A700: #2962ff;
  --md-light-blue-50: #e1f5fe;
  --md-light-blue-100: #b3e5fc;
  --md-light-blue-200: #81d4fa;
  --md-light-blue-300: #4fc3f7;
  --md-light-blue-400: #29b6f6;
  --md-light-blue-500: #03a9f4;
  --md-light-blue-600: #039be5;
  --md-light-blue-700: #0288d1;
  --md-light-blue-800: #0277bd;
  --md-light-blue-900: #01579b;
  --md-light-blue-A100: #80d8ff;
  --md-light-blue-A200: #40c4ff;
  --md-light-blue-A400: #00b0ff;
  --md-light-blue-A700: #0091ea;
  --md-cyan-50: #e0f7fa;
  --md-cyan-100: #b2ebf2;
  --md-cyan-200: #80deea;
  --md-cyan-300: #4dd0e1;
  --md-cyan-400: #26c6da;
  --md-cyan-500: #00bcd4;
  --md-cyan-600: #00acc1;
  --md-cyan-700: #0097a7;
  --md-cyan-800: #00838f;
  --md-cyan-900: #006064;
  --md-cyan-A100: #84ffff;
  --md-cyan-A200: #18ffff;
  --md-cyan-A400: #00e5ff;
  --md-cyan-A700: #00b8d4;
  --md-teal-50: #e0f2f1;
  --md-teal-100: #b2dfdb;
  --md-teal-200: #80cbc4;
  --md-teal-300: #4db6ac;
  --md-teal-400: #26a69a;
  --md-teal-500: #009688;
  --md-teal-600: #00897b;
  --md-teal-700: #00796b;
  --md-teal-800: #00695c;
  --md-teal-900: #004d40;
  --md-teal-A100: #a7ffeb;
  --md-teal-A200: #64ffda;
  --md-teal-A400: #1de9b6;
  --md-teal-A700: #00bfa5;
  --md-green-50: #e8f5e9;
  --md-green-100: #c8e6c9;
  --md-green-200: #a5d6a7;
  --md-green-300: #81c784;
  --md-green-400: #66bb6a;
  --md-green-500: #4caf50;
  --md-green-600: #43a047;
  --md-green-700: #388e3c;
  --md-green-800: #2e7d32;
  --md-green-900: #1b5e20;
  --md-green-A100: #b9f6ca;
  --md-green-A200: #69f0ae;
  --md-green-A400: #00e676;
  --md-green-A700: #00c853;
  --md-light-green-50: #f1f8e9;
  --md-light-green-100: #dcedc8;
  --md-light-green-200: #c5e1a5;
  --md-light-green-300: #aed581;
  --md-light-green-400: #9ccc65;
  --md-light-green-500: #8bc34a;
  --md-light-green-600: #7cb342;
  --md-light-green-700: #689f38;
  --md-light-green-800: #558b2f;
  --md-light-green-900: #33691e;
  --md-light-green-A100: #ccff90;
  --md-light-green-A200: #b2ff59;
  --md-light-green-A400: #76ff03;
  --md-light-green-A700: #64dd17;
  --md-lime-50: #f9fbe7;
  --md-lime-100: #f0f4c3;
  --md-lime-200: #e6ee9c;
  --md-lime-300: #dce775;
  --md-lime-400: #d4e157;
  --md-lime-500: #cddc39;
  --md-lime-600: #c0ca33;
  --md-lime-700: #afb42b;
  --md-lime-800: #9e9d24;
  --md-lime-900: #827717;
  --md-lime-A100: #f4ff81;
  --md-lime-A200: #eeff41;
  --md-lime-A400: #c6ff00;
  --md-lime-A700: #aeea00;
  --md-yellow-50: #fffde7;
  --md-yellow-100: #fff9c4;
  --md-yellow-200: #fff59d;
  --md-yellow-300: #fff176;
  --md-yellow-400: #ffee58;
  --md-yellow-500: #ffeb3b;
  --md-yellow-600: #fdd835;
  --md-yellow-700: #fbc02d;
  --md-yellow-800: #f9a825;
  --md-yellow-900: #f57f17;
  --md-yellow-A100: #ffff8d;
  --md-yellow-A200: #ff0;
  --md-yellow-A400: #ffea00;
  --md-yellow-A700: #ffd600;
  --md-amber-50: #fff8e1;
  --md-amber-100: #ffecb3;
  --md-amber-200: #ffe082;
  --md-amber-300: #ffd54f;
  --md-amber-400: #ffca28;
  --md-amber-500: #ffc107;
  --md-amber-600: #ffb300;
  --md-amber-700: #ffa000;
  --md-amber-800: #ff8f00;
  --md-amber-900: #ff6f00;
  --md-amber-A100: #ffe57f;
  --md-amber-A200: #ffd740;
  --md-amber-A400: #ffc400;
  --md-amber-A700: #ffab00;
  --md-orange-50: #fff3e0;
  --md-orange-100: #ffe0b2;
  --md-orange-200: #ffcc80;
  --md-orange-300: #ffb74d;
  --md-orange-400: #ffa726;
  --md-orange-500: #ff9800;
  --md-orange-600: #fb8c00;
  --md-orange-700: #f57c00;
  --md-orange-800: #ef6c00;
  --md-orange-900: #e65100;
  --md-orange-A100: #ffd180;
  --md-orange-A200: #ffab40;
  --md-orange-A400: #ff9100;
  --md-orange-A700: #ff6d00;
  --md-deep-orange-50: #fbe9e7;
  --md-deep-orange-100: #ffccbc;
  --md-deep-orange-200: #ffab91;
  --md-deep-orange-300: #ff8a65;
  --md-deep-orange-400: #ff7043;
  --md-deep-orange-500: #ff5722;
  --md-deep-orange-600: #f4511e;
  --md-deep-orange-700: #e64a19;
  --md-deep-orange-800: #d84315;
  --md-deep-orange-900: #bf360c;
  --md-deep-orange-A100: #ff9e80;
  --md-deep-orange-A200: #ff6e40;
  --md-deep-orange-A400: #ff3d00;
  --md-deep-orange-A700: #dd2c00;
  --md-brown-50: #efebe9;
  --md-brown-100: #d7ccc8;
  --md-brown-200: #bcaaa4;
  --md-brown-300: #a1887f;
  --md-brown-400: #8d6e63;
  --md-brown-500: #795548;
  --md-brown-600: #6d4c41;
  --md-brown-700: #5d4037;
  --md-brown-800: #4e342e;
  --md-brown-900: #3e2723;
  --md-grey-50: #fafafa;
  --md-grey-100: #f5f5f5;
  --md-grey-200: #eee;
  --md-grey-300: #e0e0e0;
  --md-grey-400: #bdbdbd;
  --md-grey-500: #9e9e9e;
  --md-grey-600: #757575;
  --md-grey-700: #616161;
  --md-grey-800: #424242;
  --md-grey-900: #212121;
  --md-blue-grey-50: #eceff1;
  --md-blue-grey-100: #cfd8dc;
  --md-blue-grey-200: #b0bec5;
  --md-blue-grey-300: #90a4ae;
  --md-blue-grey-400: #78909c;
  --md-blue-grey-500: #607d8b;
  --md-blue-grey-600: #546e7a;
  --md-blue-grey-700: #455a64;
  --md-blue-grey-800: #37474f;
  --md-blue-grey-900: #263238;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| RenderedText
|----------------------------------------------------------------------------*/

:root {
  /* This is the padding value to fill the gaps between lines containing spans with background color. */
  --jp-private-code-span-padding: calc(
    (var(--jp-code-line-height) - 1) * var(--jp-code-font-size) / 2
  );
}

.jp-RenderedText {
  text-align: left;
  padding-left: var(--jp-code-padding);
  line-height: var(--jp-code-line-height);
  font-family: var(--jp-code-font-family);
}

.jp-RenderedText pre,
.jp-RenderedJavaScript pre,
.jp-RenderedHTMLCommon pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
  border: none;
  margin: 0;
  padding: 0;
}

.jp-RenderedText pre a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* console foregrounds and backgrounds */
.jp-RenderedText pre .ansi-black-fg {
  color: #3e424d;
}

.jp-RenderedText pre .ansi-red-fg {
  color: #e75c58;
}

.jp-RenderedText pre .ansi-green-fg {
  color: #00a250;
}

.jp-RenderedText pre .ansi-yellow-fg {
  color: #ddb62b;
}

.jp-RenderedText pre .ansi-blue-fg {
  color: #208ffb;
}

.jp-RenderedText pre .ansi-magenta-fg {
  color: #d160c4;
}

.jp-RenderedText pre .ansi-cyan-fg {
  color: #60c6c8;
}

.jp-RenderedText pre .ansi-white-fg {
  color: #c5c1b4;
}

.jp-RenderedText pre .ansi-black-bg {
  background-color: #3e424d;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-bg {
  background-color: #e75c58;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-bg {
  background-color: #00a250;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-bg {
  background-color: #ddb62b;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-bg {
  background-color: #208ffb;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-bg {
  background-color: #d160c4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-bg {
  background-color: #60c6c8;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-bg {
  background-color: #c5c1b4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-black-intense-fg {
  color: #282c36;
}

.jp-RenderedText pre .ansi-red-intense-fg {
  color: #b22b31;
}

.jp-RenderedText pre .ansi-green-intense-fg {
  color: #007427;
}

.jp-RenderedText pre .ansi-yellow-intense-fg {
  color: #b27d12;
}

.jp-RenderedText pre .ansi-blue-intense-fg {
  color: #0065ca;
}

.jp-RenderedText pre .ansi-magenta-intense-fg {
  color: #a03196;
}

.jp-RenderedText pre .ansi-cyan-intense-fg {
  color: #258f8f;
}

.jp-RenderedText pre .ansi-white-intense-fg {
  color: #a1a6b2;
}

.jp-RenderedText pre .ansi-black-intense-bg {
  background-color: #282c36;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-intense-bg {
  background-color: #b22b31;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-intense-bg {
  background-color: #007427;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-intense-bg {
  background-color: #b27d12;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-intense-bg {
  background-color: #0065ca;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-intense-bg {
  background-color: #a03196;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-intense-bg {
  background-color: #258f8f;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-intense-bg {
  background-color: #a1a6b2;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-default-inverse-fg {
  color: var(--jp-ui-inverse-font-color0);
}

.jp-RenderedText pre .ansi-default-inverse-bg {
  background-color: var(--jp-inverse-layout-color0);
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-bold {
  font-weight: bold;
}

.jp-RenderedText pre .ansi-underline {
  text-decoration: underline;
}

.jp-RenderedText[data-mime-type='application/vnd.jupyter.stderr'] {
  background: var(--jp-rendermime-error-background);
  padding-top: var(--jp-code-padding);
}

/*-----------------------------------------------------------------------------
| RenderedLatex
|----------------------------------------------------------------------------*/

.jp-RenderedLatex {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);
}

/* Left-justify outputs.*/
.jp-OutputArea-output.jp-RenderedLatex {
  padding: var(--jp-code-padding);
  text-align: left;
}

/*-----------------------------------------------------------------------------
| RenderedHTML
|----------------------------------------------------------------------------*/

.jp-RenderedHTMLCommon {
  color: var(--jp-content-font-color1);
  font-family: var(--jp-content-font-family);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);

  /* Give a bit more R padding on Markdown text to keep line lengths reasonable */
  padding-right: 20px;
}

.jp-RenderedHTMLCommon em {
  font-style: italic;
}

.jp-RenderedHTMLCommon strong {
  font-weight: bold;
}

.jp-RenderedHTMLCommon u {
  text-decoration: underline;
}

.jp-RenderedHTMLCommon a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* Headings */

.jp-RenderedHTMLCommon h1,
.jp-RenderedHTMLCommon h2,
.jp-RenderedHTMLCommon h3,
.jp-RenderedHTMLCommon h4,
.jp-RenderedHTMLCommon h5,
.jp-RenderedHTMLCommon h6 {
  line-height: var(--jp-content-heading-line-height);
  font-weight: var(--jp-content-heading-font-weight);
  font-style: normal;
  margin: var(--jp-content-heading-margin-top) 0
    var(--jp-content-heading-margin-bottom) 0;
}

.jp-RenderedHTMLCommon h1:first-child,
.jp-RenderedHTMLCommon h2:first-child,
.jp-RenderedHTMLCommon h3:first-child,
.jp-RenderedHTMLCommon h4:first-child,
.jp-RenderedHTMLCommon h5:first-child,
.jp-RenderedHTMLCommon h6:first-child {
  margin-top: calc(0.5 * var(--jp-content-heading-margin-top));
}

.jp-RenderedHTMLCommon h1:last-child,
.jp-RenderedHTMLCommon h2:last-child,
.jp-RenderedHTMLCommon h3:last-child,
.jp-RenderedHTMLCommon h4:last-child,
.jp-RenderedHTMLCommon h5:last-child,
.jp-RenderedHTMLCommon h6:last-child {
  margin-bottom: calc(0.5 * var(--jp-content-heading-margin-bottom));
}

.jp-RenderedHTMLCommon h1 {
  font-size: var(--jp-content-font-size5);
}

.jp-RenderedHTMLCommon h2 {
  font-size: var(--jp-content-font-size4);
}

.jp-RenderedHTMLCommon h3 {
  font-size: var(--jp-content-font-size3);
}

.jp-RenderedHTMLCommon h4 {
  font-size: var(--jp-content-font-size2);
}

.jp-RenderedHTMLCommon h5 {
  font-size: var(--jp-content-font-size1);
}

.jp-RenderedHTMLCommon h6 {
  font-size: var(--jp-content-font-size0);
}

/* Lists */

/* stylelint-disable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon ul:not(.list-inline),
.jp-RenderedHTMLCommon ol:not(.list-inline) {
  padding-left: 2em;
}

.jp-RenderedHTMLCommon ul {
  list-style: disc;
}

.jp-RenderedHTMLCommon ul ul {
  list-style: square;
}

.jp-RenderedHTMLCommon ul ul ul {
  list-style: circle;
}

.jp-RenderedHTMLCommon ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol ol {
  list-style: upper-alpha;
}

.jp-RenderedHTMLCommon ol ol ol {
  list-style: lower-alpha;
}

.jp-RenderedHTMLCommon ol ol ol ol {
  list-style: lower-roman;
}

.jp-RenderedHTMLCommon ol ol ol ol ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol,
.jp-RenderedHTMLCommon ul {
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon ul ul,
.jp-RenderedHTMLCommon ul ol,
.jp-RenderedHTMLCommon ol ul,
.jp-RenderedHTMLCommon ol ol {
  margin-bottom: 0;
}

/* stylelint-enable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon hr {
  color: var(--jp-border-color2);
  background-color: var(--jp-border-color1);
  margin-top: 1em;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon > pre {
  margin: 1.5em 2em;
}

.jp-RenderedHTMLCommon pre,
.jp-RenderedHTMLCommon code {
  border: 0;
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  line-height: var(--jp-code-line-height);
  padding: 0;
  white-space: pre-wrap;
}

.jp-RenderedHTMLCommon :not(pre) > code {
  background-color: var(--jp-layout-color2);
  padding: 1px 5px;
}

/* Tables */

.jp-RenderedHTMLCommon table {
  border-collapse: collapse;
  border-spacing: 0;
  border: none;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  table-layout: fixed;
  margin-left: auto;
  margin-bottom: 1em;
  margin-right: auto;
}

.jp-RenderedHTMLCommon thead {
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  vertical-align: bottom;
}

.jp-RenderedHTMLCommon td,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon tr {
  vertical-align: middle;
  padding: 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}

.jp-RenderedMarkdown.jp-RenderedHTMLCommon td,
.jp-RenderedMarkdown.jp-RenderedHTMLCommon th {
  max-width: none;
}

:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon td,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon th,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon tr {
  text-align: right;
}

.jp-RenderedHTMLCommon th {
  font-weight: bold;
}

.jp-RenderedHTMLCommon tbody tr:nth-child(odd) {
  background: var(--jp-layout-color0);
}

.jp-RenderedHTMLCommon tbody tr:nth-child(even) {
  background: var(--jp-rendermime-table-row-background);
}

.jp-RenderedHTMLCommon tbody tr:hover {
  background: var(--jp-rendermime-table-row-hover-background);
}

.jp-RenderedHTMLCommon p {
  text-align: left;
  margin: 0;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon img {
  -moz-force-broken-image-icon: 1;
}

/* Restrict to direct children as other images could be nested in other content. */
.jp-RenderedHTMLCommon > img {
  display: block;
  margin-left: 0;
  margin-right: 0;
  margin-bottom: 1em;
}

/* Change color behind transparent images if they need it... */
[data-jp-theme-light='false'] .jp-RenderedImage img.jp-needs-light-background {
  background-color: var(--jp-inverse-layout-color1);
}

[data-jp-theme-light='true'] .jp-RenderedImage img.jp-needs-dark-background {
  background-color: var(--jp-inverse-layout-color1);
}

.jp-RenderedHTMLCommon img,
.jp-RenderedImage img,
.jp-RenderedHTMLCommon svg,
.jp-RenderedSVG svg {
  max-width: 100%;
  height: auto;
}

.jp-RenderedHTMLCommon img.jp-mod-unconfined,
.jp-RenderedImage img.jp-mod-unconfined,
.jp-RenderedHTMLCommon svg.jp-mod-unconfined,
.jp-RenderedSVG svg.jp-mod-unconfined {
  max-width: none;
}

.jp-RenderedHTMLCommon .alert {
  padding: var(--jp-notebook-padding);
  border: var(--jp-border-width) solid transparent;
  border-radius: var(--jp-border-radius);
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon .alert-info {
  color: var(--jp-info-color0);
  background-color: var(--jp-info-color3);
  border-color: var(--jp-info-color2);
}

.jp-RenderedHTMLCommon .alert-info hr {
  border-color: var(--jp-info-color3);
}

.jp-RenderedHTMLCommon .alert-info > p:last-child,
.jp-RenderedHTMLCommon .alert-info > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-warning {
  color: var(--jp-warn-color0);
  background-color: var(--jp-warn-color3);
  border-color: var(--jp-warn-color2);
}

.jp-RenderedHTMLCommon .alert-warning hr {
  border-color: var(--jp-warn-color3);
}

.jp-RenderedHTMLCommon .alert-warning > p:last-child,
.jp-RenderedHTMLCommon .alert-warning > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-success {
  color: var(--jp-success-color0);
  background-color: var(--jp-success-color3);
  border-color: var(--jp-success-color2);
}

.jp-RenderedHTMLCommon .alert-success hr {
  border-color: var(--jp-success-color3);
}

.jp-RenderedHTMLCommon .alert-success > p:last-child,
.jp-RenderedHTMLCommon .alert-success > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-danger {
  color: var(--jp-error-color0);
  background-color: var(--jp-error-color3);
  border-color: var(--jp-error-color2);
}

.jp-RenderedHTMLCommon .alert-danger hr {
  border-color: var(--jp-error-color3);
}

.jp-RenderedHTMLCommon .alert-danger > p:last-child,
.jp-RenderedHTMLCommon .alert-danger > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon blockquote {
  margin: 1em 2em;
  padding: 0 1em;
  border-left: 5px solid var(--jp-border-color2);
}

a.jp-InternalAnchorLink {
  visibility: hidden;
  margin-left: 8px;
  color: var(--md-blue-800);
}

h1:hover .jp-InternalAnchorLink,
h2:hover .jp-InternalAnchorLink,
h3:hover .jp-InternalAnchorLink,
h4:hover .jp-InternalAnchorLink,
h5:hover .jp-InternalAnchorLink,
h6:hover .jp-InternalAnchorLink {
  visibility: visible;
}

.jp-RenderedHTMLCommon kbd {
  background-color: var(--jp-rendermime-table-row-background);
  border: 1px solid var(--jp-border-color0);
  border-bottom-color: var(--jp-border-color2);
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
  display: inline-block;
  font-size: var(--jp-ui-font-size0);
  line-height: 1em;
  padding: 0.2em 0.5em;
}

/* Most direct children of .jp-RenderedHTMLCommon have a margin-bottom of 1.0.
 * At the bottom of cells this is a bit too much as there is also spacing
 * between cells. Going all the way to 0 gets too tight between markdown and
 * code cells.
 */
.jp-RenderedHTMLCommon > *:last-child {
  margin-bottom: 0.5em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-cursor-backdrop {
  position: fixed;
  width: 200px;
  height: 200px;
  margin-top: -100px;
  margin-left: -100px;
  will-change: transform;
  z-index: 100;
}

.lm-mod-drag-image {
  will-change: transform;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-lineFormSearch {
  padding: 4px 12px;
  background-color: var(--jp-layout-color2);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
  font-size: var(--jp-ui-font-size1);
}

.jp-lineFormCaption {
  font-size: var(--jp-ui-font-size0);
  line-height: var(--jp-ui-font-size1);
  margin-top: 4px;
  color: var(--jp-ui-font-color0);
}

.jp-baseLineForm {
  border: none;
  border-radius: 0;
  position: absolute;
  background-size: 16px;
  background-repeat: no-repeat;
  background-position: center;
  outline: none;
}

.jp-lineFormButtonContainer {
  top: 4px;
  right: 8px;
  height: 24px;
  padding: 0 12px;
  width: 12px;
}

.jp-lineFormButtonIcon {
  top: 0;
  right: 0;
  background-color: var(--jp-brand-color1);
  height: 100%;
  width: 100%;
  box-sizing: border-box;
  padding: 4px 6px;
}

.jp-lineFormButton {
  top: 0;
  right: 0;
  background-color: transparent;
  height: 100%;
  width: 100%;
  box-sizing: border-box;
}

.jp-lineFormWrapper {
  overflow: hidden;
  padding: 0 8px;
  border: 1px solid var(--jp-border-color0);
  background-color: var(--jp-input-active-background);
  height: 22px;
}

.jp-lineFormWrapperFocusWithin {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-lineFormInput {
  background: transparent;
  width: 200px;
  height: 100%;
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  line-height: 28px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-JSONEditor {
  display: flex;
  flex-direction: column;
  width: 100%;
}

.jp-JSONEditor-host {
  flex: 1 1 auto;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  background: var(--jp-layout-color0);
  min-height: 50px;
  padding: 1px;
}

.jp-JSONEditor.jp-mod-error .jp-JSONEditor-host {
  border-color: red;
  outline-color: red;
}

.jp-JSONEditor-header {
  display: flex;
  flex: 1 0 auto;
  padding: 0 0 0 12px;
}

.jp-JSONEditor-header label {
  flex: 0 0 auto;
}

.jp-JSONEditor-commitButton {
  height: 16px;
  width: 16px;
  background-size: 18px;
  background-repeat: no-repeat;
  background-position: center;
}

.jp-JSONEditor-host.jp-mod-focused {
  background-color: var(--jp-input-active-background);
  border: 1px solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

.jp-Editor.jp-mod-dropTarget {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/
.jp-DocumentSearch-input {
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  font-size: var(--jp-ui-font-size1);
  background-color: var(--jp-layout-color0);
  font-family: var(--jp-ui-font-family);
  padding: 2px 1px;
  resize: none;
}

.jp-DocumentSearch-overlay {
  position: absolute;
  background-color: var(--jp-toolbar-background);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  border-left: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  top: 0;
  right: 0;
  z-index: 7;
  min-width: 405px;
  padding: 2px;
  font-size: var(--jp-ui-font-size1);

  --jp-private-document-search-button-height: 20px;
}

.jp-DocumentSearch-overlay button {
  background-color: var(--jp-toolbar-background);
  outline: 0;
}

.jp-DocumentSearch-overlay button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-overlay button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-overlay-row {
  display: flex;
  align-items: center;
  margin-bottom: 2px;
}

.jp-DocumentSearch-button-content {
  display: inline-block;
  cursor: pointer;
  box-sizing: border-box;
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-button-content svg {
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-input-wrapper {
  border: var(--jp-border-width) solid var(--jp-border-color0);
  display: flex;
  background-color: var(--jp-layout-color0);
  margin: 2px;
}

.jp-DocumentSearch-input-wrapper:focus-within {
  border-color: var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper {
  all: initial;
  overflow: hidden;
  display: inline-block;
  border: none;
  box-sizing: border-box;
}

.jp-DocumentSearch-toggle-wrapper {
  width: 14px;
  height: 14px;
}

.jp-DocumentSearch-button-wrapper {
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
}

.jp-DocumentSearch-toggle-wrapper:focus,
.jp-DocumentSearch-button-wrapper:focus {
  outline: var(--jp-border-width) solid
    var(--jp-cell-editor-active-border-color);
  outline-offset: -1px;
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper,
.jp-DocumentSearch-button-content:focus {
  outline: none;
}

.jp-DocumentSearch-toggle-placeholder {
  width: 5px;
}

.jp-DocumentSearch-input-button::before {
  display: block;
  padding-top: 100%;
}

.jp-DocumentSearch-input-button-off {
  opacity: var(--jp-search-toggle-off-opacity);
}

.jp-DocumentSearch-input-button-off:hover {
  opacity: var(--jp-search-toggle-hover-opacity);
}

.jp-DocumentSearch-input-button-on {
  opacity: var(--jp-search-toggle-on-opacity);
}

.jp-DocumentSearch-index-counter {
  padding-left: 10px;
  padding-right: 10px;
  user-select: none;
  min-width: 35px;
  display: inline-block;
}

.jp-DocumentSearch-up-down-wrapper {
  display: inline-block;
  padding-right: 2px;
  margin-left: auto;
  white-space: nowrap;
}

.jp-DocumentSearch-spacer {
  margin-left: auto;
}

.jp-DocumentSearch-up-down-wrapper button {
  outline: 0;
  border: none;
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
  vertical-align: middle;
  margin: 1px 5px 2px;
}

.jp-DocumentSearch-up-down-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-up-down-button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-filter-button {
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-filter-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled:hover {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-search-options {
  padding: 0 8px;
  margin-left: 3px;
  width: 100%;
  display: grid;
  justify-content: start;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  justify-items: stretch;
}

.jp-DocumentSearch-search-filter-disabled {
  color: var(--jp-ui-font-color2);
}

.jp-DocumentSearch-search-filter {
  display: flex;
  align-items: center;
  user-select: none;
}

.jp-DocumentSearch-regex-error {
  color: var(--jp-error-color0);
}

.jp-DocumentSearch-replace-button-wrapper {
  overflow: hidden;
  display: inline-block;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color0);
  margin: auto 2px;
  padding: 1px 4px;
  height: calc(var(--jp-private-document-search-button-height) + 2px);
}

.jp-DocumentSearch-replace-button-wrapper:focus {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-replace-button {
  display: inline-block;
  text-align: center;
  cursor: pointer;
  box-sizing: border-box;
  color: var(--jp-ui-font-color1);

  /* height - 2 * (padding of wrapper) */
  line-height: calc(var(--jp-private-document-search-button-height) - 2px);
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-replace-button:focus {
  outline: none;
}

.jp-DocumentSearch-replace-wrapper-class {
  margin-left: 14px;
  display: flex;
}

.jp-DocumentSearch-replace-toggle {
  border: none;
  background-color: var(--jp-toolbar-background);
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-replace-toggle:hover {
  background-color: var(--jp-layout-color2);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.cm-editor {
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  border: 0;
  border-radius: 0;
  height: auto;

  /* Changed to auto to autogrow */
}

.cm-editor pre {
  padding: 0 var(--jp-code-padding);
}

.jp-CodeMirrorEditor[data-type='inline'] .cm-dialog {
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
}

.jp-CodeMirrorEditor {
  cursor: text;
}

/* When zoomed out 67% and 33% on a screen of 1440 width x 900 height */
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width1) solid
      var(--jp-editor-cursor-color);
  }
}

/* When zoomed out less than 33% */
@media screen and (min-width: 4320px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width2) solid
      var(--jp-editor-cursor-color);
  }
}

.cm-editor.jp-mod-readOnly .cm-cursor {
  display: none;
}

.jp-CollaboratorCursor {
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: none;
  border-bottom: 3px solid;
  background-clip: content-box;
  margin-left: -5px;
  margin-right: -5px;
}

.cm-searching,
.cm-searching span {
  /* `.cm-searching span`: we need to override syntax highlighting */
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.cm-searching::selection,
.cm-searching span::selection {
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.jp-current-match > .cm-searching,
.jp-current-match > .cm-searching span,
.cm-searching > .jp-current-match,
.cm-searching > .jp-current-match span {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.jp-current-match > .cm-searching::selection,
.cm-searching > .jp-current-match::selection,
.jp-current-match > .cm-searching span::selection {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.cm-trailingspace {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAsElEQVQIHQGlAFr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7+r3zKmT0/+pk9P/7+r3zAAAAAAAAAAABAAAAAAAAAAA6OPzM+/q9wAAAAAA6OPzMwAAAAAAAAAAAgAAAAAAAAAAGR8NiRQaCgAZIA0AGR8NiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQyoYJ/SY80UAAAAASUVORK5CYII=);
  background-position: center left;
  background-repeat: repeat-x;
}

.jp-CollaboratorCursor-hover {
  position: absolute;
  z-index: 1;
  transform: translateX(-50%);
  color: white;
  border-radius: 3px;
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 1px;
  padding-bottom: 1px;
  text-align: center;
  font-size: var(--jp-ui-font-size1);
  white-space: nowrap;
}

.jp-CodeMirror-ruler {
  border-left: 1px dashed var(--jp-border-color2);
}

/* Styles for shared cursors (remote cursor locations and selected ranges) */
.jp-CodeMirrorEditor .cm-ySelectionCaret {
  position: relative;
  border-left: 1px solid black;
  margin-left: -1px;
  margin-right: -1px;
  box-sizing: border-box;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret > .cm-ySelectionInfo {
  white-space: nowrap;
  position: absolute;
  top: -1.15em;
  padding-bottom: 0.05em;
  left: -1px;
  font-size: 0.95em;
  font-family: var(--jp-ui-font-family);
  font-weight: bold;
  line-height: normal;
  user-select: none;
  color: white;
  padding-left: 2px;
  padding-right: 2px;
  z-index: 101;
  transition: opacity 0.3s ease-in-out;
}

.jp-CodeMirrorEditor .cm-ySelectionInfo {
  transition-delay: 0.7s;
  opacity: 0;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret:hover > .cm-ySelectionInfo {
  opacity: 1;
  transition-delay: 0s;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MimeDocument {
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-filebrowser-button-height: 28px;
  --jp-private-filebrowser-button-width: 48px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FileBrowser .jp-SidePanel-content {
  display: flex;
  flex-direction: column;
}

.jp-FileBrowser-toolbar.jp-Toolbar {
  flex-wrap: wrap;
  row-gap: 12px;
  border-bottom: none;
  height: auto;
  margin: 8px 12px 0;
  box-shadow: none;
  padding: 0;
  justify-content: flex-start;
}

.jp-FileBrowser-Panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}

.jp-BreadCrumbs {
  flex: 0 0 auto;
  margin: 8px 12px;
}

.jp-BreadCrumbs-item {
  margin: 0 2px;
  padding: 0 2px;
  border-radius: var(--jp-border-radius);
  cursor: pointer;
}

.jp-BreadCrumbs-item:hover {
  background-color: var(--jp-layout-color2);
}

.jp-BreadCrumbs-item:first-child {
  margin-left: 0;
}

.jp-BreadCrumbs-item.jp-mod-dropTarget {
  background-color: var(--jp-brand-color2);
  opacity: 0.7;
}

/*-----------------------------------------------------------------------------
| Buttons
|----------------------------------------------------------------------------*/

.jp-FileBrowser-toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  padding-left: 0;
  padding-right: 2px;
  align-items: center;
  height: unset;
}

.jp-FileBrowser-toolbar > .jp-Toolbar-item .jp-ToolbarButtonComponent {
  width: 40px;
}

/*-----------------------------------------------------------------------------
| Other styles
|----------------------------------------------------------------------------*/

.jp-FileDialog.jp-mod-conflict input {
  color: var(--jp-error-color1);
}

.jp-FileDialog .jp-new-name-title {
  margin-top: 12px;
}

.jp-LastModified-hidden {
  display: none;
}

.jp-FileSize-hidden {
  display: none;
}

.jp-FileBrowser .lm-AccordionPanel > h3:first-child {
  display: none;
}

/*-----------------------------------------------------------------------------
| DirListing
|----------------------------------------------------------------------------*/

.jp-DirListing {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  outline: 0;
}

.jp-DirListing-header {
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  align-items: center;
  overflow: hidden;
  border-top: var(--jp-border-width) solid var(--jp-border-color2);
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
}

.jp-DirListing-headerItem {
  padding: 4px 12px 2px;
  font-weight: 500;
}

.jp-DirListing-headerItem:hover {
  background: var(--jp-layout-color2);
}

.jp-DirListing-headerItem.jp-id-name {
  flex: 1 0 84px;
}

.jp-DirListing-headerItem.jp-id-modified {
  flex: 0 0 112px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-DirListing-headerItem.jp-id-filesize {
  flex: 0 0 75px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-id-narrow {
  display: none;
  flex: 0 0 5px;
  padding: 4px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
  color: var(--jp-border-color2);
}

.jp-DirListing-narrow .jp-id-narrow {
  display: block;
}

.jp-DirListing-narrow .jp-id-modified,
.jp-DirListing-narrow .jp-DirListing-itemModified {
  display: none;
}

.jp-DirListing-headerItem.jp-mod-selected {
  font-weight: 600;
}

/* increase specificity to override bundled default */
.jp-DirListing-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  list-style-type: none;
  overflow: auto;
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-content mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.jp-DirListing-content .jp-DirListing-item.jp-mod-selected mark {
  color: var(--jp-ui-inverse-font-color0);
}

/* Style the directory listing content when a user drops a file to upload */
.jp-DirListing.jp-mod-native-drop .jp-DirListing-content {
  outline: 5px dashed rgba(128, 128, 128, 0.5);
  outline-offset: -10px;
  cursor: copy;
}

.jp-DirListing-item {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px 12px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-DirListing-checkboxWrapper {
  /* Increases hit area of checkbox. */
  padding: 4px;
}

.jp-DirListing-header
  .jp-DirListing-checkboxWrapper
  + .jp-DirListing-headerItem {
  padding-left: 4px;
}

.jp-DirListing-content .jp-DirListing-checkboxWrapper {
  position: relative;
  left: -4px;
  margin: -4px 0 -4px -8px;
}

.jp-DirListing-checkboxWrapper.jp-mod-visible {
  visibility: visible;
}

/* For devices that support hovering, hide checkboxes until hovered, selected...
*/
@media (hover: hover) {
  .jp-DirListing-checkboxWrapper {
    visibility: hidden;
  }

  .jp-DirListing-item:hover .jp-DirListing-checkboxWrapper,
  .jp-DirListing-item.jp-mod-selected .jp-DirListing-checkboxWrapper {
    visibility: visible;
  }
}

.jp-DirListing-item[data-is-dot] {
  opacity: 75%;
}

.jp-DirListing-item.jp-mod-selected {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.jp-DirListing-item.jp-mod-dropTarget {
  background: var(--jp-brand-color3);
}

.jp-DirListing-item:hover:not(.jp-mod-selected) {
  background: var(--jp-layout-color2);
}

.jp-DirListing-itemIcon {
  flex: 0 0 20px;
  margin-right: 4px;
}

.jp-DirListing-itemText {
  flex: 1 0 64px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
}

.jp-DirListing-itemText:focus {
  outline-width: 2px;
  outline-color: var(--jp-inverse-layout-color1);
  outline-style: solid;
  outline-offset: 1px;
}

.jp-DirListing-item.jp-mod-selected .jp-DirListing-itemText:focus {
  outline-color: var(--jp-layout-color1);
}

.jp-DirListing-itemModified {
  flex: 0 0 125px;
  text-align: right;
}

.jp-DirListing-itemFileSize {
  flex: 0 0 90px;
  text-align: right;
}

.jp-DirListing-editor {
  flex: 1 0 64px;
  outline: none;
  border: none;
  color: var(--jp-ui-font-color1);
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-item.jp-mod-running .jp-DirListing-itemIcon::before {
  color: var(--jp-success-color1);
  content: '\25CF';
  font-size: 8px;
  position: absolute;
  left: -8px;
}

.jp-DirListing-item.jp-mod-running.jp-mod-selected
  .jp-DirListing-itemIcon::before {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-DirListing-item.lm-mod-drag-image,
.jp-DirListing-item.jp-mod-selected.lm-mod-drag-image {
  font-size: var(--jp-ui-font-size1);
  padding-left: 4px;
  margin-left: 4px;
  width: 160px;
  background-color: var(--jp-ui-inverse-font-color2);
  box-shadow: var(--jp-elevation-z2);
  border-radius: 0;
  color: var(--jp-ui-font-color1);
  transform: translateX(-40%) translateY(-58%);
}

.jp-Document {
  min-width: 120px;
  min-height: 120px;
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Main OutputArea
| OutputArea has a list of Outputs
|----------------------------------------------------------------------------*/

.jp-OutputArea {
  overflow-y: auto;
}

.jp-OutputArea-child {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-OutputPrompt {
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-outprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
  opacity: var(--jp-cell-prompt-opacity);

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-OutputArea-prompt {
  display: table-cell;
  vertical-align: top;
}

.jp-OutputArea-output {
  display: table-cell;
  width: 100%;
  height: auto;
  overflow: auto;
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  -ms-user-select: text;
}

.jp-OutputArea .jp-RenderedText {
  padding-left: 1ch;
}

/**
 * Prompt overlay.
 */

.jp-OutputArea-promptOverlay {
  position: absolute;
  top: 0;
  width: var(--jp-cell-prompt-width);
  height: 100%;
  opacity: 0.5;
}

.jp-OutputArea-promptOverlay:hover {
  background: var(--jp-layout-color2);
  box-shadow: inset 0 0 1px var(--jp-inverse-layout-color0);
  cursor: zoom-out;
}

.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay:hover {
  cursor: zoom-in;
}

/**
 * Isolated output.
 */
.jp-OutputArea-output.jp-mod-isolated {
  width: 100%;
  display: block;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated {
  position: relative;
}

body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/* pre */

.jp-OutputArea-output pre {
  border: none;
  margin: 0;
  padding: 0;
  overflow-x: auto;
  overflow-y: auto;
  word-break: break-all;
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* tables */

.jp-OutputArea-output.jp-RenderedHTMLCommon table {
  margin-left: 0;
  margin-right: 0;
}

/* description lists */

.jp-OutputArea-output dl,
.jp-OutputArea-output dt,
.jp-OutputArea-output dd {
  display: block;
}

.jp-OutputArea-output dl {
  width: 100%;
  overflow: hidden;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dt {
  font-weight: bold;
  float: left;
  width: 20%;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dd {
  float: left;
  width: 80%;
  padding: 0;
  margin: 0;
}

.jp-TrimmedOutputs pre {
  background: var(--jp-layout-color3);
  font-size: calc(var(--jp-code-font-size) * 1.4);
  text-align: center;
  text-transform: uppercase;
}

/* Hide the gutter in case of
 *  - nested output areas (e.g. in the case of output widgets)
 *  - mirrored output areas
 */
.jp-OutputArea .jp-OutputArea .jp-OutputArea-prompt {
  display: none;
}

/* Hide empty lines in the output area, for instance due to cleared widgets */
.jp-OutputArea-prompt:empty {
  padding: 0;
  border: 0;
}

/*-----------------------------------------------------------------------------
| executeResult is added to any Output-result for the display of the object
| returned by a cell
|----------------------------------------------------------------------------*/

.jp-OutputArea-output.jp-OutputArea-executeResult {
  margin-left: 0;
  width: 100%;
}

/* Text output with the Out[] prompt needs a top padding to match the
 * alignment of the Out[] prompt itself.
 */
.jp-OutputArea-executeResult .jp-RenderedText.jp-OutputArea-output {
  padding-top: var(--jp-code-padding);
  border-top: var(--jp-border-width) solid transparent;
}

/*-----------------------------------------------------------------------------
| The Stdin output
|----------------------------------------------------------------------------*/

.jp-Stdin-prompt {
  color: var(--jp-content-font-color0);
  padding-right: var(--jp-code-padding);
  vertical-align: baseline;
  flex: 0 0 auto;
}

.jp-Stdin-input {
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  color: inherit;
  background-color: inherit;
  width: 42%;
  min-width: 200px;

  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;

  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0 0.25em;
  margin: 0 0.25em;
  flex: 0 0 70%;
}

.jp-Stdin-input::placeholder {
  opacity: 0;
}

.jp-Stdin-input:focus {
  box-shadow: none;
}

.jp-Stdin-input:focus::placeholder {
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Output Area View
|----------------------------------------------------------------------------*/

.jp-LinkedOutputView .jp-OutputArea {
  height: 100%;
  display: block;
}

.jp-LinkedOutputView .jp-OutputArea-output:only-child {
  height: 100%;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

@media print {
  .jp-OutputArea-child {
    break-inside: avoid-page;
  }
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-OutputPrompt {
    display: table-row;
    text-align: left;
  }

  .jp-OutputArea-child .jp-OutputArea-output {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }
}

/* Trimmed outputs warning */
.jp-TrimmedOutputs > a {
  margin: 10px;
  text-decoration: none;
  cursor: pointer;
}

.jp-TrimmedOutputs > a:hover {
  text-decoration: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Table of Contents
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toc-active-width: 4px;
}

.jp-TableOfContents {
  display: flex;
  flex-direction: column;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  height: 100%;
}

.jp-TableOfContents-placeholder {
  text-align: center;
}

.jp-TableOfContents-placeholderContent {
  color: var(--jp-content-font-color2);
  padding: 8px;
}

.jp-TableOfContents-placeholderContent > h3 {
  margin-bottom: var(--jp-content-heading-margin-bottom);
}

.jp-TableOfContents .jp-SidePanel-content {
  overflow-y: auto;
}

.jp-TableOfContents-tree {
  margin: 4px;
}

.jp-TableOfContents ol {
  list-style-type: none;
}

/* stylelint-disable-next-line selector-max-type */
.jp-TableOfContents li > ol {
  /* Align left border with triangle icon center */
  padding-left: 11px;
}

.jp-TableOfContents-content {
  /* left margin for the active heading indicator */
  margin: 0 0 0 var(--jp-private-toc-active-width);
  padding: 0;
  background-color: var(--jp-layout-color1);
}

.jp-tocItem {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-tocItem-heading {
  display: flex;
  cursor: pointer;
}

.jp-tocItem-heading:hover {
  background-color: var(--jp-layout-color2);
}

.jp-tocItem-content {
  display: block;
  padding: 4px 0;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow-x: hidden;
}

.jp-tocItem-collapser {
  height: 20px;
  margin: 2px 2px 0;
  padding: 0;
  background: none;
  border: none;
  cursor: pointer;
}

.jp-tocItem-collapser:hover {
  background-color: var(--jp-layout-color3);
}

/* Active heading indicator */

.jp-tocItem-heading::before {
  content: ' ';
  background: transparent;
  width: var(--jp-private-toc-active-width);
  height: 24px;
  position: absolute;
  left: 0;
  border-radius: var(--jp-border-radius);
}

.jp-tocItem-heading.jp-tocItem-active::before {
  background-color: var(--jp-brand-color1);
}

.jp-tocItem-heading:hover.jp-tocItem-active::before {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapser {
  flex: 0 0 var(--jp-cell-collapser-width);
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
  border-radius: var(--jp-border-radius);
  opacity: 1;
}

.jp-Collapser-child {
  display: block;
  width: 100%;
  box-sizing: border-box;

  /* height: 100% doesn't work because the height of its parent is computed from content */
  position: absolute;
  top: 0;
  bottom: 0;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Hiding collapsers in print mode.

Note: input and output wrappers have "display: block" propery in print mode.
*/

@media print {
  .jp-Collapser {
    display: none;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Header/Footer
|----------------------------------------------------------------------------*/

/* Hidden by zero height by default */
.jp-CellHeader,
.jp-CellFooter {
  height: 0;
  width: 100%;
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Input
|----------------------------------------------------------------------------*/

/* All input areas */
.jp-InputArea {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-InputArea-editor {
  display: table-cell;
  overflow: hidden;
  vertical-align: top;

  /* This is the non-active, default styling */
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  background: var(--jp-cell-editor-background);
}

.jp-InputPrompt {
  display: table-cell;
  vertical-align: top;
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-inprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  opacity: var(--jp-cell-prompt-opacity);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-InputArea-editor {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }

  .jp-InputPrompt {
    display: table-row;
    text-align: left;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Placeholder {
  display: table;
  table-layout: fixed;
  width: 100%;
}

.jp-Placeholder-prompt {
  display: table-cell;
  box-sizing: border-box;
}

.jp-Placeholder-content {
  display: table-cell;
  padding: 4px 6px;
  border: 1px solid transparent;
  border-radius: 0;
  background: none;
  box-sizing: border-box;
  cursor: pointer;
}

.jp-Placeholder-contentContainer {
  display: flex;
}

.jp-Placeholder-content:hover,
.jp-InputPlaceholder > .jp-Placeholder-content:hover {
  border-color: var(--jp-layout-color3);
}

.jp-Placeholder-content .jp-MoreHorizIcon {
  width: 32px;
  height: 16px;
  border: 1px solid transparent;
  border-radius: var(--jp-border-radius);
}

.jp-Placeholder-content .jp-MoreHorizIcon:hover {
  border: 1px solid var(--jp-border-color1);
  box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.25);
  background-color: var(--jp-layout-color0);
}

.jp-PlaceholderText {
  white-space: nowrap;
  overflow-x: hidden;
  color: var(--jp-inverse-layout-color3);
  font-family: var(--jp-code-font-family);
}

.jp-InputPlaceholder > .jp-Placeholder-content {
  border-color: var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Private CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-cell-scrolling-output-offset: 5px;
}

/*-----------------------------------------------------------------------------
| Cell
|----------------------------------------------------------------------------*/

.jp-Cell {
  padding: var(--jp-cell-padding);
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Common input/output
|----------------------------------------------------------------------------*/

.jp-Cell-inputWrapper,
.jp-Cell-outputWrapper {
  display: flex;
  flex-direction: row;
  padding: 0;
  margin: 0;

  /* Added to reveal the box-shadow on the input and output collapsers. */
  overflow: visible;
}

/* Only input/output areas inside cells */
.jp-Cell-inputArea,
.jp-Cell-outputArea {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Collapser
|----------------------------------------------------------------------------*/

/* Make the output collapser disappear when there is not output, but do so
 * in a manner that leaves it in the layout and preserves its width.
 */
.jp-Cell.jp-mod-noOutputs .jp-Cell-outputCollapser {
  border: none !important;
  background: transparent !important;
}

.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputCollapser {
  min-height: var(--jp-cell-collapser-min-height);
}

/*-----------------------------------------------------------------------------
| Output
|----------------------------------------------------------------------------*/

/* Put a space between input and output when there IS output */
.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputWrapper {
  margin-top: 5px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea {
  overflow-y: auto;
  max-height: 24em;
  margin-left: var(--jp-private-cell-scrolling-output-offset);
  resize: vertical;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea[style*='height'] {
  max-height: unset;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea::after {
  content: ' ';
  box-shadow: inset 0 0 6px 2px rgb(0 0 0 / 30%);
  width: 100%;
  height: 100%;
  position: sticky;
  bottom: 0;
  top: 0;
  margin-top: -50%;
  float: left;
  display: block;
  pointer-events: none;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-child {
  padding-top: 6px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-prompt {
  width: calc(
    var(--jp-cell-prompt-width) - var(--jp-private-cell-scrolling-output-offset)
  );
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay {
  left: calc(-1 * var(--jp-private-cell-scrolling-output-offset));
}

/*-----------------------------------------------------------------------------
| CodeCell
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| MarkdownCell
|----------------------------------------------------------------------------*/

.jp-MarkdownOutput {
  display: table-cell;
  width: 100%;
  margin-top: 0;
  margin-bottom: 0;
  padding-left: var(--jp-code-padding);
}

.jp-MarkdownOutput.jp-RenderedHTMLCommon {
  overflow: auto;
}

/* collapseHeadingButton (show always if hiddenCellsButton is _not_ shown) */
.jp-collapseHeadingButton {
  display: flex;
  min-height: var(--jp-cell-collapser-min-height);
  font-size: var(--jp-code-font-size);
  position: absolute;
  background-color: transparent;
  background-size: 25px;
  background-repeat: no-repeat;
  background-position-x: center;
  background-position-y: top;
  background-image: var(--jp-icon-caret-down);
  right: 0;
  top: 0;
  bottom: 0;
}

.jp-collapseHeadingButton.jp-mod-collapsed {
  background-image: var(--jp-icon-caret-right);
}

/*
 set the container font size to match that of content
 so that the nested collapse buttons have the right size
*/
.jp-MarkdownCell .jp-InputPrompt {
  font-size: var(--jp-content-font-size1);
}

/*
  Align collapseHeadingButton with cell top header
  The font sizes are identical to the ones in packages/rendermime/style/base.css
*/
.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='1'] {
  font-size: var(--jp-content-font-size5);
  background-position-y: calc(0.3 * var(--jp-content-font-size5));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='2'] {
  font-size: var(--jp-content-font-size4);
  background-position-y: calc(0.3 * var(--jp-content-font-size4));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='3'] {
  font-size: var(--jp-content-font-size3);
  background-position-y: calc(0.3 * var(--jp-content-font-size3));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='4'] {
  font-size: var(--jp-content-font-size2);
  background-position-y: calc(0.3 * var(--jp-content-font-size2));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='5'] {
  font-size: var(--jp-content-font-size1);
  background-position-y: top;
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='6'] {
  font-size: var(--jp-content-font-size0);
  background-position-y: top;
}

/* collapseHeadingButton (show only on (hover,active) if hiddenCellsButton is shown) */
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-collapseHeadingButton {
  display: none;
}

.jp-Notebook.jp-mod-showHiddenCellsButton
  :is(.jp-MarkdownCell:hover, .jp-mod-active)
  .jp-collapseHeadingButton {
  display: flex;
}

/* showHiddenCellsButton (only show if jp-mod-showHiddenCellsButton is set, which
is a consequence of the showHiddenCellsButton option in Notebook Settings)*/
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton {
  margin-left: calc(var(--jp-cell-prompt-width) + 2 * var(--jp-code-padding));
  margin-top: var(--jp-code-padding);
  border: 1px solid var(--jp-border-color2);
  background-color: var(--jp-border-color3) !important;
  color: var(--jp-content-font-color0) !important;
  display: flex;
}

.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton:hover {
  background-color: var(--jp-border-color2) !important;
}

.jp-showHiddenCellsButton {
  display: none;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Using block instead of flex to allow the use of the break-inside CSS property for
cell outputs.
*/

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-notebook-toolbar-padding: 2px 5px 2px 2px;
}

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-NotebookPanel-toolbar {
  padding: var(--jp-notebook-toolbar-padding);

  /* disable paint containment from lumino 2.0 default strict CSS containment */
  contain: style size !important;
}

.jp-Toolbar-item.jp-Notebook-toolbarCellType .jp-select-wrapper.jp-mod-focused {
  border: none;
  box-shadow: none;
}

.jp-Notebook-toolbarCellTypeDropdown select {
  height: 24px;
  font-size: var(--jp-ui-font-size1);
  line-height: 14px;
  border-radius: 0;
  display: block;
}

.jp-Notebook-toolbarCellTypeDropdown span {
  top: 5px !important;
}

.jp-Toolbar-responsive-popup {
  position: absolute;
  height: fit-content;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-end;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: var(--jp-notebook-toolbar-padding);
  z-index: 1;
  right: 0;
  top: 0;
}

.jp-Toolbar > .jp-Toolbar-responsive-opener {
  margin-left: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-Notebook-ExecutionIndicator {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 9997;
}

.jp-Notebook-ExecutionIndicator-tooltip {
  visibility: hidden;
  height: auto;
  width: max-content;
  width: -moz-max-content;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color1);
  text-align: justify;
  border-radius: 6px;
  padding: 0 5px;
  position: fixed;
  display: table;
}

.jp-Notebook-ExecutionIndicator-tooltip.up {
  transform: translateX(-50%) translateY(-100%) translateY(-32px);
}

.jp-Notebook-ExecutionIndicator-tooltip.down {
  transform: translateX(calc(-100% + 16px)) translateY(5px);
}

.jp-Notebook-ExecutionIndicator-tooltip.hidden {
  display: none;
}

.jp-Notebook-ExecutionIndicator:hover .jp-Notebook-ExecutionIndicator-tooltip {
  visibility: visible;
}

.jp-Notebook-ExecutionIndicator span {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  color: var(--jp-ui-font-color1);
  line-height: 24px;
  display: block;
}

.jp-Notebook-ExecutionIndicator-progress-bar {
  display: flex;
  justify-content: center;
  height: 100%;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*
 * Execution indicator
 */
.jp-tocItem-content::after {
  content: '';

  /* Must be identical to form a circle */
  width: 12px;
  height: 12px;
  background: none;
  border: none;
  position: absolute;
  right: 0;
}

.jp-tocItem-content[data-running='0']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background: none;
}

.jp-tocItem-content[data-running='1']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background-color: var(--jp-inverse-layout-color3);
}

.jp-tocItem-content[data-running='0'],
.jp-tocItem-content[data-running='1'] {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Notebook-footer {
  height: 27px;
  margin-left: calc(
    var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
      var(--jp-cell-padding)
  );
  width: calc(
    100% -
      (
        var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
          var(--jp-cell-padding) + var(--jp-cell-padding)
      )
  );
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  color: var(--jp-ui-font-color3);
  margin-top: 6px;
  background: none;
  cursor: pointer;
}

.jp-Notebook-footer:focus {
  border-color: var(--jp-cell-editor-active-border-color);
}

/* For devices that support hovering, hide footer until hover */
@media (hover: hover) {
  .jp-Notebook-footer {
    opacity: 0;
  }

  .jp-Notebook-footer:focus,
  .jp-Notebook-footer:hover {
    opacity: 1;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Imports
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-side-by-side-output-size: 1fr;
  --jp-side-by-side-resized-cell: var(--jp-side-by-side-output-size);
  --jp-private-notebook-dragImage-width: 304px;
  --jp-private-notebook-dragImage-height: 36px;
  --jp-private-notebook-selected-color: var(--md-blue-400);
  --jp-private-notebook-active-color: var(--md-green-400);
}

/*-----------------------------------------------------------------------------
| Notebook
|----------------------------------------------------------------------------*/

/* stylelint-disable selector-max-class */

.jp-NotebookPanel {
  display: block;
  height: 100%;
}

.jp-NotebookPanel.jp-Document {
  min-width: 240px;
  min-height: 120px;
}

.jp-Notebook {
  padding: var(--jp-notebook-padding);
  outline: none;
  overflow: auto;
  background: var(--jp-layout-color0);
}

.jp-Notebook.jp-mod-scrollPastEnd::after {
  display: block;
  content: '';
  min-height: var(--jp-notebook-scroll-padding);
}

.jp-MainAreaWidget-ContainStrict .jp-Notebook * {
  contain: strict;
}

.jp-Notebook .jp-Cell {
  overflow: visible;
}

.jp-Notebook .jp-Cell .jp-InputPrompt {
  cursor: move;
}

/*-----------------------------------------------------------------------------
| Notebook state related styling
|
| The notebook and cells each have states, here are the possibilities:
|
| - Notebook
|   - Command
|   - Edit
| - Cell
|   - None
|   - Active (only one can be active)
|   - Selected (the cells actions are applied to)
|   - Multiselected (when multiple selected, the cursor)
|   - No outputs
|----------------------------------------------------------------------------*/

/* Command or edit modes */

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-InputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-OutputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

/* cell is active */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser {
  background: var(--jp-brand-color1);
}

/* cell is dirty */
.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt {
  color: var(--jp-warn-color1);
}

.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt::before {
  color: var(--jp-warn-color1);
  content: '•';
}

.jp-Notebook .jp-Cell.jp-mod-active.jp-mod-dirty .jp-Collapser {
  background: var(--jp-warn-color1);
}

/* collapser is hovered */
.jp-Notebook .jp-Cell .jp-Collapser:hover {
  box-shadow: var(--jp-elevation-z2);
  background: var(--jp-brand-color1);
  opacity: var(--jp-cell-collapser-not-active-hover-opacity);
}

/* cell is active and collapser is hovered */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser:hover {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/* Command mode */

.jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-selected {
  background: var(--jp-notebook-multiselected-color);
}

.jp-Notebook.jp-mod-commandMode
  .jp-Cell.jp-mod-active.jp-mod-selected:not(.jp-mod-multiSelected) {
  background: transparent;
}

/* Edit mode */

.jp-Notebook.jp-mod-editMode .jp-Cell.jp-mod-active .jp-InputArea-editor {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-cell-editor-active-background);
}

/*-----------------------------------------------------------------------------
| Notebook drag and drop
|----------------------------------------------------------------------------*/

.jp-Notebook-cell.jp-mod-dropSource {
  opacity: 0.5;
}

.jp-Notebook-cell.jp-mod-dropTarget,
.jp-Notebook.jp-mod-commandMode
  .jp-Notebook-cell.jp-mod-active.jp-mod-selected.jp-mod-dropTarget {
  border-top-color: var(--jp-private-notebook-selected-color);
  border-top-style: solid;
  border-top-width: 2px;
}

.jp-dragImage {
  display: block;
  flex-direction: row;
  width: var(--jp-private-notebook-dragImage-width);
  height: var(--jp-private-notebook-dragImage-height);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
  overflow: visible;
}

.jp-dragImage-singlePrompt {
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

.jp-dragImage .jp-dragImage-content {
  flex: 1 1 auto;
  z-index: 2;
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  line-height: var(--jp-code-line-height);
  padding: var(--jp-code-padding);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background-color);
  color: var(--jp-content-font-color3);
  text-align: left;
  margin: 4px 4px 4px 0;
}

.jp-dragImage .jp-dragImage-prompt {
  flex: 0 0 auto;
  min-width: 36px;
  color: var(--jp-cell-inprompt-font-color);
  padding: var(--jp-code-padding);
  padding-left: 12px;
  font-family: var(--jp-cell-prompt-font-family);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: 1.9;
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
}

.jp-dragImage-multipleBack {
  z-index: -1;
  position: absolute;
  height: 32px;
  width: 300px;
  top: 8px;
  left: 8px;
  background: var(--jp-layout-color2);
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

/*-----------------------------------------------------------------------------
| Cell toolbar
|----------------------------------------------------------------------------*/

.jp-NotebookTools {
  display: block;
  min-width: var(--jp-sidebar-min-width);
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
    * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  overflow: auto;
}

.jp-ActiveCellTool {
  padding: 12px 0;
  display: flex;
}

.jp-ActiveCellTool-Content {
  flex: 1 1 auto;
}

.jp-ActiveCellTool .jp-ActiveCellTool-CellContent {
  background: var(--jp-cell-editor-background);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  min-height: 29px;
}

.jp-ActiveCellTool .jp-InputPrompt {
  min-width: calc(var(--jp-cell-prompt-width) * 0.75);
}

.jp-ActiveCellTool-CellContent > pre {
  padding: 5px 4px;
  margin: 0;
  white-space: normal;
}

.jp-MetadataEditorTool {
  flex-direction: column;
  padding: 12px 0;
}

.jp-RankedPanel > :not(:first-child) {
  margin-top: 12px;
}

.jp-KeySelector select.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: var(--jp-border-width) solid var(--jp-border-color1);
}

.jp-KeySelector label,
.jp-MetadataEditorTool label,
.jp-NumberSetter label {
  line-height: 1.4;
}

.jp-NotebookTools .jp-select-wrapper {
  margin-top: 4px;
  margin-bottom: 0;
}

.jp-NumberSetter input {
  width: 100%;
  margin-top: 4px;
}

.jp-NotebookTools .jp-Collapse {
  margin-top: 16px;
}

/*-----------------------------------------------------------------------------
| Presentation Mode (.jp-mod-presentationMode)
|----------------------------------------------------------------------------*/

.jp-mod-presentationMode .jp-Notebook {
  --jp-content-font-size1: var(--jp-content-presentation-font-size1);
  --jp-code-font-size: var(--jp-code-presentation-font-size);
}

.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-InputPrompt,
.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-OutputPrompt {
  flex: 0 0 110px;
}

/*-----------------------------------------------------------------------------
| Side-by-side Mode (.jp-mod-sideBySide)
|----------------------------------------------------------------------------*/
.jp-mod-sideBySide.jp-Notebook .jp-Notebook-cell {
  margin-top: 3em;
  margin-bottom: 3em;
  margin-left: 5%;
  margin-right: 5%;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell {
  display: grid;
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-output-size)
    );
  grid-template-rows: auto minmax(0, 1fr) auto;
  grid-template-areas:
    'header header header'
    'input handle output'
    'footer footer footer';
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell {
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-resized-cell)
    );
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellHeader {
  grid-area: header;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-inputWrapper {
  grid-area: input;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-outputWrapper {
  /* overwrite the default margin (no vertical separation needed in side by side move */
  margin-top: 0;
  grid-area: output;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellFooter {
  grid-area: footer;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle {
  grid-area: handle;
  user-select: none;
  display: block;
  height: 100%;
  cursor: ew-resize;
  padding: 0 var(--jp-cell-padding);
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle::after {
  content: '';
  display: block;
  background: var(--jp-border-color2);
  height: 100%;
  width: 5px;
}

.jp-mod-sideBySide.jp-Notebook
  .jp-CodeCell.jp-mod-resizedCell
  .jp-CellResizeHandle::after {
  background: var(--jp-border-color0);
}

.jp-CellResizeHandle {
  display: none;
}

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Cell-Placeholder {
  padding-left: 55px;
}

.jp-Cell-Placeholder-wrapper {
  background: #fff;
  border: 1px solid;
  border-color: #e5e6e9 #dfe0e4 #d0d1d5;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  margin: 10px 15px;
}

.jp-Cell-Placeholder-wrapper-inner {
  padding: 15px;
  position: relative;
}

.jp-Cell-Placeholder-wrapper-body {
  background-repeat: repeat;
  background-size: 50% auto;
}

.jp-Cell-Placeholder-wrapper-body div {
  background: #f6f7f8;
  background-image: -webkit-linear-gradient(
    left,
    #f6f7f8 0%,
    #edeef1 20%,
    #f6f7f8 40%,
    #f6f7f8 100%
  );
  background-repeat: no-repeat;
  background-size: 800px 104px;
  height: 104px;
  position: absolute;
  right: 15px;
  left: 15px;
  top: 15px;
}

div.jp-Cell-Placeholder-h1 {
  top: 20px;
  height: 20px;
  left: 15px;
  width: 150px;
}

div.jp-Cell-Placeholder-h2 {
  left: 15px;
  top: 50px;
  height: 10px;
  width: 100px;
}

div.jp-Cell-Placeholder-content-1,
div.jp-Cell-Placeholder-content-2,
div.jp-Cell-Placeholder-content-3 {
  left: 15px;
  right: 15px;
  height: 10px;
}

div.jp-Cell-Placeholder-content-1 {
  top: 100px;
}

div.jp-Cell-Placeholder-content-2 {
  top: 120px;
}

div.jp-Cell-Placeholder-content-3 {
  top: 140px;
}

</style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/

:root {
  /* Elevation
   *
   * We style box-shadows using Material Design's idea of elevation. These particular numbers are taken from here:
   *
   * https://github.com/material-components/material-components-web
   * https://material-components-web.appspot.com/elevation.html
   */

  --jp-shadow-base-lightness: 0;
  --jp-shadow-umbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.2
  );
  --jp-shadow-penumbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.14
  );
  --jp-shadow-ambient-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.12
  );
  --jp-elevation-z0: none;
  --jp-elevation-z1: 0 2px 1px -1px var(--jp-shadow-umbra-color),
    0 1px 1px 0 var(--jp-shadow-penumbra-color),
    0 1px 3px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z2: 0 3px 1px -2px var(--jp-shadow-umbra-color),
    0 2px 2px 0 var(--jp-shadow-penumbra-color),
    0 1px 5px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z4: 0 2px 4px -1px var(--jp-shadow-umbra-color),
    0 4px 5px 0 var(--jp-shadow-penumbra-color),
    0 1px 10px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z6: 0 3px 5px -1px var(--jp-shadow-umbra-color),
    0 6px 10px 0 var(--jp-shadow-penumbra-color),
    0 1px 18px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z8: 0 5px 5px -3px var(--jp-shadow-umbra-color),
    0 8px 10px 1px var(--jp-shadow-penumbra-color),
    0 3px 14px 2px var(--jp-shadow-ambient-color);
  --jp-elevation-z12: 0 7px 8px -4px var(--jp-shadow-umbra-color),
    0 12px 17px 2px var(--jp-shadow-penumbra-color),
    0 5px 22px 4px var(--jp-shadow-ambient-color);
  --jp-elevation-z16: 0 8px 10px -5px var(--jp-shadow-umbra-color),
    0 16px 24px 2px var(--jp-shadow-penumbra-color),
    0 6px 30px 5px var(--jp-shadow-ambient-color);
  --jp-elevation-z20: 0 10px 13px -6px var(--jp-shadow-umbra-color),
    0 20px 31px 3px var(--jp-shadow-penumbra-color),
    0 8px 38px 7px var(--jp-shadow-ambient-color);
  --jp-elevation-z24: 0 11px 15px -7px var(--jp-shadow-umbra-color),
    0 24px 38px 3px var(--jp-shadow-penumbra-color),
    0 9px 46px 8px var(--jp-shadow-ambient-color);

  /* Borders
   *
   * The following variables, specify the visual styling of borders in JupyterLab.
   */

  --jp-border-width: 1px;
  --jp-border-color0: var(--md-grey-400);
  --jp-border-color1: var(--md-grey-400);
  --jp-border-color2: var(--md-grey-300);
  --jp-border-color3: var(--md-grey-200);
  --jp-inverse-border-color: var(--md-grey-600);
  --jp-border-radius: 2px;

  /* UI Fonts
   *
   * The UI font CSS variables are used for the typography all of the JupyterLab
   * user interface elements that are not directly user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-ui-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: 0.83333em;
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: 1.2em;
  --jp-ui-font-size3: 1.44em;
  --jp-ui-font-family: system-ui, -apple-system, blinkmacsystemfont, 'Segoe UI',
    helvetica, arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
    'Segoe UI Symbol';

  /*
   * Use these font colors against the corresponding main layout colors.
   * In a light theme, these go from dark to light.
   */

  /* Defaults use Material Design specification */
  --jp-ui-font-color0: rgba(0, 0, 0, 1);
  --jp-ui-font-color1: rgba(0, 0, 0, 0.87);
  --jp-ui-font-color2: rgba(0, 0, 0, 0.54);
  --jp-ui-font-color3: rgba(0, 0, 0, 0.38);

  /*
   * Use these against the brand/accent/warn/error colors.
   * These will typically go from light to darker, in both a dark and light theme.
   */

  --jp-ui-inverse-font-color0: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color1: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color2: rgba(255, 255, 255, 0.7);
  --jp-ui-inverse-font-color3: rgba(255, 255, 255, 0.5);

  /* Content Fonts
   *
   * Content font variables are used for typography of user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-content-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-content-line-height: 1.6;
  --jp-content-font-scale-factor: 1.2;
  --jp-content-font-size0: 0.83333em;
  --jp-content-font-size1: 14px; /* Base font size */
  --jp-content-font-size2: 1.2em;
  --jp-content-font-size3: 1.44em;
  --jp-content-font-size4: 1.728em;
  --jp-content-font-size5: 2.0736em;

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-content-presentation-font-size1: 17px;
  --jp-content-heading-line-height: 1;
  --jp-content-heading-margin-top: 1.2em;
  --jp-content-heading-margin-bottom: 0.8em;
  --jp-content-heading-font-weight: 500;

  /* Defaults use Material Design specification */
  --jp-content-font-color0: rgba(0, 0, 0, 1);
  --jp-content-font-color1: rgba(0, 0, 0, 0.87);
  --jp-content-font-color2: rgba(0, 0, 0, 0.54);
  --jp-content-font-color3: rgba(0, 0, 0, 0.38);
  --jp-content-link-color: var(--md-blue-900);
  --jp-content-font-family: system-ui, -apple-system, blinkmacsystemfont,
    'Segoe UI', helvetica, arial, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol';

  /*
   * Code Fonts
   *
   * Code font variables are used for typography of code and other monospaces content.
   */

  --jp-code-font-size: 13px;
  --jp-code-line-height: 1.3077; /* 17px for 13px base */
  --jp-code-padding: 5px; /* 5px for 13px base, codemirror highlighting needs integer px value */
  --jp-code-font-family-default: menlo, consolas, 'DejaVu Sans Mono', monospace;
  --jp-code-font-family: var(--jp-code-font-family-default);

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-code-presentation-font-size: 16px;

  /* may need to tweak cursor width if you change font size */
  --jp-code-cursor-width0: 1.4px;
  --jp-code-cursor-width1: 2px;
  --jp-code-cursor-width2: 4px;

  /* Layout
   *
   * The following are the main layout colors use in JupyterLab. In a light
   * theme these would go from light to dark.
   */

  --jp-layout-color0: white;
  --jp-layout-color1: white;
  --jp-layout-color2: var(--md-grey-200);
  --jp-layout-color3: var(--md-grey-400);
  --jp-layout-color4: var(--md-grey-600);

  /* Inverse Layout
   *
   * The following are the inverse layout colors use in JupyterLab. In a light
   * theme these would go from dark to light.
   */

  --jp-inverse-layout-color0: #111;
  --jp-inverse-layout-color1: var(--md-grey-900);
  --jp-inverse-layout-color2: var(--md-grey-800);
  --jp-inverse-layout-color3: var(--md-grey-700);
  --jp-inverse-layout-color4: var(--md-grey-600);

  /* Brand/accent */

  --jp-brand-color0: var(--md-blue-900);
  --jp-brand-color1: var(--md-blue-700);
  --jp-brand-color2: var(--md-blue-300);
  --jp-brand-color3: var(--md-blue-100);
  --jp-brand-color4: var(--md-blue-50);
  --jp-accent-color0: var(--md-green-900);
  --jp-accent-color1: var(--md-green-700);
  --jp-accent-color2: var(--md-green-300);
  --jp-accent-color3: var(--md-green-100);

  /* State colors (warn, error, success, info) */

  --jp-warn-color0: var(--md-orange-900);
  --jp-warn-color1: var(--md-orange-700);
  --jp-warn-color2: var(--md-orange-300);
  --jp-warn-color3: var(--md-orange-100);
  --jp-error-color0: var(--md-red-900);
  --jp-error-color1: var(--md-red-700);
  --jp-error-color2: var(--md-red-300);
  --jp-error-color3: var(--md-red-100);
  --jp-success-color0: var(--md-green-900);
  --jp-success-color1: var(--md-green-700);
  --jp-success-color2: var(--md-green-300);
  --jp-success-color3: var(--md-green-100);
  --jp-info-color0: var(--md-cyan-900);
  --jp-info-color1: var(--md-cyan-700);
  --jp-info-color2: var(--md-cyan-300);
  --jp-info-color3: var(--md-cyan-100);

  /* Cell specific styles */

  --jp-cell-padding: 5px;
  --jp-cell-collapser-width: 8px;
  --jp-cell-collapser-min-height: 20px;
  --jp-cell-collapser-not-active-hover-opacity: 0.6;
  --jp-cell-editor-background: var(--md-grey-100);
  --jp-cell-editor-border-color: var(--md-grey-300);
  --jp-cell-editor-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-cell-editor-active-background: var(--jp-layout-color0);
  --jp-cell-editor-active-border-color: var(--jp-brand-color1);
  --jp-cell-prompt-width: 64px;
  --jp-cell-prompt-font-family: var(--jp-code-font-family-default);
  --jp-cell-prompt-letter-spacing: 0;
  --jp-cell-prompt-opacity: 1;
  --jp-cell-prompt-not-active-opacity: 0.5;
  --jp-cell-prompt-not-active-font-color: var(--md-grey-700);

  /* A custom blend of MD grey and blue 600
   * See https://meyerweb.com/eric/tools/color-blend/#546E7A:1E88E5:5:hex */
  --jp-cell-inprompt-font-color: #307fc1;

  /* A custom blend of MD grey and orange 600
   * https://meyerweb.com/eric/tools/color-blend/#546E7A:F4511E:5:hex */
  --jp-cell-outprompt-font-color: #bf5b3d;

  /* Notebook specific styles */

  --jp-notebook-padding: 10px;
  --jp-notebook-select-background: var(--jp-layout-color1);
  --jp-notebook-multiselected-color: var(--md-blue-50);

  /* The scroll padding is calculated to fill enough space at the bottom of the
  notebook to show one single-line cell (with appropriate padding) at the top
  when the notebook is scrolled all the way to the bottom. We also subtract one
  pixel so that no scrollbar appears if we have just one single-line cell in the
  notebook. This padding is to enable a 'scroll past end' feature in a notebook.
  */
  --jp-notebook-scroll-padding: calc(
    100% - var(--jp-code-font-size) * var(--jp-code-line-height) -
      var(--jp-code-padding) - var(--jp-cell-padding) - 1px
  );

  /* Rendermime styles */

  --jp-rendermime-error-background: #fdd;
  --jp-rendermime-table-row-background: var(--md-grey-100);
  --jp-rendermime-table-row-hover-background: var(--md-light-blue-50);

  /* Dialog specific styles */

  --jp-dialog-background: rgba(0, 0, 0, 0.25);

  /* Console specific styles */

  --jp-console-padding: 10px;

  /* Toolbar specific styles */

  --jp-toolbar-border-color: var(--jp-border-color1);
  --jp-toolbar-micro-height: 8px;
  --jp-toolbar-background: var(--jp-layout-color1);
  --jp-toolbar-box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.24);
  --jp-toolbar-header-margin: 4px 4px 0 4px;
  --jp-toolbar-active-background: var(--md-grey-300);

  /* Statusbar specific styles */

  --jp-statusbar-height: 24px;

  /* Input field styles */

  --jp-input-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-input-active-background: var(--jp-layout-color1);
  --jp-input-hover-background: var(--jp-layout-color1);
  --jp-input-background: var(--md-grey-100);
  --jp-input-border-color: var(--jp-inverse-border-color);
  --jp-input-active-border-color: var(--jp-brand-color1);
  --jp-input-active-box-shadow-color: rgba(19, 124, 189, 0.3);

  /* General editor styles */

  --jp-editor-selected-background: #d9d9d9;
  --jp-editor-selected-focused-background: #d7d4f0;
  --jp-editor-cursor-color: var(--jp-ui-font-color0);

  /* Code mirror specific styles */

  --jp-mirror-editor-keyword-color: #008000;
  --jp-mirror-editor-atom-color: #88f;
  --jp-mirror-editor-number-color: #080;
  --jp-mirror-editor-def-color: #00f;
  --jp-mirror-editor-variable-color: var(--md-grey-900);
  --jp-mirror-editor-variable-2-color: rgb(0, 54, 109);
  --jp-mirror-editor-variable-3-color: #085;
  --jp-mirror-editor-punctuation-color: #05a;
  --jp-mirror-editor-property-color: #05a;
  --jp-mirror-editor-operator-color: #a2f;
  --jp-mirror-editor-comment-color: #408080;
  --jp-mirror-editor-string-color: #ba2121;
  --jp-mirror-editor-string-2-color: #708;
  --jp-mirror-editor-meta-color: #a2f;
  --jp-mirror-editor-qualifier-color: #555;
  --jp-mirror-editor-builtin-color: #008000;
  --jp-mirror-editor-bracket-color: #997;
  --jp-mirror-editor-tag-color: #170;
  --jp-mirror-editor-attribute-color: #00c;
  --jp-mirror-editor-header-color: blue;
  --jp-mirror-editor-quote-color: #090;
  --jp-mirror-editor-link-color: #00c;
  --jp-mirror-editor-error-color: #f00;
  --jp-mirror-editor-hr-color: #999;

  /*
    RTC user specific colors.
    These colors are used for the cursor, username in the editor,
    and the icon of the user.
  */

  --jp-collaborator-color1: #ffad8e;
  --jp-collaborator-color2: #dac83d;
  --jp-collaborator-color3: #72dd76;
  --jp-collaborator-color4: #00e4d0;
  --jp-collaborator-color5: #45d4ff;
  --jp-collaborator-color6: #e2b1ff;
  --jp-collaborator-color7: #ff9de6;

  /* Vega extension styles */

  --jp-vega-background: white;

  /* Sidebar-related styles */

  --jp-sidebar-min-width: 250px;

  /* Search-related styles */

  --jp-search-toggle-off-opacity: 0.5;
  --jp-search-toggle-hover-opacity: 0.8;
  --jp-search-toggle-on-opacity: 1;
  --jp-search-selected-match-background-color: rgb(245, 200, 0);
  --jp-search-selected-match-color: black;
  --jp-search-unselected-match-background-color: var(
    --jp-inverse-layout-color0
  );
  --jp-search-unselected-match-color: var(--jp-ui-inverse-font-color0);

  /* Icon colors that work well with light or dark backgrounds */
  --jp-icon-contrast-color0: var(--md-purple-600);
  --jp-icon-contrast-color1: var(--md-green-600);
  --jp-icon-contrast-color2: var(--md-pink-600);
  --jp-icon-contrast-color3: var(--md-blue-600);

  /* Button colors */
  --jp-accept-color-normal: var(--md-blue-700);
  --jp-accept-color-hover: var(--md-blue-800);
  --jp-accept-color-active: var(--md-blue-900);
  --jp-warn-color-normal: var(--md-red-700);
  --jp-warn-color-hover: var(--md-red-800);
  --jp-warn-color-active: var(--md-red-900);
  --jp-reject-color-normal: var(--md-grey-600);
  --jp-reject-color-hover: var(--md-grey-700);
  --jp-reject-color-active: var(--md-grey-800);

  /* File or activity icons and switch semantic variables */
  --jp-jupyter-icon-color: #f37626;
  --jp-notebook-icon-color: #f37626;
  --jp-json-icon-color: var(--md-orange-700);
  --jp-console-icon-background-color: var(--md-blue-700);
  --jp-console-icon-color: white;
  --jp-terminal-icon-background-color: var(--md-grey-800);
  --jp-terminal-icon-color: var(--md-grey-200);
  --jp-text-editor-icon-color: var(--md-grey-700);
  --jp-inspector-icon-color: var(--md-grey-700);
  --jp-switch-color: var(--md-grey-400);
  --jp-switch-true-position-color: var(--md-orange-900);
}
</style>
<style type="text/css">
/* Force rendering true colors when outputing to pdf */
* {
  -webkit-print-color-adjust: exact;
}

/* Misc */
a.anchor-link {
  display: none;
}

/* Input area styling */
.jp-InputArea {
  overflow: hidden;
}

.jp-InputArea-editor {
  overflow: hidden;
}

.cm-editor.cm-s-jupyter .highlight pre {
/* weird, but --jp-code-padding defined to be 5px but 4px horizontal padding is hardcoded for pre.cm-line */
  padding: var(--jp-code-padding) 4px;
  margin: 0;

  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  color: inherit;

}

.jp-OutputArea-output pre {
  line-height: inherit;
  font-family: inherit;
}

.jp-RenderedText pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
}

/* Hiding the collapser by default */
.jp-Collapser {
  display: none;
}

@page {
    margin: 0.5in; /* Margin for each printed piece of paper */
}

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}
</style>
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration --><script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>
<style>
  .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details > pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary > pre {
    display: inline-block;
    white-space: normal;
  }
</style>
<!-- End of mermaid configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8c9eaaab-58a0-4981-ad8a-ccd10f74430a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: center; color: navy; font-weight: bold; font-size: 56px;">
    Jal Jeevan Mission - Drinking Water Quality Data Analysis
</div>
<div style="text-align: center; color: navy; font-weight: bold; font-size: 48px;">
    India - 2009 - 2024 (NRDWP &amp; JJM)
</div>
<div style="border-bottom: 3px solid #2a6496; font-size: 25px; line-height: 1.8; margin-bottom: 20px;">
<h2 style="color: #000000; text-align: center; ">Nishant<br/><br/>Internship under Dr. Aditya Shrinivas<br/>Indian Institute of Management, IIM Bangalore</h2>
</div>
<div style="border-bottom: 3px solid #2a6496; font-size: 28px; line-height: 1.8;">
Organized and documented all projects and tasks completed during the internship from May 1, 2024, to May 31, 2025. This Jupyter notebook includes compilation of all code step by step, data, project outputs, and results into a systematic, clear, and well-detailed format with thorough explanations.
<p><br/>Contact for query<br/>9306145426<br/>nishant0363@gmail.com</p>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=7b1034b1-8496-4815-bd2c-8fae4532ff2b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 28px; line-height: 1.8;">
<p>The <b>Drinking Water Quality lab testing data</b> has been officially obtained through <b>Government of India - Jal Jeevan Mission Portal</b>. The data consists of lab testing results from over <b>1.6 Million habitations</b> all across India over a temporal resolution of <b>2009 to 2024</b>. Data for the year <b>2020 is unavailable due to the COVID-19 epidemic</b>. The water quality lab-tested data shows the quantity of pollutants such as <b>Fluoride, Nitrate, Chloride, Sulphates, Iron, Arsenic, E.Coli</b>, and more bacterial and chemical pollutants tested in the water samples collected from <b>Drinking Water Sources</b> of Villages and Habitations. The data is yearly available across India, but it does not ensure that each habitation has data for all the years. Many habitations report each year, while some habitations have only a few years of Water Quality tested data. The temporal resolution of Water Quality data is at the <b>Month</b> and <b>Year</b> level.</p>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a000d328-2487-4bab-aad4-8a49008c6a8c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 40px; line-height: 2; font-family: Arial, sans-serif; padding: 20px;">
<!-- Section: Table of Contents -->
<div style="border-bottom: 3px solid #2a6496; margin-bottom: 20px;">
<h2 style="color: #2a6496; text-align: center; font-weight: bold;">Contents</h2>
</div>
<ul style="list-style-type: circle; margin-left: 40px; font-size: 22px;">
<!-- Overview -->
<li><a href="#overview-drinking-water">Overview of Drinking Water Quality Data (2009–2024)</a></li>
<!-- Data Sources -->
<li>Data Sources
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#data-nrdwp">2009–2019: NRDWP Website</a></li>
<li><a href="#data-jjm">2019–2024: JJM API</a></li>
</ul>
</li>
<!-- Preprocessing JJM Data -->
<li>Preprocessing JJM API Data
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#jjm-api-extraction">API Data Extraction</a></li>
<li><a href="#jjm-cleaning">Pollutant Mapping and Cleaning</a></li>
<li><a href="#jjm-aggregation">Village-Level Aggregation</a></li>
</ul>
</li>
<!-- NRDWP Data Preprocessing -->
<li>Scraping and Preprocessing NRDWP Data
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#nrdwp-scraping">Selenium Automation for Scraping</a></li>
<li><a href="#nrdwp-conversion">Data Conversion and Formatting</a></li>
<li><a href="#nrdwp-merging">Merging with Habitation-Level Master Data</a></li>
<li><a href="#nrdwp-fuzzy">Fuzzy Matching</a></li>
<li><a href="#nrdwp-parsing">Parsing Downloaded XLS using BeautifulSoup</a></li>
<li><a href="#nrdwp-final">Preprocessing of the Converted NRDWP Data</a></li>
<li><a href="#nrdwp-format-diff">Handling Format Differences with JJM</a></li>
<li><a href="#extract-pollutants">Extracting Pollutant Values (with Units)</a></li>
<li><a href="#remove-units">Removing Units from Pollutant Columns</a></li>
<li><a href="#save-nrdwp-restart">Saving Preprocessed NRDWP Data and Restarting Kernel</a></li>
</ul>
</li>
<!-- Mapping Village ID -->
<li>Mapping Village ID in NRDWP Data as NRDWP Dataset only has Habitation ID
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#village-id-issue">Handling Missing Village IDs in NRDWP Data</a></li>
<li><a href="#habitation-cleaning">Cleaning Habitation IDs to Numeric Format</a></li>
<li><a href="#b1-mapping-read">Reading B1 Habitation Data for Mapping</a></li>
<li><a href="#master-mapping-read">Reading Habitation Master Mapping</a></li>
<li><a href="#concat-mappings">Concatenating Mapping Files</a></li>
<li><a href="#merge-nrdwp-villageid">Merging NRDWP with Village ID Mapping</a></li>
<li><a href="#segregate-matched-unmatched">Segregating Matched and Unmatched Habitations</a></li>
<li><a href="#merge-statewise">Re-merging Statewise Matched NRDWP Data</a></li>
<li><a href="#nrdwp-aggregation">Aggregating NRDWP Data to Village Level</a></li>
</ul>
</li>
<!-- Combining NRDWP and JJM -->
<li>Combining only Matched NRDWP data and JJM Datasets. (Unmatched NRDWP data is processed using Fuzzy Matching in further section)
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#concatenate-datasets">Concatenating Cleaned NRDWP and JJM Data</a></li>
<li><a href="#state-district-info">Merging State and District Info from Master Data</a></li>
<li><a href="#unmatched-fuzzy-note">Note on Appending Fuzzy-Matched NRDWP Data Later</a></li>
</ul>
</li>
<!-- Building Master Village Mapping -->
<li>To add Census Details in the combined data, Building Master Village ID Mapping
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#masterdata-issue">Why a Single Master Data is Insufficient</a></li>
<li><a href="#start-b1">Starting with B1 Habitation Data</a></li>
<li><a href="#drop-duplicate-care">Handling Duplicates with Incomplete Data</a></li>
<li><a href="#add-mdvl">Adding Mappings from Master Village-Level Data</a></li>
<li><a href="#concat-hab-mdvl">Concatenating Final Hab_Vill_ID Mapping</a></li>
</ul>
</li>
<!-- Addressing Missing Data in Village ID Mapping -->
<li>Addressing Missing Data in Village ID Mapping
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#missing-data-intuition">Intuition for Filling Missing State and District IDs</a></li>
<li><a href="#census-code-mapping">Leveraging Census Codes for Mapping</a></li>
<li><a href="#missing-census-ids">Identifying Rows with Missing Census IDs</a></li>
<li><a href="#update-census-ids">Updating Missing Census State and District IDs</a></li>
<li><a href="#merge-filled-subset">Merging Back the Filled Subset</a></li>
<li><a href="#careful-duplicate-dropping">Careful Duplicate Handling</a></li>
<li><a href="#district-grouping-fill">Group by Census District for Final Filling</a></li>
</ul>
</li>
<!-- Finalizing Village ID Mapping -->
<li>Finalizing Village ID Mapping and Using in the merged NRDWP-JJM Dataset
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#remove-nan-census">Removing NaN Census Columns</a></li>
<li><a href="#filling-district-state-ids">Filling District and State IDs</a></li>
<li><a href="#standardize-state-names">Standardizing State Names</a></li>
<li><a href="#enriching-water-quality">Enriching Water Quality Data with Mapping</a></li>
</ul>
</li>
<!-- Fuzzy Matching Unmatched NRDWP Data -->
<li>Fuzzy Matching the Unmatched NRDWP Data and  merging it back with preprocessed NRDWP - JJM Data
            <ul style="list-style-type: square; margin-left: 40px;">
<li><a href="#unmatched-data-preprocessing">Preprocessing Unmatched NRDWP Data</a></li>
<li><a href="#consolidating-datasets">Consolidating B1 and NRDWP B1 Datasets</a></li>
<li><a href="#creating-composite-identifier">Creating B1Village Composite Identifier</a></li>
<li><a href="#state-name-standardization">State Name Standardization</a></li>
<li><a href="#fuzzy-string-matching">Fuzzy String Matching Implementation</a></li>
<li><a href="#integrating-fuzzy-matched">Integrating Fuzzy-Matched Identifiers</a></li>
<li><a href="#final-merge-unmatched">Final Merge of Unmatched Records</a></li>
<li><a href="#final-preprocessing-steps">Final Preprocessing Steps</a></li>
<li><a href="#completed-dataset"><b>Completed JJM-NRDWP Dataset with Correct IDs</b></a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d1220c45-4d34-4809-9db7-39040ccf4050">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="overview-drinking-water"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
<p>The <b>Jal Jeevan Mission</b>, prior to its initiation in <b>2019</b>, was known as the <b>National Rural Drinking Water Programme (NRDWP)</b>.<br>
Therefore, the Drinking Water Quality data is obtained from two sources:</br></p>
<ul>
<li>The Water Quality data for the years <b>2009 to 2019</b> is obtained from the <b>NRDWP website</b>.</li>
<li>The data for the years <b>2019 onwards till 2024</b> is obtained from the <b>Jal Jeevan Mission website</b> through API requests.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=721ad47d-7dbb-4be7-89c1-1e4f1489d64b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="data-jjm"></a></p>
<center>
<img alt="NRDWP Image" src="Images/NRDWP.png" style="width: 100%; max-width: 1750px; height: auto;"/>
</center>
<div style="text-align: center;font-size: 18px; line-height: 1.8;">
<b>NRDWP Website - Format E3- Habitation wise laboratory testing</b>
</div>


<br>
</br></div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c9ae8bba-2d20-47e5-b194-11100e69db51">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="data-nrdwp"></a></p>
<center>
<img alt="JJM" src="Images/JJM.png" style="width: 100%; max-width: 1750px; height: auto;"/>
</center>
<div style="text-align: center;font-size: 18px; line-height: 1.8;">
<b>JJM Website - Format L2- Habitation wise laboratory testing data</b>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=28287b89-8439-4114-ae04-ad04748cc12d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=97815736-27c8-494b-82f4-0dab7c95970a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=8858c517-ad6d-4d49-b83d-d43cb7208bd6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c0b188eb-6587-45e5-beb5-e0b18b5f48eb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Reading and Preprocessing 2021 - 2024 JJM - Jal Jeevan Mission - 
    Water Quality API Data
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=91c83494-17f3-4a63-8a57-014beb3fba56">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="jjm-api-extraction"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>The <b>API extracted data</b> is in a folder named <code>JJM API Data/All_chunk_csv</code>. This folder contains the API extracted data.</p>
<p>As the API allows only a certain amount of data to be extracted in each call, there are individual subsets of the complete <b>JJM Water Quality Data</b> in the form of chunks. These chunks are read in <b>Python Pandas</b> as a DataFrame and concatenated into a single DataFrame for further preprocessing.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=063fef98-82ec-4586-8812-857d47a1c069">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="c1"># Function for Concatenating All chunks</span>
<span class="k">def</span> <span class="nf">concatenate_csv_files</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">csv_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">)]</span>    
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">csv_files</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  
    <span class="n">combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combined_df</span>

<span class="c1"># Calling the Conatenate_csv_files function on folder with all API Chunks data</span>
<span class="n">folder_path</span> <span class="o">=</span> <span class="s2">"JJM API Data/All_chunk_csv"</span>
<span class="n">JJM_df</span> <span class="o">=</span> <span class="n">concatenate_csv_files</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">JJM_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Stateid</th>
<th>VillageID</th>
<th>TestId</th>
<th>SampleId</th>
<th>Test_date</th>
<th>Location</th>
<th>is_safe</th>
<th>lab_id</th>
<th>SourceId</th>
<th>Source_type</th>
<th>...</th>
<th>parameter_98</th>
<th>parameter_46</th>
<th>parameter_94</th>
<th>parameter_47</th>
<th>parameter_59</th>
<th>parameter_53</th>
<th>parameter_50</th>
<th>parameter_51</th>
<th>parameter_52</th>
<th>parameter_88</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>13</td>
<td>125040</td>
<td>21048315</td>
<td>U698087S21048315</td>
<td>2024-06-09T13:23:00</td>
<td>Tap Nr HO Neelam Kumari</td>
<td>Yes</td>
<td>219</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>13</td>
<td>125040</td>
<td>2533919</td>
<td>U6524L219S4436702</td>
<td>2022-03-25T18:17:23</td>
<td>not available</td>
<td>Yes</td>
<td>219</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>13</td>
<td>125040</td>
<td>13998254</td>
<td>U720360S13998254</td>
<td>2023-07-24T13:09:00</td>
<td>ram lal</td>
<td>Yes</td>
<td>219</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>13</td>
<td>125040</td>
<td>3591095</td>
<td>U6524L219S5666975</td>
<td>2022-05-20T12:58:46</td>
<td>not available</td>
<td>Yes</td>
<td>219</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>13</td>
<td>125040</td>
<td>3548198</td>
<td>U6524L219S5666958</td>
<td>2022-05-20T12:58:40</td>
<td>not available</td>
<td>Yes</td>
<td>219</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>21725994</th>
<td>2</td>
<td>598064</td>
<td>5367823</td>
<td>U5618L742S433049</td>
<td>2021-07-27T07:41:18</td>
<td>DIGUVAMEDANGI</td>
<td>Yes</td>
<td>742</td>
<td>0</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>21725995</th>
<td>2</td>
<td>598064</td>
<td>19912831</td>
<td>U2184729S19912831</td>
<td>2024-05-03T14:10:00</td>
<td>Location : ST LOCALITY  [ Source type : Deep T...</td>
<td>Yes</td>
<td>742</td>
<td>120032247</td>
<td>Water supply scheme sources</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>21725996</th>
<td>2</td>
<td>598064</td>
<td>12843789</td>
<td>U698047S12843789</td>
<td>2023-06-16T17:25:00</td>
<td>Location : In Village  [ Source type : Deep Tu...</td>
<td>Yes</td>
<td>742</td>
<td>440296114</td>
<td>Water supply scheme sources</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>21725997</th>
<td>2</td>
<td>598064</td>
<td>12843073</td>
<td>U698047S12843073</td>
<td>2023-06-16T14:00:00</td>
<td>Location : ST LOCALITY@SO001  [ Source type : ...</td>
<td>Yes</td>
<td>742</td>
<td>2138037</td>
<td>Water supply scheme sources</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>21725998</th>
<td>2</td>
<td>598064</td>
<td>12660414</td>
<td>U698047S12660414</td>
<td>2023-04-21T14:45:00</td>
<td>School Name :  MPPS [schemeId : 6089069, schem...</td>
<td>Yes</td>
<td>742</td>
<td>647019</td>
<td>Delivery points</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>21725999 rows × 79 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=1e5fd7c6-790b-4b34-b4ac-285342d83107">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=07e84866-43d0-4d27-8347-18ad9de12428">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Pollutant Mapping and Cleaning
</div>
<p><a id="jjm-cleaning"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>To clean the extracted API data, we select only the required columns: <code>['Stateid', 'VillageID', 'TestId', 'SampleId', 'Test_date', 'Source_type', 'Source_subtype']</code>, and the required pollutants columns. In this data, the pollutants are encoded as the <b>Parameter_ID</b> column. For example: 
<code>{'parameter_10': 'Chloride', 'parameter_11': 'Fluoride', 'parameter_13': 'Nitrate', ...}</code>. We have a file named <code>JJM API Data/parameters_mapping_details.csv</code> that provides the complete dictionary mapping for these names. After mapping, we correct the column names for each pollutant and then select our pollutants of interest:</p>
<ul>
<li><b>parameter_10</b>: Chloride</li>
<li><b>parameter_11</b>: Fluoride</li>
<li><b>parameter_13</b>: Nitrate</li>
<li><b>parameter_14</b>: Sulphate</li>
<li><b>parameter_17</b>: Magnesium</li>
<li><b>parameter_19</b>: Iron</li>
<li><b>parameter_20</b>: Manganese</li>
<li><b>parameter_26</b>: Total Arsenic</li>
<li><b>parameter_34</b>: E. coli</li>
<li><b>parameter_35</b>: Total coliform</li>
<li><b>parameter_93</b>: E.coli</li>
</ul>
<p>As we can see in the data Parameter 34 is also E. coli (Space between E. and coli) and Parameter 93 is also E.coli. This could have happened due to spelling mistake while inputing data online by JJM. We deal with this issue by combining these columns by taking value from column which has non NaN value for that test.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=19c0b3d7-5d19-4565-93dc-8df8d65a7bde">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Reading and Preparing the (Pollutants Name to Parameter ID) dictionary</span>
<span class="n">parameter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"JJM API Data/parameters_mapping_details.csv"</span><span class="p">)</span>
<span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[[</span><span class="s1">'parameter_id'</span><span class="p">,</span> <span class="s1">'parameter_name'</span><span class="p">,</span> <span class="s1">'MeasurementUnit'</span><span class="p">]]</span>
<span class="n">parameter_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">"parameter_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">'parameter_id'</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">'parameter_name'</span><span class="p">]</span> 
                     <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">parameter</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()}</span>
<span class="n">parameter_mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">parameter_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

<span class="c1"># Converting Test Date column to Year and Month Column</span>
<span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Test_date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Test_date'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
<span class="n">JJM_df</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Test_date'</span><span class="p">])</span>
<span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Test_date'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="p">[</span><span class="s1">'Test_date'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="n">JJM_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">parameter_mapping</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">JJM_df</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="p">[[</span><span class="s1">'Stateid'</span><span class="p">,</span> <span class="s1">'VillageID'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">,</span> <span class="s1">'Source_type'</span><span class="p">,</span> <span class="s1">'Fluoride (as F)'</span><span class="p">,</span> <span class="s1">'Chloride (as Cl)'</span><span class="p">,</span> <span class="s1">'Nitrate (as NO3)'</span><span class="p">,</span> <span class="s1">'Magnesium (As Mg)'</span><span class="p">,</span> 
                            <span class="s1">'Sulphate (as SO4)'</span><span class="p">,</span> <span class="s1">'Total Arsenic (As As)'</span><span class="p">,</span> <span class="s1">'Iron (As Fe)'</span><span class="p">,</span> <span class="s1">'Manganese (As Mn)'</span><span class="p">,</span> <span class="s1">'E. coli'</span><span class="p">,</span> <span class="s1">'Total coliform'</span><span class="p">,</span> <span class="s1">'E.coli'</span><span class="p">]]</span>

<span class="c1"># Merging the two E. coli columns into one</span>
<span class="n">JJM_df</span><span class="p">[</span><span class="s1">'E Coli'</span><span class="p">]</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="p">[</span><span class="s1">'E. coli'</span><span class="p">]</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">JJM_df</span><span class="p">[</span><span class="s1">'E.coli'</span><span class="p">])</span>
<span class="c1"># Dropping the original columns as they're now merged into 'E Coli'</span>
<span class="n">JJM_df</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'E. coli'</span><span class="p">,</span> <span class="s1">'E.coli'</span><span class="p">])</span>

<span class="n">JJM_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Stateid</th>
<th>VillageID</th>
<th>Year</th>
<th>Month</th>
<th>Source_type</th>
<th>Fluoride (as F)</th>
<th>Chloride (as Cl)</th>
<th>Nitrate (as NO3)</th>
<th>Magnesium (As Mg)</th>
<th>Sulphate (as SO4)</th>
<th>Total Arsenic (As As)</th>
<th>Iron (As Fe)</th>
<th>Manganese (As Mn)</th>
<th>Total coliform</th>
<th>E Coli</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>13</td>
<td>125040</td>
<td>2024</td>
<td>6</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>13</td>
<td>125040</td>
<td>2022</td>
<td>3</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>13</td>
<td>125040</td>
<td>2023</td>
<td>7</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>13</td>
<td>125040</td>
<td>2022</td>
<td>5</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>13</td>
<td>125040</td>
<td>2022</td>
<td>5</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>21725994</th>
<td>2</td>
<td>598064</td>
<td>2021</td>
<td>7</td>
<td>Delivery points</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr>
<th>21725995</th>
<td>2</td>
<td>598064</td>
<td>2024</td>
<td>5</td>
<td>Water supply scheme sources</td>
<td>0.34</td>
<td>26.0</td>
<td>10.0</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
<td>0.05</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>21725996</th>
<td>2</td>
<td>598064</td>
<td>2023</td>
<td>6</td>
<td>Water supply scheme sources</td>
<td>0.19</td>
<td>65.23</td>
<td>10.2</td>
<td>NaN</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>21725997</th>
<td>2</td>
<td>598064</td>
<td>2023</td>
<td>6</td>
<td>Water supply scheme sources</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>21725998</th>
<td>2</td>
<td>598064</td>
<td>2023</td>
<td>4</td>
<td>Delivery points</td>
<td>0.18</td>
<td>39.7</td>
<td>10.13</td>
<td>NaN</td>
<td>84.0</td>
<td>NaN</td>
<td>0.32</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>21725893 rows × 15 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=59fac51a-61a6-488b-b056-01108e0dd173">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Village-Level Aggregation
</div>
<p><a id="jjm-aggregation"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>This cleaned <b>JJM data</b> is further aggregated to keep it at the <b>Village Level</b>. Currently, this data consists of test results at the <b>Habitation Level</b>, i.e., multiple results within the same village for the same time period.</p>
<p>For aggregation:</p>
<ul>
<li>
        For <b>numerical columns</b> (i.e., all pollutants), we create two new columns:
        <ul>
<li><b>Mean Pollutant Value</b> for the village</li>
<li><b>Max Pollutant Value</b> for the village</li>
</ul>
</li>
<li>
        For the <b>categorical column</b> (i.e., Source Type), we select the 
        <b>most frequently occurring source</b> within the village.
    </li>
</ul>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=0b258225-3d80-4679-8dbb-f6adbb2ef3e2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Defining the pollutant columns</span>
<span class="n">pollutant_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Fluoride (as F)'</span><span class="p">,</span> <span class="s1">'Chloride (as Cl)'</span><span class="p">,</span> <span class="s1">'Nitrate (as NO3)'</span><span class="p">,</span> <span class="s1">'Magnesium (As Mg)'</span><span class="p">,</span> <span class="s1">'Sulphate (as SO4)'</span>
                     <span class="p">,</span> <span class="s1">'Total Arsenic (As As)'</span><span class="p">,</span> <span class="s1">'Iron (As Fe)'</span><span class="p">,</span> <span class="s1">'Manganese (As Mn)'</span><span class="p">,</span> <span class="s1">'Total coliform'</span><span class="p">,</span> <span class="s1">'E Coli'</span><span class="p">]</span>

<span class="c1"># Converting all Pollutans column to Numeric</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">:</span>
    <span class="n">JJM_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">JJM_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
        
<span class="c1"># Defining the aggregation logic</span>
<span class="n">aggregation_logic</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="p">[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">}</span>
<span class="n">aggregation_logic</span><span class="p">[</span><span class="s1">'Source_type'</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># Most frequent value</span>

<span class="c1"># Performing the aggregation</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">JJM_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'VillageID'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggregation_logic</span><span class="p">)</span>

<span class="c1"># Flattening the multi-level column index after aggregation</span>
<span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="c1"># Rename the columns for clarity</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Source_type &lt;lambda&gt;'</span> <span class="p">:</span> <span class="s1">'Source_type'</span><span class="p">})</span>


<span class="c1"># Reset the index for a flat dataframe</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">aggregated_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageID</th>
<th>Year</th>
<th>Month</th>
<th>Fluoride (as F) mean</th>
<th>Fluoride (as F) max</th>
<th>Chloride (as Cl) mean</th>
<th>Chloride (as Cl) max</th>
<th>Nitrate (as NO3) mean</th>
<th>Nitrate (as NO3) max</th>
<th>Magnesium (As Mg) mean</th>
<th>...</th>
<th>Total Arsenic (As As) max</th>
<th>Iron (As Fe) mean</th>
<th>Iron (As Fe) max</th>
<th>Manganese (As Mn) mean</th>
<th>Manganese (As Mn) max</th>
<th>Total coliform mean</th>
<th>Total coliform max</th>
<th>E Coli mean</th>
<th>E Coli max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>2021</td>
<td>6</td>
<td>0.4325</td>
<td>0.52</td>
<td>100.6725</td>
<td>167.32</td>
<td>17.45</td>
<td>22.4</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0575</td>
<td>0.11</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2023</td>
<td>1</td>
<td>0.3900</td>
<td>0.39</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>2023</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>2023</td>
<td>3</td>
<td>0.3540</td>
<td>0.38</td>
<td>111.1640</td>
<td>173.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>2023</td>
<td>6</td>
<td>0.3825</td>
<td>0.42</td>
<td>109.8900</td>
<td>161.65</td>
<td>7.80</td>
<td>8.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0275</td>
<td>0.04</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4282074</th>
<td>704970</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282075</th>
<td>704971</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282076</th>
<td>704972</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282077</th>
<td>704973</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>4282078</th>
<td>704974</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
</tbody>
</table>
<p>4282079 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d5cc2377-f098-443d-a487-359b84afa16e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>Index(['VillageID', 'Year', 'Month', 'Fluoride (as F) mean',
       'Fluoride (as F) max', 'Chloride (as Cl) mean', 'Chloride (as Cl) max',
       'Nitrate (as NO3) mean', 'Nitrate (as NO3) max',
       'Magnesium (As Mg) mean', 'Magnesium (As Mg) max',
       'Sulphate (as SO4) mean', 'Sulphate (as SO4) max',
       'Total Arsenic (As As) mean', 'Total Arsenic (As As) max',
       'Iron (As Fe) mean', 'Iron (As Fe) max', 'Manganese (As Mn) mean',
       'Manganese (As Mn) max', 'Total coliform mean', 'Total coliform max',
       'E Coli mean', 'E Coli max', 'Source_type'],
      dtype='object')</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=4052f43e-3b1a-4fec-a84f-2621797dc608">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">aggregated_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/JJM_2021 - 2024_Preprocessed.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=988b0393-f5b5-4f24-9e56-5baa7c820895">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=168ce8ff-1213-4505-a6fa-030484d31ea5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=9100a291-7201-41ff-b712-edd7a867c1cf">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ee866203-afae-41c6-9721-4fecaa0a5f28">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Extracting, Reading and Preprocessing 2009 - 2019 (NRDWP) Water Quality Data
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=07c38138-c31a-40ac-943a-08b4a8ab4fd6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="nrdwp-scraping"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>The <b>NRDWP data</b> is scraped from the <b>NRDWP Website</b> as currently no APIs are available to fetch the data.<br>
We use <b>Python Selenium</b> to scrape the <b>Format E3 - Habitation wise laboratory testing data.</b></br></p>
<p>This is achieved by automating the following actions:</p>
<ul>
<li>Selecting <b>State</b>, <b>Year</b>, and <b>District</b>.</li>
<li>Clicking the <b>Show</b> button to view/load the corresponding Drinking Water Quality lab tested data.</li>
<li>Clicking the <b>Excel icon</b> in the top-left corner, which acts as a download button for downloading the data in Excel format.</li>
</ul>
<p>The attached image describes the buttons clicked for automating the process. Following it is the Python code used to perform the above steps.<br/><br/></p>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=10e93aaf-48aa-410d-80cb-9c9664706409">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<center>
<img alt="NRDWP Highlighted Image" src="Images/NRDWP H.png" style="width: 100%; max-width: 1750px; height: auto;"/>
</center>
<div style="text-align: center;font-size: 18px; line-height: 1.8;">
<b>NRDWP Website - Format E3- Habitation wise laboratory testing</b>
</div>


<br>
</br></div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=49c8c5d4-4243-4fba-9d1b-12efd06c7214">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 28px; line-height: 1.8;">
<p><i>The below code will <b>not work anymore</b> as it needs credentials to login to the <b>NRDWP Page</b> and then scrape.<br>
The code has been added just for understanding the process.<br>
Similarly, there is <b>no need to run</b> the Conversion code, which is right after this Scraping code,<br>
as all the Downloaded CSV files have already been properly converted and Renamed.</br></br></br></i></p>
<p>Therefore, we directly start with <b>Preprocessing</b> of the NRDWP downloaded and Converted Data.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=7f587cc6-c314-48d3-8632-436fe8b76690">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">## Scraping Code</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=079a0e14-2ba0-497c-a180-6acd106433e7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<!-- NRDWP Data Preprocessing -->
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Selenium Automation for Scraping
</div>
<div style="font-size: 28px; line-height: 1.8;">
<p>The below automation script uses <b>Selenium</b> to simulate interaction with a locally saved <b>HTML report file</b> that mimics an online portal. The script iteratively selects combinations of <b>Year</b>, <b>State</b>, and <b>District</b> from dropdown menus and attempts to <b>download Excel reports</b> for each district. If a server error occurs at any step (e.g., after selecting year or state), the script reloads the page and retries. Once a valid selection is made, it clicks the <b>Show</b> button and waits for the <b>Download to Excel</b> button to appear. If records exist, it clicks the download button and checks whether a new file appears in the directory within a timeout. If the download fails, it logs a message for <b>manual intervention</b>. This ensures robust downloading of reports across multiple district-year combinations, even when the interface is unstable or slow to respond.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=7f891349-169b-4e67-9d3d-2db2bf78aff7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">StaleElementReferenceException</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">TimeoutException</span>

<span class="k">def</span> <span class="nf">get_driver</span><span class="p">():</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span><span class="s2">"chromedriver.exe"</span><span class="p">)</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver</span>
    
<span class="n">current_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">"Habitation Wise Lab Testing Report.html"</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s2">"file://"</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_directory</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">get_driver</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Function to wait till one file gets downloaded before moving to next step. </span>
<span class="k">def</span> <span class="nf">wait_for_download</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">initial_count</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">initial_count</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># Selecting year</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">):</span>
    <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
    <span class="n">dropdownbox</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="c1"># Dealing with server Error in '/IMISReports' Application when a Year is clicked</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'h1'</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'h1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s2">"Server Error in '/IMISReports' Application."</span><span class="p">:</span>
            <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="c1"># If no issue after selecting Year, we proceed to select state</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">):</span>
            <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
            <span class="n">dropdownbox</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="c1"># Dealing with server Error in '/IMISReports' Application when a state is clicked</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'h1'</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'h1'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s2">"Server Error in '/IMISReports' Application."</span><span class="p">:</span>
                    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="c1"># If no issue after selecting Year, selecting state , we proceed to select district</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># First we find the number of districts</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">districts_text</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">'//*[@id="ctl00_ContentPlaceHolder_dddistrict"]'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">districts</span> <span class="o">=</span> <span class="n">districts_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
                <span class="n">cleaned_districts</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">districts</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>             
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cleaned_districts</span><span class="p">)):</span>
                    <span class="n">district_index</span> <span class="o">=</span> <span class="mi">49</span> <span class="o">+</span> <span class="n">y</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">dropdownbox</span><span class="p">[</span><span class="n">district_index</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                    <span class="c1"># If no issue we go for show button and then download button</span>
                    <span class="n">show_button</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">'//*[@id="ctl00_ContentPlaceHolder_btnGO"]'</span><span class="p">)</span>
                    <span class="n">show_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="c1"># Dealing with wait needed to complete loading of page after show button</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">'//*[@id="ctl00_convertEXCEL"]'</span><span class="p">)))</span>
                        <span class="c1"># Dealing with No record found after clicking show</span>
                        <span class="k">try</span> <span class="p">:</span>
                            <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">'//*[@id="ContentPlaceHolder_lblMessage"]'</span><span class="p">)</span>
                        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
                            <span class="n">download_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
                            <span class="n">initial_file_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">download_dir</span><span class="p">))</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                            <span class="n">down_button</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">'//*[@id="ctl00_convertEXCEL"]'</span><span class="p">)</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                            <span class="n">down_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                            <span class="c1"># If file is downloaded</span>
                            <span class="k">if</span> <span class="n">wait_for_download</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">initial_file_count</span><span class="p">):</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">"Download finished. Proceeding with the next step."</span><span class="p">)</span>
                            <span class="c1"># If file did not download within 2 minutes</span>
                            <span class="c1"># We move on and keep that file to be downloaded manually later</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                                <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
                                <span class="n">dropdownbox</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                                <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
                                <span class="n">dropdownbox</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">"Download did not finish within the timeout period."</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Manually Download </span><span class="si">{</span><span class="n">cleaned_districts</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>      
                    <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                        <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
                        <span class="n">dropdownbox</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                        <span class="n">dropdownbox</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s1">'option'</span><span class="p">)</span>
                        <span class="n">dropdownbox</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Manually Download </span><span class="si">{</span><span class="n">cleaned_districts</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>                                
                        <span class="c1"># If the element does not become visible within the timeout, skip waiting</span>
                        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=22577d66-2247-4f68-ab11-da58136eb113">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="nrdwp-conversion"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>Now, the <b>downloaded data</b> needs preprocessing to make it usable:</p>
<ol>
<li>
        The downloaded <b>Excel files</b> are actually <b>XML/HTML data</b> saved with a <code>.xls</code> extension.  
        These files need to be <b>converted to CSV format</b> to be read in Python Jupyter Notebooks.
    </li>
<li>
        Once converted, these Excel files are <b>sorted</b> and <b>organized</b> with proper file names into  
        respective <b>Statewise folders</b> for further use.
    </li>
</ol>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=d09ffb84-6df6-4ee0-9e9e-5413a3384ec6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Conversion Code</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c43301a7-705d-4e49-92dd-bc61c377eaac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 28px; line-height: 1.8;">
<p><b><i>No need to run</i></b> the Conversion code as all the Downloaded CSV files have already been properly converted and Renamed.
The code has been added just for understanding the process.
Therefore, directly start with <b>Preprocessing code</b> of the NRDWP downloaded and Converted Data.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=c5cf40a0-429e-424e-9daa-82551be233a2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2b4405d0-38c7-44cc-afc5-0aea51f00c5c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Data Conversion and Formatting
</div>
<p><a id="nrdwp-conversion"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
Below s script processes downloaded <b>.xls files</b> from the <b>NRDWP Data</b> folder, which are actually <b>HTML files with embedded tables</b>. It uses <b>BeautifulSoup</b> to parse each file, extracts the <b>State</b>, <b>District</b>, and <b>Testing Year</b> from the second row of the table, and cleans the district name by removing special characters and digits. For each file, it creates a <b>folder named after the State</b> (if it doesn't already exist) and saves the extracted data into a <b>CSV file</b> inside that folder. The CSV file is named using the format: <code>State_District_Year.csv</code>. All table rows are written into this CSV, ensuring the structured data is preserved and categorized by state and district for easy access and future analysis

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=3311277d-9291-4954-852b-e51158c8765e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">get_file_paths</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
    <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
        <span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">full_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">".xls"</span> <span class="ow">in</span> <span class="n">full_path</span><span class="p">:</span>
                <span class="n">file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">file_paths</span>

<span class="n">directory_path</span> <span class="o">=</span> <span class="s2">"NRDWP Data"</span>

<span class="n">file_paths</span> <span class="o">=</span> <span class="n">get_file_paths</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span>
<span class="n">file_paths</span>

<span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
    <span class="n">ele</span>  <span class="o">=</span> <span class="n">ele</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"/"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">html_file</span><span class="p">:</span>
        <span class="n">html_content</span> <span class="o">=</span> <span class="n">html_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_content</span><span class="p">,</span> <span class="s1">'html.parser'</span><span class="p">)</span>
        <span class="c1"># Find the table within the HTML</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'table'</span><span class="p">)</span>
        <span class="n">second_row</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'row'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    
        <span class="c1"># Extract state, district, and testing date values from the second row</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">second_row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'cell'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="n">district</span> <span class="o">=</span> <span class="n">second_row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'cell'</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="n">district</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[\d\W_]+'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">district</span><span class="p">)</span>
        <span class="n">testing_date</span> <span class="o">=</span> <span class="n">second_row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'cell'</span><span class="p">)[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        
        <span class="c1"># Create directory if it does not exist</span>
        <span class="n">state_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">state_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">state_folder</span><span class="p">)</span>
    
        <span class="c1"># Write CSV file in the state folder</span>
        <span class="n">csv_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">district</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">testing_date</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="si">}</span><span class="s2">.csv"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="c1"># Extract data from each row and write to CSV</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'row'</span><span class="p">):</span>
                <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">cell</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'cell'</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=cd5e7d32-e4b0-43a6-b9ff-21ba1b6ea73e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b4ef5023-b693-4582-bba5-9618dc4d7305">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 28px; line-height: 1.8;">
<b> Preprocessing of the NRDWP downloaded and Converted Data </b><br/>
Reading the converted NRDWP complete data and concatenating all into one Dataframe
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8988bc16-713f-43d4-80fa-ceb32197e951">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">find_csv_files</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="n">csv_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".csv"</span><span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">csv_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">csv_files</span>

<span class="n">directory</span> <span class="o">=</span> <span class="s1">'NRDWP Data'</span> 
<span class="n">NRDWP_files</span> <span class="o">=</span> <span class="n">find_csv_files</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Total NRDWP CSV Files - "</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">NRDWP_files</span><span class="p">))</span>

<span class="n">NRDWP_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">NRDWP_files</span><span class="p">])</span>

<span class="c1"># All columns</span>
<span class="c1"># ['row', 'StateName', 'DistrictName', 'BlockName', 'PanchayatName','VillageName', 'HabitationName', 'Location', 'TypeOfSource',</span>
<span class="c1"># 'Lab', 'LabTestingDate', 'AbovePMandatory', 'BelowPMandatory', 'AbovePEmerging', 'BelowPEmerging', 'testId', 'HabitationId']</span>

<span class="n">NRDWP_df</span> <span class="o">=</span> <span class="n">NRDWP_df</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span><span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'HabitationName'</span><span class="p">,</span> <span class="s1">'AbovePMandatory'</span><span class="p">,</span>
                     <span class="s1">'BelowPMandatory'</span><span class="p">,</span> <span class="s1">'AbovePEmerging'</span><span class="p">,</span> <span class="s1">'BelowPEmerging'</span><span class="p">,</span> <span class="s1">'TypeOfSource'</span><span class="p">,</span> <span class="s1">'LabTestingDate'</span><span class="p">,</span> <span class="s1">'HabitationId'</span><span class="p">]]</span>
<span class="n">NRDWP_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total NRDWP CSV Files -  5926
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>AbovePMandatory</th>
<th>BelowPMandatory</th>
<th>AbovePEmerging</th>
<th>BelowPEmerging</th>
<th>TypeOfSource</th>
<th>LabTestingDate</th>
<th>HabitationId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[25.200 mg/l],Ca...</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0001692897</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Alkalinity[450.000 mg/l]</td>
<td>E.Coli[1.000 MPN/100ml]</td>
<td>Calcium[150.000 mg/l]</td>
<td>NaN</td>
<td>17/03/2010</td>
<td>HabsId : 0001692897</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[25.000 mg/l],Ca...</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[10.000 mg/l],Ca...</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.500 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[26.000 mg/l],Ca...</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>15414</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.880 mg/l]</td>
<td>pH[6.360 pH]</td>
<td>Manganese[0.340 mg/l],E.Coli[2.000 MPN/100ml],...</td>
<td>Turbidity[0.010 NTU],Hardness[84.000 mg/l]</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
</tr>
<tr>
<th>15415</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[3.010 mg/l]</td>
<td>pH[6.370 pH]</td>
<td>Manganese[0.330 mg/l],E.Coli[6.000 MPN/100ml],...</td>
<td>Turbidity[0.010 NTU]</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
</tr>
<tr>
<th>15416</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.050 mg/l]</td>
<td>pH[6.540 pH]</td>
<td>E.Coli[7.000 MPN/100ml],Total Coliform[26.000 ...</td>
<td>Turbidity[0.020 NTU],Manganese[0.290 mg/l]</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
</tr>
<tr>
<th>15417</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.500 mg/l]</td>
<td>pH[6.390 pH]</td>
<td>E.Coli[8.000 MPN/100ml],Total Coliform[26.000 ...</td>
<td>Turbidity[0.040 NTU],Manganese[0.210 mg/l]</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
</tr>
<tr>
<th>15418</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>NaN</td>
<td>Iron[0.450 mg/l],pH[6.420 pH]</td>
<td>E.Coli[3.000 MPN/100ml],Total Coliform[15.000 ...</td>
<td>Turbidity[0.070 NTU],Manganese[0.160 mg/l]</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 13 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8874ca93-41d9-43da-8120-d72886e29d0a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Handling Format Differences with JJM
</div>
<p><a id="nrdwp-format-diff"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>The <b>NRDWP data</b> has a slightly different format compared to the <b>JJM Lab testing results</b>.<br>
Here, the results are segregated into four columns:</br></p>
<ul>
<li><b>AbovePMandatory</b></li>
<li><b>BelowPMandatory</b></li>
<li><b>AbovePEmerging</b></li>
<li><b>BelowPEmerging</b></li>
</ul>
In order to use it together with the JJM data, we bring it into the same format as the JJM data.  
We start by extracting all unique <b>Pollutants</b> in this dataset and then choosing our <b>Pollutants of interest</b> from them, which are:
<ul>
<li><b>Arsenic</b></li>
<li><b>Chloride</b></li>
<li><b>E.Coli</b></li>
<li><b>Total Coliform</b></li>
<li><b>Fluoride</b></li>
<li><b>Iron</b></li>
<li><b>Magnesium</b></li>
<li><b>Manganese</b></li>
<li><b>Nitrate</b></li>
<li><b>Sulphates</b></li>
</ul>
We create an individual column for each of these pollutants, with their corresponding value in that column for each test. Further we also convert Test Date into Year Month column for each test
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=0e56a19e-402a-4402-80f6-026985057c1b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Extracting Pollutant Values (with Units)
</div>
<p><a id="extract-pollutants"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>In below code The <b><code>extract_pollutant_values</code></b> function is designed to extract numeric values of specific <b>pollutants</b> (e.g., Fluoride, Arsenic, Iron) from NRDWP Lab Testing columns like <code>AbovePMandatory</code>, <code>BelowPEmerging</code>, etc. These values are often embedded as strings such as <code>Fluoride[0.600 mg/l]</code>, and we want to extract the <code>0.600</code> part into a separate column.</p>
<p><br/><br/>
<b>Step-by-step breakdown using example:</b><br/></p>
<p>Suppose we want to extract <code>Fluoride</code> values from the following columns for this row:</p>
<ul style="margin-left: 30px;">
<li><b>BelowPMandatory</b> = "Arsenic[0.000 mg/l], Fluoride[0.600 mg/l], Iron[0.800 mg/l]"</li>
<li><b>BelowPEmerging</b> = "Turbidity[0.000 NTU], Sulphates[25.200 mg/l], Calcium[75.000 mg/l]"</li>
</ul>
<hr/>
<p><b>1. Creating an empty column:</b><br/>
The function begins by initializing a column for each pollutant with <code>NaN</code> values:</p>
<pre><code>df['Fluoride'] = np.nan</code></pre>
<hr/>
<p><b>2. Looping through source columns:</b><br/>
For each of the four pollutant source columns, it checks if the target pollutant (e.g., <b>Fluoride</b>) is present:</p>
<pre><code>mask = df[col].str.contains('Fluoride', na=False)</code></pre>
<p>This returns <code>True</code> for rows where the column contains Fluoride.</p>
<hr/>
<p><b>3. Extracting numeric values:</b><br/>
If Fluoride is found, it extracts the full string using a regular expression:</p>
<pre><code>df.loc[mask, 'Fluoride'] = df.loc[mask, col]
    .str.extract('(Fluoride[^,]*)')[0]           # gets "Fluoride[0.600 mg/l]"
    .str.split('[').str[-1].str.strip(' ]')</code></pre>
<p>This converts <code>"Fluoride[0.600 mg/l]"</code> → <code>"0.600 mg/l"</code> → <code>"0.600"</code></p>
<hr/>
<p><b>4. Repeating for each pollutant:</b><br/>
The above process is repeated for other pollutants like <code>Iron</code>, <code>Arsenic</code>, <code>Sulphates</code>, etc., filling new columns:</p>
<ul style="margin-left: 30px;">
<li><code>df['Iron']</code> → "0.800"</li>
<li><code>df['Arsenic']</code> → "0.000"</li>
<li><code>df['Sulphates']</code> → "25.200"</li>
</ul>
<hr/>
<p><b>5. Final Output:</b><br/>
After this function runs for all pollutants, your <code>NRDWP_df</code> now contains dedicated columns like:</p>
<pre><code>
Fluoride | Arsenic | Iron | Sulphates | ...
-------------------------------------------
 0.600   |  0.000  | 0.800 | 25.200    | ...
</code></pre>
<p>This makes the NRDWP data consistent with JJM data format, enabling unified analysis and comparison across both sources.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ff42f0d8-d019-44c1-ad4c-13280fdcf5f9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Define the list of pollutants</span>
<span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span> <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> <span class="s1">'Manganese'</span><span class="p">,</span>  <span class="s1">'Sulphates'</span><span class="p">]</span>

<span class="c1"># List of columns to search in</span>
<span class="n">pollutant_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'AbovePMandatory'</span><span class="p">,</span> <span class="s1">'BelowPMandatory'</span><span class="p">,</span> <span class="s1">'AbovePEmerging'</span><span class="p">,</span> <span class="s1">'BelowPEmerging'</span><span class="p">]</span>

<span class="c1"># Function to extract pollutant value from a string</span>
<span class="k">def</span> <span class="nf">extract_pollutant_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pollutant</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
    <span class="c1"># Create a new column for the pollutant, starting with NaN values</span>
    <span class="n">pollutant_column</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pollutant</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="c1"># Iterate over each column in the list to extract pollutant values</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># Create a mask for rows where the pollutant is present</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pollutant</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Extract the values corresponding to the pollutant from the column</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">pollutant</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">f</span><span class="s1">'(</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">[^,]*)'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'['</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">' ]'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Assuming NRDWP_df is your DataFrame</span>
<span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">:</span>
    <span class="n">NRDWP_df</span> <span class="o">=</span> <span class="n">extract_pollutant_values</span><span class="p">(</span><span class="n">NRDWP_df</span><span class="p">,</span> <span class="n">pollutant</span><span class="p">,</span> <span class="n">pollutant_columns</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Done"</span><span class="p">,</span><span class="n">pollutant</span><span class="p">)</span>

<span class="n">NRDWP_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Done Nitrate
Done Chloride
Done Fluoride
Done Arsenic
Done E.Coli
Done Total Coliform
Done Iron
Done Magnesium
Done Manganese
Done Sulphates
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>AbovePMandatory</th>
<th>BelowPMandatory</th>
<th>AbovePEmerging</th>
<th>BelowPEmerging</th>
<th>...</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>Fluoride</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[25.200 mg/l],Ca...</td>
<td>...</td>
<td>0.000 mg/l</td>
<td>25.000 mg/l</td>
<td>0.600 mg/l</td>
<td>0.000 mg/l</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>25.200 mg/l</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Alkalinity[450.000 mg/l]</td>
<td>E.Coli[1.000 MPN/100ml]</td>
<td>Calcium[150.000 mg/l]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000 mg/l</td>
<td>1.000 MPN/100ml</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[25.000 mg/l],Ca...</td>
<td>...</td>
<td>0.000 mg/l</td>
<td>21.000 mg/l</td>
<td>0.600 mg/l</td>
<td>0.000 mg/l</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>25.000 mg/l</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.600 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[10.000 mg/l],Ca...</td>
<td>...</td>
<td>0.000 mg/l</td>
<td>20.000 mg/l</td>
<td>0.600 mg/l</td>
<td>0.000 mg/l</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>10.000 mg/l</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>NaN</td>
<td>Arsenic[0.000 mg/l],Fluoride[0.500 mg/l],Iron[...</td>
<td>NaN</td>
<td>Turbidity[0.000 NTU],Sulphates[26.000 mg/l],Ca...</td>
<td>...</td>
<td>0.000 mg/l</td>
<td>20.000 mg/l</td>
<td>0.500 mg/l</td>
<td>0.000 mg/l</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>0.000 mg/l</td>
<td>26.000 mg/l</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>15414</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.880 mg/l]</td>
<td>pH[6.360 pH]</td>
<td>Manganese[0.340 mg/l],E.Coli[2.000 MPN/100ml],...</td>
<td>Turbidity[0.010 NTU],Hardness[84.000 mg/l]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.000 MPN/100ml</td>
<td>40.000 MPN/100ml</td>
<td>1.880 mg/l</td>
<td>NaN</td>
<td>0.340 mg/l</td>
<td>NaN</td>
</tr>
<tr>
<th>15415</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[3.010 mg/l]</td>
<td>pH[6.370 pH]</td>
<td>Manganese[0.330 mg/l],E.Coli[6.000 MPN/100ml],...</td>
<td>Turbidity[0.010 NTU]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.000 MPN/100ml</td>
<td>27.000 MPN/100ml</td>
<td>3.010 mg/l</td>
<td>NaN</td>
<td>0.330 mg/l</td>
<td>NaN</td>
</tr>
<tr>
<th>15416</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.050 mg/l]</td>
<td>pH[6.540 pH]</td>
<td>E.Coli[7.000 MPN/100ml],Total Coliform[26.000 ...</td>
<td>Turbidity[0.020 NTU],Manganese[0.290 mg/l]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.000 MPN/100ml</td>
<td>26.000 MPN/100ml</td>
<td>1.050 mg/l</td>
<td>NaN</td>
<td>0.290 mg/l</td>
<td>NaN</td>
</tr>
<tr>
<th>15417</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Iron[1.500 mg/l]</td>
<td>pH[6.390 pH]</td>
<td>E.Coli[8.000 MPN/100ml],Total Coliform[26.000 ...</td>
<td>Turbidity[0.040 NTU],Manganese[0.210 mg/l]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8.000 MPN/100ml</td>
<td>26.000 MPN/100ml</td>
<td>1.500 mg/l</td>
<td>NaN</td>
<td>0.210 mg/l</td>
<td>NaN</td>
</tr>
<tr>
<th>15418</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>NaN</td>
<td>Iron[0.450 mg/l],pH[6.420 pH]</td>
<td>E.Coli[3.000 MPN/100ml],Total Coliform[15.000 ...</td>
<td>Turbidity[0.070 NTU],Manganese[0.160 mg/l]</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.000 MPN/100ml</td>
<td>15.000 MPN/100ml</td>
<td>0.450 mg/l</td>
<td>NaN</td>
<td>0.160 mg/l</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 23 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2ec6123d-17e1-471b-8c9d-0f1cb3c7d06f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="remove-units"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
As the <b>extracted Pollutant column</b> have units in thier data, it needs to be removed to keep all pollutants data Numeric
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=72dae94d-1cb6-43b5-b756-514f4af90c5e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">NRDWP_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pollutant_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span> 
                     <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> <span class="s1">'Manganese'</span><span class="p">,</span> <span class="s1">'Sulphates'</span><span class="p">]</span>

<span class="c1"># Compile a regular expression pattern to extract numeric values</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"([-+]?\d*\.?\d+)"</span><span class="p">)</span>  <span class="c1"># Matches numeric values including decimals</span>

<span class="c1"># Use vectorized string operations to clean all columns</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">:</span>
    <span class="n">NRDWP_cdf</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">NRDWP_cdf</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>  <span class="c1"># Ensure values are strings</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>  <span class="c1"># Extract numeric values using regex</span>
        <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Convert the extracted values to floats</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="s2">"done"</span><span class="p">)</span>

<span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span>
       <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'HabitationName'</span><span class="p">,</span><span class="s1">'TypeOfSource'</span><span class="p">,</span> <span class="s1">'LabTestingDate'</span><span class="p">,</span>
       <span class="s1">'HabitationId'</span><span class="p">,</span> <span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span>
       <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> <span class="s1">'Manganese'</span><span class="p">,</span> <span class="s1">'Sulphates'</span><span class="p">]]</span>
<span class="n">NRDWP_cdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nitrate done
Chloride done
Fluoride done
Arsenic done
E.Coli done
Total Coliform done
Iron done
Magnesium done
Manganese done
Sulphates done
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[9]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>LabTestingDate</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>Fluoride</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0001692897</td>
<td>0.0</td>
<td>25.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>17/03/2010</td>
<td>HabsId : 0001692897</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
<td>0.0</td>
<td>21.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
<td>0.0</td>
<td>20.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>30/03/2010</td>
<td>HabsId : 0000050844</td>
<td>0.0</td>
<td>20.0</td>
<td>0.5</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>15414</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
</tr>
<tr>
<th>15415</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
</tr>
<tr>
<th>15416</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
</tr>
<tr>
<th>15417</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
</tr>
<tr>
<th>15418</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>30/11/2018</td>
<td>HabsId : 0001283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 19 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=47e5092a-7b39-4c31-bd9c-1878cc7e6694">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="save-nrdwp-restart"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
Saving till now preprocessed NRDWP data and Restarting the Kernel after below code cell to clean memory and start fresh by further using the saved preprocessed data
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=d6728617-5179-4f40-8bae-cbea21b8947d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_cdf.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=f0709010-85e4-495e-b06c-8068b01c9f73">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Mapping Village ID in NRDWP Data as NRDWP Dataset only has Habitation ID
</div>
<p><a id="village-id-issue"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<p>Now that we have cleaned the <b>NRDWP Data</b>, one more step remains. The <b>NRDWP data</b> has only <b>Habitation ID</b> and no <b>Village ID</b> . Since our analysis requires the data at the <b>Village Level</b>, we need unique identification for villages similar to the <b>JJM data</b>. To achieve this, we use the <b>B1 Habitation Data (B1 means the Basic Habitation Data from JJM)</b> and the <b>Habitation Level Master Data</b> to add Village IDs to the NRDWP data.</p>
<p>An issue arises as a few habitations (~17,000 habitations, corresponding to ~9,000 villages) have no match using the IDs. To address this, we use <b>Fuzzy Matching</b> The fuzzy matching correction for <b>unmatched habitation is done after</b> .</p>
<p>The steps to add the <b>Village ID</b> using the <b>Habitation ID - Village ID mapping</b> involve a crucial step:</p>
<ul>
<li>We use <b>Forward Fill</b> and <b>Backward Fill</b> for villages where some habitations match but others do not.</li>
<li>If some habitations of a village are matched, we can associate the unmatched habitations to the same village ID, as they all belong to the same village.</li>
<li>This ensures consistency, as all habitations within a village are assigned the same <b>Village ID</b> based on the matched ones.</li>
</ul>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=31e96a7c-de42-4dfb-abef-a6dfc92b3fc2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_cdf.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=cb3ef06b-dad3-4ac7-838d-1552c09b5705">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="habitation-cleaning"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
We <b>clean the Habitation ID</b> to remove the Strings from it and Converting it to Numeric
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8609a939-4e99-4201-a2a8-56b9fa5fee71">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Clean HabitationId</span>
<span class="k">def</span> <span class="nf">clean_habitation_id</span><span class="p">(</span><span class="n">hab_id</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">"HabsId :"</span> <span class="ow">in</span> <span class="n">hab_id</span><span class="p">:</span>
        <span class="n">hab_id</span> <span class="o">=</span> <span class="n">hab_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"HabsId :"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Remove 'HabsId :'</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hab_id</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">"0"</span><span class="p">))</span> <span class="k">if</span> <span class="n">hab_id</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># Remove leading zeroes and convert to int</span>

<span class="c1"># Apply cleaning function</span>
<span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_habitation_id</span><span class="p">)</span>
<span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'LabTestingDate'</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'</span><span class="si">%d</span><span class="s1">/%m/%Y'</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'Month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'LabTestingDate'</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'</span><span class="si">%d</span><span class="s1">/%m/%Y'</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">'LabTestingDate'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Report invalid HabitationId entries</span>
<span class="n">invalid_entries</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="p">[</span><span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of invalid HabitationIds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">invalid_entries</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"All HabitationId cleaned successfully"</span><span class="p">)</span>
<span class="n">NRDWP_cdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Number of invalid HabitationIds: 0
All HabitationId cleaned successfully
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>Fluoride</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>1692897</td>
<td>0.0</td>
<td>25.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
<td>2010</td>
<td>3</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>1692897</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>21.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
<td>2010</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>0.6</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
<td>2010</td>
<td>3</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>0.5</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
<td>2010</td>
<td>3</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>25536212</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
</tr>
<tr>
<th>25536213</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
</tr>
<tr>
<th>25536214</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
</tr>
<tr>
<th>25536215</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
</tr>
<tr>
<th>25536216</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 20 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d57ce4cc-527f-47f9-ad5e-760c73e2658e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="b1-mapping-read"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
Reading the <b>B1 Habitation Data</b> to get Habitation ID - Village ID mapping
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=e8915f33-5b7f-455a-bc72-a29b5819c6d0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Hab_Vill_ID_B1_df.csv"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>HabitationId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>144774.0</td>
<td>367175.0</td>
</tr>
<tr>
<th>1</th>
<td>144772.0</td>
<td>367173.0</td>
</tr>
<tr>
<th>2</th>
<td>144771.0</td>
<td>367172.0</td>
</tr>
<tr>
<th>3</th>
<td>144773.0</td>
<td>367174.0</td>
</tr>
<tr>
<th>4</th>
<td>144775.0</td>
<td>367176.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1762423</th>
<td>615990.0</td>
<td>1884785.0</td>
</tr>
<tr>
<th>1762424</th>
<td>483645.0</td>
<td>1884787.0</td>
</tr>
<tr>
<th>1762425</th>
<td>483645.0</td>
<td>1884788.0</td>
</tr>
<tr>
<th>1762426</th>
<td>483645.0</td>
<td>1884786.0</td>
</tr>
<tr>
<th>1762427</th>
<td>483642.0</td>
<td>1884784.0</td>
</tr>
</tbody>
</table>
<p>1762428 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b33ed9a0-2548-4555-982f-e7f3b9ffeccd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="master-mapping-read"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
Reading the <b>Master data of Habitation ID - Village ID</b> mapping (<i>This is insufficient as it lacks older habitations thats why we read earlier<br/>
Habitation ID - Village ID mapping from B1 Data.)
</i></div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1610400f-5c60-4c3e-a26f-b66fd51b1060">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Master Data - MD</span>

<span class="n">Hab_Vill_ID_MD_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"API-habitation_data-All-india.csv"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_MD_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_MD_df</span><span class="p">[[</span><span class="s1">'VillageId'</span><span class="p">,</span> <span class="s1">'HabitationId'</span><span class="p">]]</span>
<span class="n">Hab_Vill_ID_MD_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_MD_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Hab_Vill_ID_MD_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_MD_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_MD_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>HabitationId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>608882</td>
<td>1715291</td>
</tr>
<tr>
<th>1</th>
<td>608871</td>
<td>1721883</td>
</tr>
<tr>
<th>2</th>
<td>608871</td>
<td>1714973</td>
</tr>
<tr>
<th>3</th>
<td>608881</td>
<td>1715292</td>
</tr>
<tr>
<th>4</th>
<td>608875</td>
<td>1715288</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1692138</th>
<td>484482</td>
<td>1283884</td>
</tr>
<tr>
<th>1692139</th>
<td>484482</td>
<td>1283883</td>
</tr>
<tr>
<th>1692140</th>
<td>484482</td>
<td>1283881</td>
</tr>
<tr>
<th>1692141</th>
<td>484484</td>
<td>1283888</td>
</tr>
<tr>
<th>1692142</th>
<td>484484</td>
<td>1283887</td>
</tr>
</tbody>
</table>
<p>1692137 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a16ff36e-1da6-4be4-a4fa-0a6548eb5b8c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="concat-mappings"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<b>Concatenating both the mapping</b> to have a complete set of Older as well as Updated Habitations Village ID Mapping
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=54e27a65-58c5-4c7b-ad71-7ae11ca36755">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hab_Vill_ID</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">,</span> <span class="n">Hab_Vill_ID_MD_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hab_Vill_ID</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">Hab_Vill_ID</span> <span class="o">=</span> <span class="n">Hab_Vill_ID</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>HabitationId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>144774.0</td>
<td>367175</td>
</tr>
<tr>
<th>1</th>
<td>144772.0</td>
<td>367173</td>
</tr>
<tr>
<th>2</th>
<td>144771.0</td>
<td>367172</td>
</tr>
<tr>
<th>3</th>
<td>144773.0</td>
<td>367174</td>
</tr>
<tr>
<th>4</th>
<td>144775.0</td>
<td>367176</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>3452951</th>
<td>483724.0</td>
<td>1884810</td>
</tr>
<tr>
<th>3452952</th>
<td>483724.0</td>
<td>1884811</td>
</tr>
<tr>
<th>3452954</th>
<td>611922.0</td>
<td>1884808</td>
</tr>
<tr>
<th>3452956</th>
<td>611922.0</td>
<td>1884807</td>
</tr>
<tr>
<th>3453033</th>
<td>674168.0</td>
<td>1884595</td>
</tr>
</tbody>
</table>
<p>1768387 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ba6fa866-73fe-4bab-8565-72d550a5efaa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="merge-nrdwp-villageid"></a></p>
<div style="font-size: 28px; line-height: 1.8;">
<b>Merging NRDWP WQ data with Habitation - Village ID Mapping</b> to add Village ID column to NRDWP Data
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=286d0e31-b7d3-444c-a864-066e2b80968c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ensure HabitationId is numeric in both DataFrames</span>
<span class="c1"># Convert HabitationId to numeric (integer)</span>
<span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">NRDWP_cdf</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">Hab_Vill_ID</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>

<span class="c1"># Drop rows where HabitationId is NaN after conversion</span>
<span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">])</span>
<span class="n">Hab_Vill_ID</span> <span class="o">=</span> <span class="n">Hab_Vill_ID</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'HabitationId'</span><span class="p">])</span>

<span class="c1"># Perform a left join</span>
<span class="n">NRDWP_mcdf</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Hab_Vill_ID</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"HabitationId"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"left"</span><span class="p">)</span>
<span class="n">NRDWP_mcdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>1692897</td>
<td>0.0</td>
<td>25.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>1692897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>21.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>25536212</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536213</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536214</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536215</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536216</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=d16c7f3a-7327-4f0e-add4-0dbaa9113d6b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">NRDWP_mcdf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_mcdf.csv"</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=7213a727-ccf7-4c20-900f-754fe8794f1a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Segregating Matched and Unmatched Habitations
</div>
<p><a id="segregate-matched-unmatched"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
<p>As the merging done previously is a <b>Left Join</b> (i.e., irrespective of a match found or not for a <b>Habitation ID</b> in NRDWP data, all its rows are still in the merged dataset), the rows with <b>Habitation ID</b> having a match in the <b>Habitation ID - Village ID</b> mapping will have the correct corresponding <b>Village ID</b> added in the NRDWP data. For habitations having no match in the mapping, <b>NaN</b> will be in the <b>Village ID</b> column in the merged dataset.</p>
<p>The further process is to separate the merged and unmerged data. It is important to note that we do not directly segregate the merged and unmerged data based on <b>NaN</b> and numbers in the <b>Village ID</b> column. For example, if <b>Habitation A</b> has a match but <b>Habitation B</b> doesn’t, and if we know <b>Habitation A</b> and <b>Habitation B</b> belong to the same village, then we don’t need to look further for a match for <b>Habitation B</b> as it shares the same match as <b>Habitation A</b>.</p>
<p>We separate the matched subset by only including habitations where the village they belong to has no other habitation with a match.</p>
<p><b>Steps:</b></p>
<ul>
<li>Group the dataset by <b>StateName</b>, <b>DistrictName</b>, <b>BlockName</b>, <b>PanchayatName</b>, and <b>VillageName</b>:
        <pre>grouped = state_merged_df.groupby(['StateName', 'DistrictName', 'BlockName', 'PanchayatName', 'VillageName'])</pre>
</li>
<li>Separate groups where all <b>VillageId</b> values are <b>NaN</b>:  
        <pre>unmatched_NRDWP_df = grouped.filter(lambda group: group['VillageId'].isna().all())</pre>
</li>
<li>Fill <b>VillageId</b> within groups that have at least one non-<b>NaN</b> value:
        <pre>
# Fill 'Village Id' within groups with at least one non-NaN value
def fill_village_id(group):
    if group['VillageId'].notna().any():  # At least one non-NaN value
        group['VillageId'] = group['VillageId'].fillna(method='bfill').fillna(method='ffill')
    return group
<p>Apply the fill function to all groups
NRDWP_cdf = grouped.apply(fill_village_id)
NRDWP_cdf.dropna(subset=['VillageId'], inplace=True)
        </p></pre>
</li>
</ul>
<p>These processes are performed <b>state-wise</b> for faster computation and later merged together.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c3b27149-6af1-464c-80b8-183b7fb07f4c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
<span class="n">NRDWP_mcdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_mcdf.csv"</span><span class="p">)</span>
<span class="n">NRDWP_mcdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>1692897</td>
<td>0.0</td>
<td>25.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>1692897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>21.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>25536212</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536213</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536214</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536215</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25536216</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
</tbody>
</table>
<p>25536217 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=7c743015-c697-45ae-8ec0-e702ed59adfc">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># These are all the unique State names in the data. Still for ensuring we do not miss any we get the unique state list directly from the Data Only.</span>
<span class="n">statelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span><span class="s1">'ARUNACHAL PRADESH'</span><span class="p">,</span><span class="s1">'ASSAM'</span><span class="p">,</span><span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span><span class="s1">'BIHAR'</span><span class="p">,</span><span class="s1">'CHATTISGARH'</span><span class="p">,</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span><span class="s1">'GOA'</span><span class="p">,</span>
              <span class="s1">'GUJARAT'</span><span class="p">,</span> <span class="s1">'HARYANA'</span><span class="p">,</span> <span class="s1">'HIMACHAL PRADESH'</span><span class="p">,</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span> <span class="s1">'JAMMU AND KASHMIR'</span><span class="p">,</span> <span class="s1">'JHARKHAND'</span><span class="p">,</span> <span class="s1">'KARNATAKA'</span><span class="p">,</span> <span class="s1">'KERALA'</span><span class="p">,</span> 
              <span class="s1">'MADHYA PRADESH'</span><span class="p">,</span> <span class="s1">'MAHARASHTRA'</span><span class="p">,</span> <span class="s1">'MANIPUR'</span><span class="p">,</span>  <span class="s1">'MEGHALAYA'</span><span class="p">,</span>  <span class="s1">'MIZORAM'</span><span class="p">,</span>  <span class="s1">'NAGALAND'</span><span class="p">,</span>  <span class="s1">'ODISHA'</span><span class="p">,</span> <span class="s1">'ORISSA'</span><span class="p">,</span> <span class="s1">'PUDUCHERRY'</span><span class="p">,</span>
              <span class="s1">'PUNJAB'</span><span class="p">,</span> <span class="s1">'RAJASTHAN'</span><span class="p">,</span> <span class="s1">'SIKKIM'</span><span class="p">,</span> <span class="s1">'TAMIL NADU'</span><span class="p">,</span> <span class="s1">'TELANGANA'</span><span class="p">,</span> <span class="s1">'TRIPURA'</span><span class="p">,</span> <span class="s1">'UTTAR PRADESH'</span><span class="p">,</span> <span class="s1">'UTTARAKHAND'</span><span class="p">,</span> <span class="s1">'WEST BENGAL'</span><span class="p">]</span>

<span class="n">statelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">NRDWP_mcdf</span><span class="o">.</span><span class="n">StateName</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">statelist</span><span class="p">:</span>
    <span class="n">state_merged_df</span> <span class="o">=</span> <span class="n">NRDWP_mcdf</span><span class="p">[</span><span class="n">NRDWP_mcdf</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">]</span>
    <span class="c1"># Group by the specified columns</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">state_merged_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">])</span>
    <span class="c1"># Separate groups where all 'Village Id' values are NaN</span>
    <span class="n">unmatched_NRDWP_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">group</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
    <span class="c1"># Count unique groups with all NaN in 'Village Id'</span>
    <span class="n">unique_groups_count</span> <span class="o">=</span> <span class="n">unmatched_NRDWP_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">ngroups</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of unique groups with all NaN in State </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> - 'VillageId': </span><span class="si">{</span><span class="n">unique_groups_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="c1"># Fill 'Village Id' within groups with at least one non-NaN value</span>
    <span class="k">def</span> <span class="nf">fill_village_id</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">group</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># At least one non-NaN value</span>
            <span class="n">group</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'bfill'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'ffill'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="c1"># Apply the fill function to all groups</span>
    <span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fill_village_id</span><span class="p">)</span>
    <span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="s1">'VillageId'</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Reset indices for cleaner DataFrames</span>
    <span class="n">unmatched_NRDWP_df</span> <span class="o">=</span> <span class="n">unmatched_NRDWP_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">NRDWP_cdf</span> <span class="o">=</span> <span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">unmatched_NRDWP_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_Unmatched_NRDWP_data.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">NRDWP_cdf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_Matched_NRDWP_data.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Number of unique groups with all NaN in State ANDHRA PRADESH - 'VillageId': 513
Number of unique groups with all NaN in State ARUNACHAL PRADESH - 'VillageId': 927
Number of unique groups with all NaN in State ASSAM - 'VillageId': 351
Number of unique groups with all NaN in State Andaman &amp; Nicobar Islands - 'VillageId': 1
Number of unique groups with all NaN in State BIHAR - 'VillageId': 700
Number of unique groups with all NaN in State CHATTISGARH - 'VillageId': 145
Number of unique groups with all NaN in State CHHATTISGARH - 'VillageId': 197
Number of unique groups with all NaN in State GOA - 'VillageId': 0
Number of unique groups with all NaN in State GUJARAT - 'VillageId': 415
Number of unique groups with all NaN in State HARYANA - 'VillageId': 506
Number of unique groups with all NaN in State HIMACHAL PRADESH - 'VillageId': 314
Number of unique groups with all NaN in State JAMMU &amp; KASHMIR - 'VillageId': 10
Number of unique groups with all NaN in State JAMMU AND KASHMIR - 'VillageId': 121
Number of unique groups with all NaN in State JHARKHAND - 'VillageId': 280
Number of unique groups with all NaN in State KARNATAKA - 'VillageId': 140
Number of unique groups with all NaN in State KERALA - 'VillageId': 97
Number of unique groups with all NaN in State MADHYA PRADESH - 'VillageId': 935
Number of unique groups with all NaN in State MAHARASHTRA - 'VillageId': 647
Number of unique groups with all NaN in State MANIPUR - 'VillageId': 77
Number of unique groups with all NaN in State MEGHALAYA - 'VillageId': 206
Number of unique groups with all NaN in State MIZORAM - 'VillageId': 111
Number of unique groups with all NaN in State NAGALAND - 'VillageId': 90
Number of unique groups with all NaN in State ODISHA - 'VillageId': 353
Number of unique groups with all NaN in State ORISSA - 'VillageId': 269
Number of unique groups with all NaN in State PUDUCHERRY - 'VillageId': 0
Number of unique groups with all NaN in State PUNJAB - 'VillageId': 379
Number of unique groups with all NaN in State RAJASTHAN - 'VillageId': 352
Number of unique groups with all NaN in State SIKKIM - 'VillageId': 3
Number of unique groups with all NaN in State TAMIL NADU - 'VillageId': 98
Number of unique groups with all NaN in State TELANGANA - 'VillageId': 229
Number of unique groups with all NaN in State TRIPURA - 'VillageId': 26
Number of unique groups with all NaN in State UTTAR PRADESH - 'VillageId': 674
Number of unique groups with all NaN in State UTTARAKHAND - 'VillageId': 163
Number of unique groups with all NaN in State WEST BENGAL - 'VillageId': 29
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6fbebca6-fa5b-4d08-bec9-94b4218b95f3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="merge-statewise"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
Remerging the All the Seprate States Matched Data togethor and named it as <b>NRDWP_India_Matched.csv</b>. 
For Unmatched states data, we'll deal with it in seprate section <i><b><a href="#unmatched-data-preprocessing">Preprocessing Unmatched NRDWP Data</a></b></i> using Fuzzy Matching
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=50171990-8da0-4be3-8dd7-e8f15fbe9cba">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">statelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span><span class="s1">'ARUNACHAL PRADESH'</span><span class="p">,</span><span class="s1">'ASSAM'</span><span class="p">,</span><span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span><span class="s1">'BIHAR'</span><span class="p">,</span><span class="s1">'CHATTISGARH'</span><span class="p">,</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span><span class="s1">'GOA'</span><span class="p">,</span>
              <span class="s1">'GUJARAT'</span><span class="p">,</span> <span class="s1">'HARYANA'</span><span class="p">,</span> <span class="s1">'HIMACHAL PRADESH'</span><span class="p">,</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span> <span class="s1">'JAMMU AND KASHMIR'</span><span class="p">,</span> <span class="s1">'JHARKHAND'</span><span class="p">,</span> <span class="s1">'KARNATAKA'</span><span class="p">,</span> <span class="s1">'KERALA'</span><span class="p">,</span> 
              <span class="s1">'MADHYA PRADESH'</span><span class="p">,</span> <span class="s1">'MAHARASHTRA'</span><span class="p">,</span> <span class="s1">'MANIPUR'</span><span class="p">,</span>  <span class="s1">'MEGHALAYA'</span><span class="p">,</span>  <span class="s1">'MIZORAM'</span><span class="p">,</span>  <span class="s1">'NAGALAND'</span><span class="p">,</span>  <span class="s1">'ODISHA'</span><span class="p">,</span> <span class="s1">'ORISSA'</span><span class="p">,</span> <span class="s1">'PUDUCHERRY'</span><span class="p">,</span>
              <span class="s1">'PUNJAB'</span><span class="p">,</span> <span class="s1">'RAJASTHAN'</span><span class="p">,</span> <span class="s1">'SIKKIM'</span><span class="p">,</span> <span class="s1">'TAMIL NADU'</span><span class="p">,</span> <span class="s1">'TELANGANA'</span><span class="p">,</span> <span class="s1">'TRIPURA'</span><span class="p">,</span> <span class="s1">'UTTAR PRADESH'</span><span class="p">,</span> <span class="s1">'UTTARAKHAND'</span><span class="p">,</span> <span class="s1">'WEST BENGAL'</span><span class="p">]</span>

<span class="n">statelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">NRDWP_mcdf</span><span class="o">.</span><span class="n">StateName</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>

<span class="n">statematched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Iterate over each state</span>
<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">statelist</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_Matched_NRDWP_data.csv"</span>
    <span class="n">state_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">statematched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">statematched_csv</span><span class="p">,</span> <span class="n">state_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">statematched_csv</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_India_Matched.csv"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">statematched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>1692897</td>
<td>0.0</td>
<td>25.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>1692897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>21.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>25296626</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296627</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296628</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296629</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296630</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
</tbody>
</table>
<p>25296631 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=d8552f84-06c1-4388-9be2-28fa6219926e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=be4ab0b4-6cff-441b-a9e6-37635269fa93">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Aggregating NRDWP Data to Village Level
</div>
<p><a id="nrdwp-aggregation"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
<p>After filling the <b>Village ID</b> for habitations, the next step involves dropping the habitation-level information (e.g., habitation names) and aggregating the dataset at the <b>village level</b> from its current habitation-level format.</p>
<p>This process ensures that the dataset is structured at the desired granularity, with each row representing a unique <b>Village ID</b>, and all habitation-level data is aggregated accordingly. Below are the key steps:</p>
<ul>
<li><b>Drop habitation-level columns:</b> Remove columns such as <b>Habitation Name</b> or other non-relevant details that are no longer needed after the merge.</li>
<li><b>Group by Village ID:</b> Aggregate the dataset at the <b>Village ID</b> level using appropriate aggregation functions for numerical or categorical columns:
        <pre>
# Group by 'VillageId' and aggregate
village_level_df = NRDWP_cdf.groupby('VillageId').agg({
    'WaterQualityParameter1': 'mean',   # Example: Take mean of numerical data
    'WaterQualityParameter2': 'sum',   # Example: Take sum of numerical data
    'Typeofsource': lambda x: ', '.join(set(x)),  # Taking Maximum occuring values for categorical data
    ...
}).reset_index()
        </pre>
</li>
<li><b>Reset the index:</b> Ensure that the resulting DataFrame has a flat structure with <b>Village ID</b> as a column rather than an index.</li>
</ul>
<p>The resulting dataset will now be at the <b>village level</b>, ready for further analysis.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=add57ba5-d91c-40d5-8cf6-23476f8affc3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
<span class="n">statematched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_India_Matched.csv"</span><span class="p">)</span>
<span class="n">statematched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>Delivery Point</td>
<td>1692897</td>
<td>0.0</td>
<td>25.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.2</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>ANKOLI(1924203026011700)</td>
<td>NaN</td>
<td>1692897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>21.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>25.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>10.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>ADILABAD(19)</td>
<td>ADILABAD(03)</td>
<td>ANKOLI(17)</td>
<td>ANKOLI(026)</td>
<td>SIRIKONDA(1924203026021700)</td>
<td>Delivery Point</td>
<td>50844</td>
<td>0.0</td>
<td>20.0</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>26.0</td>
<td>2010</td>
<td>3</td>
<td>20031.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>25296626</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>40.0</td>
<td>1.88</td>
<td>NaN</td>
<td>0.34</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296627</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>6.0</td>
<td>27.0</td>
<td>3.01</td>
<td>NaN</td>
<td>0.33</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296628</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>7.0</td>
<td>26.0</td>
<td>1.05</td>
<td>NaN</td>
<td>0.29</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296629</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>8.0</td>
<td>26.0</td>
<td>1.50</td>
<td>NaN</td>
<td>0.21</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
<tr>
<th>25296630</th>
<td>WEST BENGAL</td>
<td>UTTAR DINAJPUR</td>
<td>RAIGANJ</td>
<td>SITGRAM</td>
<td>TENRA</td>
<td>TENGRA</td>
<td>Deep Tubewell</td>
<td>1283887</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>3.0</td>
<td>15.0</td>
<td>0.45</td>
<td>NaN</td>
<td>0.16</td>
<td>NaN</td>
<td>2018</td>
<td>11</td>
<td>484484.0</td>
</tr>
</tbody>
</table>
<p>25296631 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4e322b20-70ea-45b4-a4ce-9f34648e68a2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">statematched_csv</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>Index(['StateName', 'DistrictName', 'BlockName', 'PanchayatName',
       'VillageName', 'HabitationName', 'TypeOfSource', 'HabitationId',
       'Nitrate', 'Chloride', 'Fluoride', 'Arsenic', 'E.Coli',
       'Total Coliform', 'Iron', 'Magnesium', 'Manganese', 'Sulphates', 'Year',
       'Month', 'VillageId'],
      dtype='object')</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a8bf23c1-4ed3-48fa-acc6-26ab73bfc463">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
<b>Below code takes about 25-30 Minutes to execute</b>. It could be possible optimised if required
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2f374c11-c61c-4523-8930-18194894d694">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Defining the pollutant columns</span>
<span class="n">pollutant_columns</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span>
                      <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> <span class="s1">'Manganese'</span><span class="p">,</span> <span class="s1">'Sulphates'</span><span class="p">]</span>

<span class="c1"># Converting all Pollutans column to Numeric</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">:</span>
    <span class="n">statematched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">statematched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
        
<span class="c1"># Defining the aggregation logic</span>
<span class="n">aggregation_logic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">aggregation_logic</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="p">[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">}</span>
<span class="n">aggregation_logic</span><span class="p">[</span><span class="s1">'TypeOfSource'</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># Most frequent value</span>

<span class="c1"># Performing the aggregation</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">statematched_csv</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'VillageId'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggregation_logic</span><span class="p">)</span>

<span class="c1"># Flattening the multi-level column index after aggregation</span>
<span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="c1"># Rename the columns for clarity</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'TypeOfSource &lt;lambda&gt;'</span> <span class="p">:</span> <span class="s1">'Source_type'</span><span class="p">})</span>

<span class="c1"># Reset the index for a flat dataframe</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">aggregated_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Total Coliform max</th>
<th>Iron mean</th>
<th>Iron max</th>
<th>Magnesium mean</th>
<th>Magnesium max</th>
<th>Manganese mean</th>
<th>Manganese max</th>
<th>Sulphates mean</th>
<th>Sulphates max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5.0</td>
<td>2010</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>290.000000</td>
<td>290.0</td>
<td>2.400000</td>
<td>2.40</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.20</td>
<td>0.2</td>
<td>98.10</td>
<td>98.1</td>
<td>NaN</td>
<td>NaN</td>
<td>30.4</td>
<td>30.4</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>1</th>
<td>5.0</td>
<td>2010</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>188.666667</td>
<td>340.0</td>
<td>0.666667</td>
<td>0.80</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.15</td>
<td>0.2</td>
<td>55.40</td>
<td>68.1</td>
<td>NaN</td>
<td>NaN</td>
<td>45.6</td>
<td>64.0</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>2</th>
<td>5.0</td>
<td>2010</td>
<td>12</td>
<td>NaN</td>
<td>NaN</td>
<td>98.000000</td>
<td>98.0</td>
<td>0.600000</td>
<td>0.60</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.10</td>
<td>0.1</td>
<td>41.70</td>
<td>41.7</td>
<td>NaN</td>
<td>NaN</td>
<td>24.8</td>
<td>24.8</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>3</th>
<td>5.0</td>
<td>2011</td>
<td>6</td>
<td>NaN</td>
<td>NaN</td>
<td>106.000000</td>
<td>118.0</td>
<td>0.600000</td>
<td>0.60</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.20</td>
<td>0.2</td>
<td>72.75</td>
<td>91.1</td>
<td>NaN</td>
<td>NaN</td>
<td>31.2</td>
<td>36.0</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>4</th>
<td>5.0</td>
<td>2011</td>
<td>8</td>
<td>NaN</td>
<td>NaN</td>
<td>106.000000</td>
<td>108.0</td>
<td>0.800000</td>
<td>0.80</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.40</td>
<td>0.4</td>
<td>56.20</td>
<td>75.5</td>
<td>NaN</td>
<td>NaN</td>
<td>20.0</td>
<td>22.4</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>5455199</th>
<td>704936.0</td>
<td>2017</td>
<td>1</td>
<td>10.0</td>
<td>10.0</td>
<td>24.000000</td>
<td>24.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>50.7</td>
<td>50.7</td>
<td>Canal</td>
</tr>
<tr>
<th>5455200</th>
<td>704936.0</td>
<td>2017</td>
<td>5</td>
<td>10.0</td>
<td>10.0</td>
<td>70.000000</td>
<td>70.0</td>
<td>0.100000</td>
<td>0.10</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>70.0</td>
<td>70.0</td>
<td>Canal</td>
</tr>
<tr>
<th>5455201</th>
<td>704936.0</td>
<td>2017</td>
<td>6</td>
<td>5.0</td>
<td>5.0</td>
<td>37.500000</td>
<td>40.0</td>
<td>0.205000</td>
<td>0.21</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.10</td>
<td>0.1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>77.0</td>
<td>89.0</td>
<td>Canal</td>
</tr>
<tr>
<th>5455202</th>
<td>704936.0</td>
<td>2017</td>
<td>10</td>
<td>10.0</td>
<td>10.0</td>
<td>60.000000</td>
<td>60.0</td>
<td>0.500000</td>
<td>0.50</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Canal</td>
</tr>
<tr>
<th>5455203</th>
<td>704936.0</td>
<td>2017</td>
<td>11</td>
<td>15.0</td>
<td>15.0</td>
<td>40.000000</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Canal</td>
</tr>
</tbody>
</table>
<p>5455204 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=a6cf666e-899d-4867-8ffb-af646e679433">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=7db91208-cf47-4a4c-8e8b-c5bec516c4dc">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">aggregated_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_2009 - 2019_Preprocessed.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=90e85cc0-80ee-42dd-8f51-88ba09ae62df">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5c8926db-0d94-4b3a-81d0-3b90d5b58f43">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Combining only Matched NRDWP data and JJM Datasets. (Unmatched NRDWP data is processed using Fuzzy Matching in further section)
</div>
<p><a id="concatenate-datasets"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
<p>The next step involves concatenating the datasets <b>NRDWP_2009-2019_Preprocessed.csv</b> and <b>JJM_2021-2024_Preprocessed.csv</b> after ensuring that their column names are consistent.</p>
<p>This combined dataset represents the <b>JJM-NRDWP Water Quality data</b>, which has been perfectly mapped using <b>IDs</b>, leaving no room for errors due to fuzzy matching.</p>
<p>After concatenation, we proceed with the following steps:</p>
<ul>
<li><b>Integrate State and District information:</b> Using the <b>Master Data</b> file, which contains the mapping of all villages to their respective <b>State IDs, State Names, and District IDs</b>, we enrich the combined dataset.</li>
<li><b>Final verification:</b> Verify that all villages have been mapped correctly to their respective states and districts to ensure data consistency.</li>
</ul>
<p>This process results in a comprehensive and accurate dataset ready for further analysis</p>
<p><a id="unmatched-fuzzy-note"></a>
<b> Note - </b> <i>We'll also merge the unmatched NRDWP Data in last after operation on it using Fuzzy Matching.</i>or modeling.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9a5f75ba-48f1-45d3-be4a-268e9dc389cb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
<span class="n">NRDWP_with_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/NRDWP_2009 - 2019_Preprocessed.csv"</span><span class="p">)</span>
<span class="n">JJM_with_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/JJM_2021 - 2024_Preprocessed.csv"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"NRDWP_with_ID_df columns</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">NRDWP_with_ID_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">JJM_with_ID_df columns</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">JJM_with_ID_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>NRDWP_with_ID_df columns
 Index(['VillageId', 'Year', 'Month', 'Nitrate mean', 'Nitrate max',
       'Chloride mean', 'Chloride max', 'Fluoride mean', 'Fluoride max',
       'Arsenic mean', 'Arsenic max', 'E.Coli mean', 'E.Coli max',
       'Total Coliform mean', 'Total Coliform max', 'Iron mean', 'Iron max',
       'Magnesium mean', 'Magnesium max', 'Manganese mean', 'Manganese max',
       'Sulphates mean', 'Sulphates max', 'Source_type'],
      dtype='object')

JJM_with_ID_df columns
 Index(['VillageID', 'Year', 'Month', 'Fluoride (as F) mean',
       'Fluoride (as F) max', 'Chloride (as Cl) mean', 'Chloride (as Cl) max',
       'Nitrate (as NO3) mean', 'Nitrate (as NO3) max',
       'Magnesium (As Mg) mean', 'Magnesium (As Mg) max',
       'Sulphate (as SO4) mean', 'Sulphate (as SO4) max',
       'Total Arsenic (As As) mean', 'Total Arsenic (As As) max',
       'Iron (As Fe) mean', 'Iron (As Fe) max', 'Manganese (As Mn) mean',
       'Manganese (As Mn) max', 'Total coliform mean', 'Total coliform max',
       'E Coli mean', 'E Coli max', 'Source_type'],
      dtype='object')
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=ec2127d9-a5e9-451f-9f2d-1b5d1049b6e7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=135d0ea0-2f40-4fb0-aace-106b77d7a34a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define a mapping from JJM column names to NRDWP column names</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'VillageID'</span><span class="p">:</span> <span class="s1">'VillageId'</span><span class="p">,</span>
    <span class="s1">'Fluoride (as F) mean'</span><span class="p">:</span> <span class="s1">'Fluoride mean'</span><span class="p">,</span>
    <span class="s1">'Fluoride (as F) max'</span><span class="p">:</span> <span class="s1">'Fluoride max'</span><span class="p">,</span>
    <span class="s1">'Chloride (as Cl) mean'</span><span class="p">:</span> <span class="s1">'Chloride mean'</span><span class="p">,</span>
    <span class="s1">'Chloride (as Cl) max'</span><span class="p">:</span> <span class="s1">'Chloride max'</span><span class="p">,</span>
    <span class="s1">'Nitrate (as NO3) mean'</span><span class="p">:</span> <span class="s1">'Nitrate mean'</span><span class="p">,</span>
    <span class="s1">'Nitrate (as NO3) max'</span><span class="p">:</span> <span class="s1">'Nitrate max'</span><span class="p">,</span>
    <span class="s1">'Magnesium (As Mg) mean'</span><span class="p">:</span> <span class="s1">'Magnesium mean'</span><span class="p">,</span>
    <span class="s1">'Magnesium (As Mg) max'</span><span class="p">:</span> <span class="s1">'Magnesium max'</span><span class="p">,</span>
    <span class="s1">'Sulphate (as SO4) mean'</span><span class="p">:</span> <span class="s1">'Sulphates mean'</span><span class="p">,</span>
    <span class="s1">'Sulphate (as SO4) max'</span><span class="p">:</span> <span class="s1">'Sulphates max'</span><span class="p">,</span>
    <span class="s1">'Total Arsenic (As As) mean'</span><span class="p">:</span> <span class="s1">'Arsenic mean'</span><span class="p">,</span>
    <span class="s1">'Total Arsenic (As As) max'</span><span class="p">:</span> <span class="s1">'Arsenic max'</span><span class="p">,</span>
    <span class="s1">'Iron (As Fe) mean'</span><span class="p">:</span> <span class="s1">'Iron mean'</span><span class="p">,</span>
    <span class="s1">'Iron (As Fe) max'</span><span class="p">:</span> <span class="s1">'Iron max'</span><span class="p">,</span>
    <span class="s1">'Manganese (As Mn) mean'</span><span class="p">:</span> <span class="s1">'Manganese mean'</span><span class="p">,</span>
    <span class="s1">'Manganese (As Mn) max'</span><span class="p">:</span> <span class="s1">'Manganese max'</span><span class="p">,</span>
    <span class="s1">'Total coliform mean'</span><span class="p">:</span> <span class="s1">'Total Coliform mean'</span><span class="p">,</span>
    <span class="s1">'Total coliform max'</span><span class="p">:</span> <span class="s1">'Total Coliform max'</span><span class="p">,</span>
    <span class="s1">'E Coli mean'</span><span class="p">:</span> <span class="s1">'E.Coli mean'</span><span class="p">,</span>
    <span class="s1">'E Coli max'</span><span class="p">:</span> <span class="s1">'E.Coli max'</span>
<span class="p">}</span>

<span class="c1"># Rename the columns in JJM_with_ID_df</span>
<span class="n">JJM_with_ID_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Verify the changes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Updated JJM_with_ID_df"</span><span class="p">)</span>
<span class="n">JJM_with_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Updated JJM_with_ID_df
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Magnesium mean</th>
<th>...</th>
<th>Arsenic max</th>
<th>Iron mean</th>
<th>Iron max</th>
<th>Manganese mean</th>
<th>Manganese max</th>
<th>Total Coliform mean</th>
<th>Total Coliform max</th>
<th>E.Coli mean</th>
<th>E.Coli max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>2021</td>
<td>6</td>
<td>0.4325</td>
<td>0.52</td>
<td>100.6725</td>
<td>167.32</td>
<td>17.45</td>
<td>22.4</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0575</td>
<td>0.11</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2023</td>
<td>1</td>
<td>0.3900</td>
<td>0.39</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>2023</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>2023</td>
<td>3</td>
<td>0.3540</td>
<td>0.38</td>
<td>111.1640</td>
<td>173.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>2023</td>
<td>6</td>
<td>0.3825</td>
<td>0.42</td>
<td>109.8900</td>
<td>161.65</td>
<td>7.80</td>
<td>8.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0275</td>
<td>0.04</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4282074</th>
<td>704970</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282075</th>
<td>704971</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282076</th>
<td>704972</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>4282077</th>
<td>704973</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>4282078</th>
<td>704974</td>
<td>2024</td>
<td>9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>Delivery points</td>
</tr>
</tbody>
</table>
<p>4282079 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=8ca12ce3-e048-496f-85eb-4271dafb914e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># COncatenation</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2ff689b3-e694-41e5-b582-fc76dd807735">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">NRDWP_with_ID_df</span><span class="p">,</span> <span class="n">JJM_with_ID_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">,</span> <span class="s1">'VillageId'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">WQ_combined_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Total Coliform max</th>
<th>Iron mean</th>
<th>Iron max</th>
<th>Magnesium mean</th>
<th>Magnesium max</th>
<th>Manganese mean</th>
<th>Manganese max</th>
<th>Sulphates mean</th>
<th>Sulphates max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>32991</th>
<td>2642.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>320.000000</td>
<td>320.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33057</th>
<td>2647.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>71.000000</td>
<td>92.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33074</th>
<td>2648.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>92.333333</td>
<td>140.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33088</th>
<td>2649.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>158.000000</td>
<td>172.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33101</th>
<td>2650.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.10</td>
<td>0.30</td>
<td>256.000000</td>
<td>540.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9736534</th>
<td>702238.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery points</td>
</tr>
<tr>
<th>9736651</th>
<td>702616.0</td>
<td>2025</td>
<td>1</td>
<td>16.0</td>
<td>19.0</td>
<td>271.200000</td>
<td>405.0</td>
<td>0.080000</td>
<td>0.2</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>31.000000</td>
<td>36.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>9736796</th>
<td>703173.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Other sources including private</td>
</tr>
<tr>
<th>9736815</th>
<td>703355.0</td>
<td>2025</td>
<td>1</td>
<td>5.8</td>
<td>8.0</td>
<td>90.466667</td>
<td>124.0</td>
<td>0.433333</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>0.05</td>
<td>0.07</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>24.866667</td>
<td>29.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>9736969</th>
<td>703662.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery points</td>
</tr>
</tbody>
</table>
<p>9737283 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=b02b2f8f-182c-40ee-9209-08e50b3a3423">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=96dfad51-8d3b-4ea1-90de-be6280517384">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">WQ_combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Total Coliform max</th>
<th>Iron mean</th>
<th>Iron max</th>
<th>Magnesium mean</th>
<th>Magnesium max</th>
<th>Manganese mean</th>
<th>Manganese max</th>
<th>Sulphates mean</th>
<th>Sulphates max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>32991</th>
<td>2642.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>320.000000</td>
<td>320.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33057</th>
<td>2647.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>71.000000</td>
<td>92.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33074</th>
<td>2648.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>92.333333</td>
<td>140.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33088</th>
<td>2649.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>158.000000</td>
<td>172.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>33101</th>
<td>2650.0</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.10</td>
<td>0.30</td>
<td>256.000000</td>
<td>540.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9736534</th>
<td>702238.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery points</td>
</tr>
<tr>
<th>9736651</th>
<td>702616.0</td>
<td>2025</td>
<td>1</td>
<td>16.0</td>
<td>19.0</td>
<td>271.200000</td>
<td>405.0</td>
<td>0.080000</td>
<td>0.2</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>31.000000</td>
<td>36.0</td>
<td>Delivery points</td>
</tr>
<tr>
<th>9736796</th>
<td>703173.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Other sources including private</td>
</tr>
<tr>
<th>9736815</th>
<td>703355.0</td>
<td>2025</td>
<td>1</td>
<td>5.8</td>
<td>8.0</td>
<td>90.466667</td>
<td>124.0</td>
<td>0.433333</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>0.05</td>
<td>0.07</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>24.866667</td>
<td>29.0</td>
<td>Water supply scheme sources</td>
</tr>
<tr>
<th>9736969</th>
<td>703662.0</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery points</td>
</tr>
</tbody>
</table>
<p>9737283 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=8139f1e9-ca8d-4ff2-b5bc-f6c8e1271015">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/JJM-NRDWP-Drinking_WQ_Data.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=933f31ca-48da-4943-95b0-e7868d08e176">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">VillageId</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>600471</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=4136994e-fb77-4c68-8853-ae2f796188ad">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    To add Census Details in the combined data, Building Master Village ID Mapping
</div>
<p><a id="masterdata-issue"></a></p>
<div style="font-size: 28px; line-height: 1.8; text-align: justify;">
Now we need to add Census Village ID, State, and District level IDs from the Master Data. <b>The problem is that any single Master data is insufficient</b> as the latest Master Data does not account for Villages and Habitations which have undergone changes. In the latest API Village Level master data, we have significantly fewer unique villages than the actual count.
<p>To deal with this issue, we form our own Master Data using combinations of various datasets such as <b>B1 Basic Habitation</b>, API master data, and more to prepare an exhaustive list of Village IDs and their mapping to all required information for each Village ID.</p>
<p>Starting from the code below, we'll have numerous additional code cells to build that one Master data with complete mapping.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=a0f43c57-3b1a-468e-b1ee-34d5c4167575">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d0b401de-4fac-4a28-ad97-ce4d6271a374">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="start-b1"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
We'll start by using the biggest contributor of <b>Village ID and Necessary Details Mapping</b>, i.e., the <b>JJM 2019-24 B1 Basic Habitation Data</b>.
<p>We will read all its data and select only the necessary columns:</p>
<ul>
<li><b>State</b></li>
<li><b>StateId</b></li>
<li><b>District</b></li>
<li><b>DistrictId</b></li>
<li><b>Village</b></li>
<li><b>VillageId</b></li>
<li><b>Census Village Code</b></li>
</ul>
<p>We'll ensure to further choose only those datasets that can provide all these details along with the <b>Village ID</b>, so that we can expand the Village ID mapping comprehensively.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=6e7e169b-6e90-4331-aaa5-1b7f72361d27">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="s2">"Complete India B1"</span>
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Traverse all files and subdirectories</span>
<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Combine all dataframes</span>
<span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="p">[[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'StateId'</span><span class="p">,</span> <span class="s1">'District'</span><span class="p">,</span> <span class="s1">'DistrictId'</span><span class="p">,</span><span class="s1">'Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">,</span><span class="s1">'Census Village Code'</span><span class="p">]]</span>

<span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>

<span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'Census Village Code'</span><span class="p">,</span> <span class="s1">'StateId'</span><span class="p">,</span> <span class="s1">'DistrictId'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">])</span>

<span class="n">Hab_Vill_ID_B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Index(['S.No.', 'State', 'StateId', 'District', 'DistrictId', 'Block',
       'BlockId', 'Panchayat', 'PanchayatId', 'Village', 'Villageid',
       'Census Village Name', 'Census Village Code', 'Habitation',
       'Habitationid', 'Tot Pop', 'SC Pop', 'ST Pop', 'GEN Pop',
       'No. of House Holds', 'House Connection Provided as on 01/04/2019',
       'Houseconnection Provided in 2019-2020 including private connection',
       'Year', 'House Connection Provided as on 01/04/2020',
       'Houseconnection Provided in 2020-2021 including private connection',
       'House Connection Provided as on 01/04/2021',
       'Houseconnection Provided in 2021-2022 including private connection',
       'House Connection Provided as on 01/04/2022',
       'Houseconnection Provided in 2022-2023 including private connection',
       'House Connection Provided as on 01/04/2023',
       'Houseconnection Provided in 2023-2024 including private connection',
       'House Connection Provided as on 01/04/2024',
       'Houseconnection Provided in 2024-2025 including private connection',
       'Status', 'LPCD'],
      dtype='object')
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
</tr>
</thead>
<tbody>
<tr>
<th>5808967</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>6378228</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>8148183</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>33029</th>
<td>ANDHRA PRADESH</td>
<td>2</td>
<td>SRIKAKULAM</td>
<td>3</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>1627858</th>
<td>ANDHRA PRADESH</td>
<td>2</td>
<td>SRIKAKULAM</td>
<td>3</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7798464</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>Anantnag</td>
<td>177</td>
<td>Indermuni</td>
<td>704763</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800103</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Rawanpora</td>
<td>704898</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800592</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Tongiharan</td>
<td>704899</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800605</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Malbushan</td>
<td>704900</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800021</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Bon gund</td>
<td>704901</td>
<td>&lt;NA&gt;</td>
</tr>
</tbody>
</table>
<p>9503748 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=996c3c28-d544-4c6f-ab21-b5e3a4a36e6f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Handling Duplicates with Incomplete Data
</div>
<p><a id="drop-duplicate-care"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
A very important step, which could easily cause loss of mappings, is blindly dropping duplicates.
<p>As noted, in the previous step, we concatenated all the <b>B1 data</b> for each year, resulting in numerous rows and Village IDs being duplicated and repeated. Therefore, to drop duplicates while keeping only unique entries, we use the <b>drop_duplicates()</b> function.</p>
<p>However, an issue that can arise is that many rows have missing data in some columns. For instance lets imagine if:</p>
<ul>
<li>Row 5 and Row 10 contain repeated data for Village <b>A</b>.</li>
<li>Row 5 has missing <b>State</b> and <b>Census Village ID</b> for Village <b>A</b>, while Row 10 has this data available.</li>
<li>If we call the <b>drop_duplicates()</b> function without any precautions, Row 10 will be dropped by default, as the first duplicate (Row 5) is retained, causing a loss of valuable data.</li>
</ul>
<p>To address this issue, we first <b>sort the data</b> such that for the same duplicate rows, the version with the most complete data (i.e., maximum available data and minimum <b>NaNs</b>) is placed on top.</p>
<p>This sorting step is achieved using:</p>
<pre style="background-color: #f8f9fa; padding: 10px; border-radius: 5px;">Hab_Vill_ID_B1_df.sort_values(by=['Villageid', 'Census Village Code', 'StateId', 'DistrictId'], ascending=[True, False, False, False], inplace=True)</pre>
<p>After this sorting is complete, we can safely proceed with dropping duplicates without risking data loss.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=042ec3e0-66b5-4923-b621-0cd5d305b2ac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
</tr>
</thead>
<tbody>
<tr>
<th>5808967</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>5808968</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
</tr>
<tr>
<th>5808959</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
</tr>
<tr>
<th>5808946</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
</tr>
<tr>
<th>5808945</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7798464</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>Anantnag</td>
<td>177</td>
<td>Indermuni</td>
<td>704763</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800103</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Rawanpora</td>
<td>704898</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800592</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Tongiharan</td>
<td>704899</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800605</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Malbushan</td>
<td>704900</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>7800021</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>BARAMULLA</td>
<td>173</td>
<td>Bon gund</td>
<td>704901</td>
<td>&lt;NA&gt;</td>
</tr>
</tbody>
</table>
<p>620868 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=80d98d91-b8d1-470a-92dc-e03872356f89">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>State                  620868
StateId                619990
District               620868
DistrictId             619990
Village                620868
Villageid              620868
Census Village Code    613997
dtype: int64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=db34cf20-7a31-441e-88ba-5b7f65e0b45e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>60649
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=dc5508e7-295e-4676-8afd-72e0dcd69ccf">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
</tr>
</thead>
<tbody>
<tr>
<th>5808967</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
</tr>
<tr>
<th>5808968</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
</tr>
<tr>
<th>5808959</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
</tr>
<tr>
<th>5808946</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
</tr>
<tr>
<th>5808945</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7496613</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>BHILORAHI</td>
<td>703166</td>
<td>1910554</td>
</tr>
<tr>
<th>7496158</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>TARDIH</td>
<td>703168</td>
<td>1910577</td>
</tr>
<tr>
<th>7597452</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Unnao</td>
<td>482</td>
<td>SARAIYA</td>
<td>703171</td>
<td>1069617</td>
</tr>
<tr>
<th>6356103</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>KAKINADA</td>
<td>811</td>
<td>KIRLAMPUDI(016 )</td>
<td>703230</td>
<td>1670025</td>
</tr>
<tr>
<th>6796809</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh (ladakh)</td>
<td>178</td>
<td>PHULAK</td>
<td>703249</td>
<td>1740477</td>
</tr>
</tbody>
</table>
<p>582708 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ef08d92f-35b5-4025-b78c-e501dfbc0e10">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Adding Mappings from Master Village-Level Data
</div>
<p><a id="add-mdvl"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
Next, we use the <b>Master Data Village Level</b> to get additional Village ID mappings.
<p>As observed, this dataset contains approximately <b>5.84 lakh Village IDs</b>, whereas the actual count of villages with Water Quality (WQ) data exceeds <b>6.2 lakh villages</b>. This highlights the necessity of building a comprehensive Master Data.</p>
<p>After reading this mapping, we combine it with the previously extracted data. Subsequently, we drop duplicates in a very careful manner, as discussed earlier, ensuring no essential data is lost while maintaining data consistency and accuracy.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f6b46772-be53-453f-97d0-e9f0a3f66f50">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># MDVL ~ Master Data VIllage Level</span>
<span class="n">MDVL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"MasterData_AllState_VillageLevel.csv"</span><span class="p">)</span>
<span class="c1"># MDVL.columns ~ ['Stateid', 'LGD_Stateid', 'Census_State', 'Districtid',</span>
<span class="c1">#        'LGD_Districtid', 'Census_District', 'Blockid', 'LGD_Blockid',</span>
<span class="c1">#        'Panchayatid', 'LGD_Panchayatid', 'Villageid', 'LGD_Villageid',</span>
<span class="c1">#        'Census_Village', 'StateName', 'DistrictName', 'BlockName',</span>
<span class="c1">#        'PanchayatName', 'VillageName']</span>

<span class="n">MDVL</span> <span class="o">=</span> <span class="n">MDVL</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'Stateid'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'Districtid'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'Census_Village'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">]]</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'StateName'</span><span class="p">:</span> <span class="s1">'State'</span><span class="p">,</span>
    <span class="s1">'Stateid'</span><span class="p">:</span> <span class="s1">'StateId'</span><span class="p">,</span>
    <span class="s1">'DistrictName'</span><span class="p">:</span> <span class="s1">'District'</span><span class="p">,</span>
    <span class="s1">'Districtid'</span><span class="p">:</span> <span class="s1">'DistrictId'</span><span class="p">,</span>
    <span class="s1">'VillageName'</span><span class="p">:</span> <span class="s1">'Village'</span><span class="p">,</span>
    <span class="s1">'Villageid'</span><span class="p">:</span> <span class="s1">'Villageid'</span><span class="p">,</span>
    <span class="s1">'Census_Village'</span><span class="p">:</span> <span class="s1">'Census Village Code'</span> <span class="p">}</span>

<span class="n">MDVL</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">MDVL</span> <span class="o">=</span> <span class="n">MDVL</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">])</span>
<span class="n">MDVL</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">]</span> <span class="o">=</span> <span class="n">MDVL</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MDVL</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">MDVL</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 584353 entries, 0 to 584352
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                584353 non-null  object
 1   StateId              584353 non-null  int64 
 2   District             584353 non-null  object
 3   DistrictId           584353 non-null  int64 
 4   Village              584341 non-null  object
 5   Villageid            584353 non-null  int64 
 6   Census Village Code  569242 non-null  object
 7   Census_State         584353 non-null  int64 
 8   Census_District      584353 non-null  int64 
dtypes: int64(5), object(4)
memory usage: 40.1+ MB
None
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>1</td>
<td>North And Middle Andaman</td>
<td>655</td>
<td>Desharatpur (rv)</td>
<td>608539</td>
<td>645352</td>
<td>35</td>
<td>639</td>
</tr>
<tr>
<th>1</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>1</td>
<td>North And Middle Andaman</td>
<td>655</td>
<td>Sitapur (rv)</td>
<td>608540</td>
<td>645353</td>
<td>35</td>
<td>639</td>
</tr>
<tr>
<th>2</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>1</td>
<td>North And Middle Andaman</td>
<td>655</td>
<td>Mithila (rv)</td>
<td>608541</td>
<td>645354</td>
<td>35</td>
<td>639</td>
</tr>
<tr>
<th>3</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>1</td>
<td>North And Middle Andaman</td>
<td>655</td>
<td>Rangat (rv)</td>
<td>608542</td>
<td>645355</td>
<td>35</td>
<td>639</td>
</tr>
<tr>
<th>4</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>1</td>
<td>North And Middle Andaman</td>
<td>655</td>
<td>Amkunj (rv)</td>
<td>608543</td>
<td>645349</td>
<td>35</td>
<td>639</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>584348</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh Ladakh</td>
<td>178</td>
<td>KHEMA KHUNGRI</td>
<td>696946</td>
<td>&lt;NA&gt;</td>
<td>38</td>
<td>3</td>
</tr>
<tr>
<th>584349</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Gailing</td>
<td>640119</td>
<td>1048</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>584350</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Stakpa</td>
<td>640072</td>
<td>1040</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>584351</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Shargole</td>
<td>644747</td>
<td>1017</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>584352</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh Ladakh</td>
<td>178</td>
<td>TURTUK YOUL</td>
<td>694713</td>
<td>&lt;NA&gt;</td>
<td>38</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>584353 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=777db3b6-41ca-432c-9539-7234cd25c6e1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">MDVL</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">MDVL</span> <span class="o">=</span> <span class="n">MDVL</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">MDVL</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>37613
0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d853fdf0-210e-4639-8837-ac77c6ba00dc">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="concat-hab-mdvl"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<b>Concatenating Hab_Vill_ID_B1_df and MDVL</b><br/>
    We add the <b>Census_State</b> and <b>Census_District</b> column in Hab_Vill_ID_B1_df from MDVI so that both the df have same columns and would be easily concatenated. For this we form <code>MDVL_State_District = MDVL[['DistrictId', 'Census_State', 'Census_District']]</code> from MDVL dataframe and merge it with Hab_Vill_ID_B1_df using the common column <code>DistrictId</code>. 
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1c44f437-39a6-4ec4-834c-4ed69013ad2f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">MDVL_State_District</span> <span class="o">=</span> <span class="n">MDVL</span><span class="p">[[</span><span class="s1">'DistrictId'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">]]</span>

<span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'Census_State'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'Census_State'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'Census_District'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">MDVL_State_District</span><span class="p">[</span><span class="s1">'Census_District'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>

<span class="n">MDVL_State_District</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">MDVL_State_District</span> <span class="o">=</span> <span class="n">MDVL_State_District</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">MDVL_State_District</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>DistrictId</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>321187</th>
<td>850</td>
<td>8</td>
<td>840</td>
</tr>
<tr>
<th>320450</th>
<td>849</td>
<td>8</td>
<td>839</td>
</tr>
<tr>
<th>320320</th>
<td>848</td>
<td>8</td>
<td>837</td>
</tr>
<tr>
<th>320395</th>
<td>847</td>
<td>8</td>
<td>832</td>
</tr>
<tr>
<th>320368</th>
<td>846</td>
<td>8</td>
<td>833</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>791</th>
<td>5</td>
<td>37</td>
<td>544</td>
</tr>
<tr>
<th>265</th>
<td>4</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>266</th>
<td>3</td>
<td>37</td>
<td>542</td>
</tr>
<tr>
<th>16</th>
<td>2</td>
<td>35</td>
<td>638</td>
</tr>
<tr>
<th>40</th>
<td>1</td>
<td>35</td>
<td>640</td>
</tr>
</tbody>
</table>
<p>758 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=75da326d-a442-4bde-a309-e93762d6bf76">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hab_Vill_ID_B1_df</span> <span class="o">=</span> <span class="n">Hab_Vill_ID_B1_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">MDVL_State_District</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">)</span>
<span class="n">Hab_Vill_ID_B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[9]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582703</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>BHILORAHI</td>
<td>703166</td>
<td>1910554</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582704</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>TARDIH</td>
<td>703168</td>
<td>1910577</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582705</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Unnao</td>
<td>482</td>
<td>SARAIYA</td>
<td>703171</td>
<td>1069617</td>
<td>9</td>
<td>156</td>
</tr>
<tr>
<th>582706</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>KAKINADA</td>
<td>811</td>
<td>KIRLAMPUDI(016 )</td>
<td>703230</td>
<td>1670025</td>
<td>37</td>
<td>806</td>
</tr>
<tr>
<th>582707</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh (ladakh)</td>
<td>178</td>
<td>PHULAK</td>
<td>703249</td>
<td>1740477</td>
<td>38</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>582708 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d20ae4af-b6dd-4dd1-a8c4-66bd0503a6f5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Hab_Vill_ID_B1_df</span><span class="p">,</span> <span class="n">MDVL</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1139873</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Taisuru</td>
<td>138054</td>
<td>1058</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>1139874</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Rangdum</td>
<td>138061</td>
<td>1063</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>1139875</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Parkachik</td>
<td>138060</td>
<td>1062</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>1139876</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>PURTIKCHEY</td>
<td>640361</td>
<td>1049</td>
<td>38</td>
<td>4</td>
</tr>
<tr>
<th>1139877</th>
<td>Ladakh</td>
<td>37</td>
<td>Kargil</td>
<td>179</td>
<td>Stakpa</td>
<td>640072</td>
<td>1040</td>
<td>38</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>1139878 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=34bceb9e-a6b8-4b93-a4c1-01ba4921bfd2">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'Census Village Code'</span><span class="p">,</span> <span class="s1">'StateId'</span><span class="p">,</span> <span class="s1">'DistrictId'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">],</span>
                          <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582703</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>BHILORAHI</td>
<td>703166</td>
<td>1910554</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582704</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>TARDIH</td>
<td>703168</td>
<td>1910577</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582705</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Unnao</td>
<td>482</td>
<td>SARAIYA</td>
<td>703171</td>
<td>1069617</td>
<td>9</td>
<td>156</td>
</tr>
<tr>
<th>582706</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>KAKINADA</td>
<td>811</td>
<td>KIRLAMPUDI(016 )</td>
<td>703230</td>
<td>1670025</td>
<td>37</td>
<td>806</td>
</tr>
<tr>
<th>582707</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh (ladakh)</td>
<td>178</td>
<td>PHULAK</td>
<td>703249</td>
<td>1740477</td>
<td>38</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>590846 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=abfdb631-36f4-4a67-8610-095c218edfd7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 590846 entries, 0 to 582707
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                590846 non-null  object
 1   StateId              590416 non-null  Int64 
 2   District             590846 non-null  object
 3   DistrictId           590416 non-null  Int64 
 4   Village              590846 non-null  object
 5   Villageid            590846 non-null  Int64 
 6   Census Village Code  590845 non-null  object
 7   Census_State         590371 non-null  Int64 
 8   Census_District      590371 non-null  Int64 
dtypes: Int64(5), object(4)
memory usage: 47.9+ MB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=057f0d40-48e1-4ea5-ad87-06ea56129fb3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>16276
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=0517e8b0-e07d-402c-93fa-b0c01cafe67f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582703</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>BHILORAHI</td>
<td>703166</td>
<td>1910554</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582704</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>TARDIH</td>
<td>703168</td>
<td>1910577</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582705</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Unnao</td>
<td>482</td>
<td>SARAIYA</td>
<td>703171</td>
<td>1069617</td>
<td>9</td>
<td>156</td>
</tr>
<tr>
<th>582706</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>KAKINADA</td>
<td>811</td>
<td>KIRLAMPUDI(016 )</td>
<td>703230</td>
<td>1670025</td>
<td>37</td>
<td>806</td>
</tr>
<tr>
<th>582707</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh (ladakh)</td>
<td>178</td>
<td>PHULAK</td>
<td>703249</td>
<td>1740477</td>
<td>38</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>582708 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9e14e61a-bfaa-42f8-a2b9-e4a22e2c2cf6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=646e55bb-4a9b-4390-8033-c7962295a2ae">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Addressing Missing Data in Village ID Mapping
</div>
<p><a id="missing-data-intuition"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
Now that we have a massive set of <b>5.8 lakh Village IDs</b> and their mapping to the required columns, the next step is to address missing data in the <b>StateID</b> and <b>DistrictID</b> columns, as these are necessary to have.
<p>We use a simple yet effective intuition:</p>
<ul>
<li>If any one of the villages belonging to a state already has the <b>State ID</b>, then any row for that same state can be given the same <b>State ID</b>.</li>
</ul>
<p>The challenge, however, is identifying rows that belong to the same state, since relying on state names is not viable due to numerous unknown spelling issues.</p>
<p>To resolve this, we take advantage of the <b>Census Village ID</b>. We merge the shapefile mapping of <b>Census Codes</b> to get the <b>Census State Code</b> and <b>Census District Code</b>.</p>
<p>With this mapping in place:</p>
<ul>
<li>If two rows have the same <b>Census State Code</b>, we can confirm they belong to the same state.</li>
<li>If one of these rows lacks a <b>StateID</b>, we can confidently assign it the same <b>StateID</b> as the other row with the common Census State Code.</li>
</ul>
<p>This approach ensures that missing <b>StateID</b> and <b>DistrictID</b> values are filled accurately without relying on inconsistent textual names, leveraging the reliability of Census codes.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=b9b88dcb-4e01-45b1-bbba-9ac38d00e9f9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span><span class="p">,</span> <span class="n">BoundaryNorm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">village_shapefile_path</span> <span class="o">=</span> <span class="s1">'Shapefiles ( SHRUG )/Village/village_modified.shp'</span> 
<span class="n">village_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">village_shapefile_path</span><span class="p">)</span>
<span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_tv_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_tv_id'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_s_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_s_id'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_d_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="p">[</span><span class="s1">'pc11_d_id'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">village_gdf</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'pc11_tv_id'</span><span class="p">:</span><span class="s1">'Census Village Code'</span><span class="p">,</span><span class="s1">'pc11_s_id'</span><span class="p">:</span><span class="s1">'Census_State'</span><span class="p">,</span><span class="s1">'pc11_d_id'</span><span class="p">:</span><span class="s1">'Census_District'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">village_gdf</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="p">[[</span><span class="s1">'Census Village Code'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">]]</span>
<span class="n">village_gdf</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">'first'</span><span class="p">)</span>
<span class="n">village_gdf</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">village_gdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>648873</th>
<td>645566</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648874</th>
<td>645567</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648875</th>
<td>645568</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648876</th>
<td>645569</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648877</th>
<td>645570</td>
<td>35</td>
<td>640</td>
</tr>
</tbody>
</table>
<p>648218 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=12166d7b-157f-49da-870c-577c6b9a896f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">village_gdf</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">village_gdf</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">village_gdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>648873</th>
<td>645566</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648874</th>
<td>645567</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648875</th>
<td>645568</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648876</th>
<td>645569</td>
<td>35</td>
<td>640</td>
</tr>
<tr>
<th>648877</th>
<td>645570</td>
<td>35</td>
<td>640</td>
</tr>
</tbody>
</table>
<p>648218 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=0c7fef97-67d5-473a-ba61-68313af5f733">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="census-code-mapping"></a>
<a id="missing-census-ids"></a>
<a id="update-census-ids"></a>
<a id="merge-filled-subset"></a>
<a id="careful-duplicate-dropping"></a>
<a id="district-grouping-fill"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;"><b># Here I am trying to see is how many such rows actually exist which have Census Village Code but no State or District ID.</b><br/>
To achieve the above-discussed steps, we proceed as follows:
<ol>
<li><p><strong>Filter Data with Missing Census State or District IDs:</strong></p>
<ul>
<li>First, we identify rows in our custom-made mapping of <b>5.8 lakh villages</b> (from <b>B1</b> and <b>Master Data</b>) that have <b>Census Village Codes</b> but lack <b>Census State</b> or <b>Census District IDs</b>.</li>
<li>These rows are separated out as a subset of the data for further processing.</li>
</ul>
</li>
<li><p><strong>Update Missing Census State and District IDs Using Shapefile:</strong></p>
<ul>
<li>For this subset of data, we drop the current (incomplete or incorrect) <b>Census State</b> and <b>Census District</b> columns.</li>
<li>Using the shapefile, we map and fill the missing data (Census State Code and Census District Code) for these rows.</li>
</ul>
</li>
<li><p><strong>Merge Back the Filled Subset:</strong></p>
<ul>
<li>After filling the subset properly, we add it back to the main custom-made mapping.</li>
<li>The combined data is then sorted to push rows with <b>NaN</b> values (in duplicate rows) to the bottom. This sorting ensures that rows with more complete information are prioritized.</li>
</ul>
</li>
<li><p><strong>Drop Duplicates Carefully:</strong></p>
<ul>
<li>With the sorted data, we drop duplicates while ensuring that the most complete version of a duplicate row is retained.</li>
</ul>
</li>
<li><p><strong>Group by Census District for Final Filling:</strong></p>
<ul>
<li>To address any remaining missing data, we group the dataset by <b>Census District</b>.</li>
<li>Within each group, we perform both <b>Backward Fill (bfill)</b> and <b>Forward Fill (ffill)</b> to fill empty cells using non-null data from other rows in the same district, leveraging the fact that they belong to the same district.</li>
</ul>
</li>
</ol>
<p>This approach ensures that missing <b>StateID</b> and <b>DistrictID</b> values are filled accurately and efficiently while preserving the integrit
y of the data.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=33fe9cc6-6b56-45df-ae46-cd6c12074824">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="p">[(</span><span class="n">Village_ID_df</span><span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> 
                   <span class="p">(</span><span class="n">Village_ID_df</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> 
                   <span class="p">(</span><span class="n">Village_ID_df</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[18]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>126368</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>SIRUR</td>
<td>141511</td>
<td>598865</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>126502</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>LOKAPUR</td>
<td>141655</td>
<td>598615</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>126577</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HAGANUR</td>
<td>141739</td>
<td>598723</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>126668</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HONNIHAL</td>
<td>141847</td>
<td>598529</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>126781</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>AMARAWADGI</td>
<td>141986</td>
<td>598955</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>577293</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KODAGU</td>
<td>&lt;NA&gt;</td>
<td>ARMERI</td>
<td>661883</td>
<td>618007</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>577951</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KOLAR</td>
<td>&lt;NA&gt;</td>
<td>KADUVANAPURA</td>
<td>664240</td>
<td>622284</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>578014</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kolar</td>
<td>&lt;NA&gt;</td>
<td>Melnur</td>
<td>664534</td>
<td>622158</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>578073</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Malambi Forest</td>
<td>665144</td>
<td>617904</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr>
<th>578074</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Jainkalbetta Forest</td>
<td>665145</td>
<td>617977</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
</tbody>
</table>
<p>430 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c5896cfd-481f-4554-be9f-c02215fb0c76">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="remove-nan-census"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<i>From above df, we'll remove the NaN Census_State and Census_District column and get better filled Census_State and Census_District column from village_gdf</i>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5cd6d77f-54c1-466b-8234-3111dc92eb4c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'StateId'</span><span class="p">,</span> <span class="s1">'District'</span><span class="p">,</span> <span class="s1">'DistrictId'</span><span class="p">,</span> <span class="s1">'Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">,</span><span class="s1">'Census Village Code'</span><span class="p">]]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[19]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
</tr>
</thead>
<tbody>
<tr>
<th>126368</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>SIRUR</td>
<td>141511</td>
<td>598865</td>
</tr>
<tr>
<th>126502</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>LOKAPUR</td>
<td>141655</td>
<td>598615</td>
</tr>
<tr>
<th>126577</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HAGANUR</td>
<td>141739</td>
<td>598723</td>
</tr>
<tr>
<th>126668</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HONNIHAL</td>
<td>141847</td>
<td>598529</td>
</tr>
<tr>
<th>126781</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>AMARAWADGI</td>
<td>141986</td>
<td>598955</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>577293</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KODAGU</td>
<td>&lt;NA&gt;</td>
<td>ARMERI</td>
<td>661883</td>
<td>618007</td>
</tr>
<tr>
<th>577951</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KOLAR</td>
<td>&lt;NA&gt;</td>
<td>KADUVANAPURA</td>
<td>664240</td>
<td>622284</td>
</tr>
<tr>
<th>578014</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kolar</td>
<td>&lt;NA&gt;</td>
<td>Melnur</td>
<td>664534</td>
<td>622158</td>
</tr>
<tr>
<th>578073</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Malambi Forest</td>
<td>665144</td>
<td>617904</td>
</tr>
<tr>
<th>578074</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Jainkalbetta Forest</td>
<td>665145</td>
<td>617977</td>
</tr>
</tbody>
</table>
<p>430 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ab1aa3c2-eb6a-4723-b2d7-626bd85a81b5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">village_gdf</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">"inner"</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[20]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>SIRUR</td>
<td>141511</td>
<td>598865</td>
<td>29</td>
<td>556</td>
</tr>
<tr>
<th>1</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>LOKAPUR</td>
<td>141655</td>
<td>598615</td>
<td>29</td>
<td>556</td>
</tr>
<tr>
<th>2</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HAGANUR</td>
<td>141739</td>
<td>598723</td>
<td>29</td>
<td>556</td>
</tr>
<tr>
<th>3</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>HONNIHAL</td>
<td>141847</td>
<td>598529</td>
<td>29</td>
<td>556</td>
</tr>
<tr>
<th>4</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>BAGALKOT</td>
<td>&lt;NA&gt;</td>
<td>AMARAWADGI</td>
<td>141986</td>
<td>598955</td>
<td>29</td>
<td>556</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>421</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KODAGU</td>
<td>&lt;NA&gt;</td>
<td>ARMERI</td>
<td>661883</td>
<td>618007</td>
<td>29</td>
<td>576</td>
</tr>
<tr>
<th>422</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KOLAR</td>
<td>&lt;NA&gt;</td>
<td>KADUVANAPURA</td>
<td>664240</td>
<td>622284</td>
<td>29</td>
<td>581</td>
</tr>
<tr>
<th>423</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kolar</td>
<td>&lt;NA&gt;</td>
<td>Melnur</td>
<td>664534</td>
<td>622158</td>
<td>29</td>
<td>581</td>
</tr>
<tr>
<th>424</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Malambi Forest</td>
<td>665144</td>
<td>617904</td>
<td>29</td>
<td>576</td>
</tr>
<tr>
<th>425</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Jainkalbetta Forest</td>
<td>665145</td>
<td>617977</td>
<td>29</td>
<td>576</td>
</tr>
</tbody>
</table>
<p>426 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6ce8b2db-694e-48a1-bb4b-9a90ac575f31">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<b><i>NOTE - Village_ID_df and village_gdf are different. Dont confuse in them</i></b>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=213adb5f-2aa3-4636-bf4e-fde38c0dfc8d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=edc9a7f3-930a-40a8-ab26-cb789eb0fa9e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<i>Putting back the subset we took from <b>Village_ID_df</b> as we have made it better using <b>village_gdf</b></i>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=acf93ac8-8cc5-4fa9-bedf-aff9b372b683">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Village_ID_df</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>583129</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KODAGU</td>
<td>&lt;NA&gt;</td>
<td>ARMERI</td>
<td>661883</td>
<td>618007</td>
<td>29</td>
<td>576</td>
</tr>
<tr>
<th>583130</th>
<td>KARNATAKA</td>
<td>&lt;NA&gt;</td>
<td>KOLAR</td>
<td>&lt;NA&gt;</td>
<td>KADUVANAPURA</td>
<td>664240</td>
<td>622284</td>
<td>29</td>
<td>581</td>
</tr>
<tr>
<th>583131</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kolar</td>
<td>&lt;NA&gt;</td>
<td>Melnur</td>
<td>664534</td>
<td>622158</td>
<td>29</td>
<td>581</td>
</tr>
<tr>
<th>583132</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Malambi Forest</td>
<td>665144</td>
<td>617904</td>
<td>29</td>
<td>576</td>
</tr>
<tr>
<th>583133</th>
<td>Karnataka</td>
<td>&lt;NA&gt;</td>
<td>Kodagu</td>
<td>&lt;NA&gt;</td>
<td>Jainkalbetta Forest</td>
<td>665145</td>
<td>617977</td>
<td>29</td>
<td>576</td>
</tr>
</tbody>
</table>
<p>583134 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=e3d45635-417d-4add-b29d-d4000febd38b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="filling-district-state-ids"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<i><b>Now Applying our algo we discussed to fill_District_id and to fill_State_id</b></i>
<p>NOTE - Dont confuse it with earlier step. Earlier step was to fill <b>Census_State and Census_District</b></p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=7e9e21b8-2b98-4ba8-982e-9b7d3df9ff69">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'Census Village Code'</span><span class="p">,</span> <span class="s1">'Census_State'</span><span class="p">,</span> <span class="s1">'Census_District'</span><span class="p">,</span> <span class="s1">'StateId'</span><span class="p">,</span> <span class="s1">'DistrictId'</span><span class="p">],</span>
                          <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[22]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>J.K.GUMADA</td>
<td>1</td>
<td>580778</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>V.V.R.PETA</td>
<td>2</td>
<td>580803</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>RAJULAGUMMADA</td>
<td>3</td>
<td>580780</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>KOPPARAVALASA</td>
<td>4</td>
<td>580782</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>Vizianagaram</td>
<td>4</td>
<td>BANGARUVALASA</td>
<td>5</td>
<td>580781</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582703</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>BHILORAHI</td>
<td>703166</td>
<td>1910554</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582704</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>GORAKHPUR</td>
<td>514</td>
<td>TARDIH</td>
<td>703168</td>
<td>1910577</td>
<td>9</td>
<td>188</td>
</tr>
<tr>
<th>582705</th>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Unnao</td>
<td>482</td>
<td>SARAIYA</td>
<td>703171</td>
<td>1069617</td>
<td>9</td>
<td>156</td>
</tr>
<tr>
<th>582706</th>
<td>Andhra Pradesh</td>
<td>2</td>
<td>KAKINADA</td>
<td>811</td>
<td>KIRLAMPUDI(016 )</td>
<td>703230</td>
<td>1670025</td>
<td>37</td>
<td>806</td>
</tr>
<tr>
<th>582707</th>
<td>Ladakh</td>
<td>37</td>
<td>Leh (ladakh)</td>
<td>178</td>
<td>PHULAK</td>
<td>703249</td>
<td>1740477</td>
<td>38</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>582708 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ef75ebf9-3b38-40f1-870c-01a8dee6e8d0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 582708 entries, 0 to 582707
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                582708 non-null  object
 1   StateId              582278 non-null  Int64 
 2   District             582708 non-null  object
 3   DistrictId           582278 non-null  Int64 
 4   Village              582708 non-null  object
 5   Villageid            582708 non-null  Int64 
 6   Census Village Code  582707 non-null  object
 7   Census_State         582659 non-null  Int64 
 8   Census_District      582659 non-null  Int64 
dtypes: Int64(5), object(4)
memory usage: 47.2+ MB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=835f9117-34e8-43ef-b812-2c71c3b9fcfa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Census_District'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">fill_District_id</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">group</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># At least one non-NaN value</span>
        <span class="n">group</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">'DistrictId'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'bfill'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'ffill'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">group</span>

<span class="c1"># Apply the fill function to all groups</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fill_District_id</span><span class="p">)</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[24]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>Rajasthan</td>
<td>27</td>
<td>Jaipur Gramin</td>
<td>841</td>
<td>Chak Nondpura</td>
<td>659538</td>
<td>80625</td>
<td>8</td>
<td>843</td>
</tr>
<tr>
<th>582655</th>
<td>Rajasthan</td>
<td>27</td>
<td>Jaipur Gramin</td>
<td>841</td>
<td>Chandsinghpura</td>
<td>660907</td>
<td>79695</td>
<td>8</td>
<td>843</td>
</tr>
<tr>
<th>582656</th>
<td>Rajasthan</td>
<td>27</td>
<td>Jaipur Gramin</td>
<td>841</td>
<td>Jhapok</td>
<td>661086</td>
<td>79649</td>
<td>8</td>
<td>843</td>
</tr>
<tr>
<th>582657</th>
<td>Rajasthan</td>
<td>27</td>
<td>Jaipur Gramin</td>
<td>841</td>
<td>Nagorpura</td>
<td>661087</td>
<td>79646</td>
<td>8</td>
<td>843</td>
</tr>
<tr>
<th>582658</th>
<td>Rajasthan</td>
<td>27</td>
<td>Jaipur Gramin</td>
<td>841</td>
<td>shyam nagar</td>
<td>662688</td>
<td>1889980</td>
<td>8</td>
<td>843</td>
</tr>
</tbody>
</table>
<p>582659 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=68fe8699-5c00-49cc-9d7b-9d5ec6930c1f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 582659 entries, 0 to 582658
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                582659 non-null  object
 1   StateId              582233 non-null  Int64 
 2   District             582659 non-null  object
 3   DistrictId           582659 non-null  Int64 
 4   Village              582659 non-null  object
 5   Villageid            582659 non-null  Int64 
 6   Census Village Code  582658 non-null  object
 7   Census_State         582659 non-null  Int64 
 8   Census_District      582659 non-null  Int64 
dtypes: Int64(5), object(4)
memory usage: 42.8+ MB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c38782fe-f032-4f07-8af4-18aced69b60f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Census_State'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">fill_State_id</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">group</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># At least one non-NaN value</span>
        <span class="n">group</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s1">'StateId'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'bfill'</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'ffill'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">group</span>

<span class="c1"># Apply the fill function to all groups</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fill_State_id</span><span class="p">)</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[26]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>JAMMU &amp; KASHMIR</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>DADRA &amp; NAGAR HAVELI</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582655</th>
<td>DADRA &amp; NAGAR HAVELI</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582656</th>
<td>DADRA &amp; NAGAR HAVELI</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582657</th>
<td>DADRA &amp; NAGAR HAVELI</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582658</th>
<td>DADRA &amp; NAGAR HAVELI</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992</td>
<td>39</td>
<td>496</td>
</tr>
</tbody>
</table>
<p>582659 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=87403020-919b-43bc-a4cd-9ea8be07f82c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 582659 entries, 0 to 582658
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                582659 non-null  object
 1   StateId              582659 non-null  Int64 
 2   District             582659 non-null  object
 3   DistrictId           582659 non-null  Int64 
 4   Village              582659 non-null  object
 5   Villageid            582659 non-null  Int64 
 6   Census Village Code  582658 non-null  object
 7   Census_State         582659 non-null  Int64 
 8   Census_District      582659 non-null  Int64 
dtypes: Int64(5), object(4)
memory usage: 42.8+ MB
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=4f45bc6a-a4bc-44c6-b94e-48fae3187e74">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Finalizing Village ID Mapping and Using in the merged NRDWP-JJM Dataset
</div>
<p><a id="standardize-state-names"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
Now that we have uniform data with equal counts available across all columns, we can proceed to use this as the final mapping for providing the necessary data to our <b>Water Quality data</b> by matching it using the <b>Village ID</b>.
<p>However, before proceeding, a small but essential step remains:</p>
<ul>
<li><strong>Standardize State Names:</strong><ul>
<li>Ensure uniformity in state names by resolving any variations such as differences in capitalization (e.g., "Madhya Pradesh" vs. "madhya pradesh").</li>
<li>All state names are converted to a consistent format (e.g., title case or uppercase).</li>
<li>This step avoids mismatches when merging data, as inconsistent naming conventions can lead to errors.</li>
</ul>
</li>
</ul>
<p>This ensures that the mapping is clean and ready for integration with the <b>Water Quality data</b> for further analysis or modeling.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c47fd455-353a-456a-9336-a1c3d3d21181">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[28]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array(['JAMMU &amp; KASHMIR', 'Jammu &amp; Kashmir', 'HIMACHAL PRADESH',
       'Himachal Pradesh', 'PUNJAB', 'Punjab', 'UTTARAKHAND',
       'Uttarakhand', 'HARYANA', 'Haryana', 'RAJASTHAN', 'Rajasthan',
       'UTTAR PRADESH', 'Uttar Pradesh', 'BIHAR', 'Bihar', 'Sikkim',
       'SIKKIM', 'ARUNACHAL PRADESH', 'Arunachal Pradesh', 'NAGALAND',
       'Nagaland', 'MANIPUR', 'MIZORAM', 'Mizoram', 'Tripura',
       'MEGHALAYA', 'Meghalaya', 'ASSAM', 'Assam', 'WEST BENGAL',
       'West Bengal', 'JHARKHAND', 'Jharkhand', 'ODISHA', 'Odisha',
       'CHHATTISGARH', 'Chhattisgarh', 'MADHYA PRADESH', 'Madhya Pradesh',
       'GUJARAT', 'Gujarat', 'MAHARASHTRA', 'Maharashtra', 'Karnataka',
       'KARNATAKA', 'Goa', 'Lakshadweep', 'KERALA', 'Kerala',
       'TAMIL NADU', 'Tamil Nadu', 'Puducherry',
       'Andaman &amp; Nicobar Islands', 'TELANGANA', 'Telangana',
       'ANDHRA PRADESH', 'Andhra Pradesh', 'LADAKH', 'Ladakh',
       'DADRA &amp; NAGAR HAVELI'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5af274fa-c4e8-46ed-b0c0-6cdfbab692c8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">state_name_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">:</span> <span class="s1">'Jammu &amp; Kashmir'</span><span class="p">,</span><span class="s1">'Jammu &amp; Kashmir'</span><span class="p">:</span> <span class="s1">'Jammu &amp; Kashmir'</span><span class="p">,</span>
    <span class="s1">'HIMACHAL PRADESH'</span><span class="p">:</span> <span class="s1">'Himachal Pradesh'</span><span class="p">,</span><span class="s1">'Himachal Pradesh'</span><span class="p">:</span> <span class="s1">'Himachal Pradesh'</span><span class="p">,</span>
    <span class="s1">'PUNJAB'</span><span class="p">:</span> <span class="s1">'Punjab'</span><span class="p">,</span><span class="s1">'Punjab'</span><span class="p">:</span> <span class="s1">'Punjab'</span><span class="p">,</span>
    <span class="s1">'UTTARAKHAND'</span><span class="p">:</span> <span class="s1">'Uttarakhand'</span><span class="p">,</span><span class="s1">'Uttarakhand'</span><span class="p">:</span> <span class="s1">'Uttarakhand'</span><span class="p">,</span>
    <span class="s1">'HARYANA'</span><span class="p">:</span> <span class="s1">'Haryana'</span><span class="p">,</span><span class="s1">'Haryana'</span><span class="p">:</span> <span class="s1">'Haryana'</span><span class="p">,</span>
    <span class="s1">'RAJASTHAN'</span><span class="p">:</span> <span class="s1">'Rajasthan'</span><span class="p">,</span><span class="s1">'Rajasthan'</span><span class="p">:</span> <span class="s1">'Rajasthan'</span><span class="p">,</span>
    <span class="s1">'UTTAR PRADESH'</span><span class="p">:</span> <span class="s1">'Uttar Pradesh'</span><span class="p">,</span><span class="s1">'Uttar Pradesh'</span><span class="p">:</span> <span class="s1">'Uttar Pradesh'</span><span class="p">,</span>
    <span class="s1">'BIHAR'</span><span class="p">:</span> <span class="s1">'Bihar'</span><span class="p">,</span><span class="s1">'Bihar'</span><span class="p">:</span> <span class="s1">'Bihar'</span><span class="p">,</span>
    <span class="s1">'SIKKIM'</span><span class="p">:</span> <span class="s1">'Sikkim'</span><span class="p">,</span><span class="s1">'Sikkim'</span><span class="p">:</span> <span class="s1">'Sikkim'</span><span class="p">,</span>
    <span class="s1">'ARUNACHAL PRADESH'</span><span class="p">:</span> <span class="s1">'Arunachal Pradesh'</span><span class="p">,</span><span class="s1">'Arunachal Pradesh'</span><span class="p">:</span> <span class="s1">'Arunachal Pradesh'</span><span class="p">,</span>
    <span class="s1">'NAGALAND'</span><span class="p">:</span> <span class="s1">'Nagaland'</span><span class="p">,</span><span class="s1">'Nagaland'</span><span class="p">:</span> <span class="s1">'Nagaland'</span><span class="p">,</span>
    <span class="s1">'MANIPUR'</span><span class="p">:</span> <span class="s1">'Manipur'</span><span class="p">,</span><span class="s1">'Manipur'</span><span class="p">:</span> <span class="s1">'Manipur'</span><span class="p">,</span>
    <span class="s1">'MIZORAM'</span><span class="p">:</span> <span class="s1">'Mizoram'</span><span class="p">,</span><span class="s1">'Mizoram'</span><span class="p">:</span> <span class="s1">'Mizoram'</span><span class="p">,</span>
    <span class="s1">'Tripura'</span><span class="p">:</span> <span class="s1">'Tripura'</span><span class="p">,</span>
    <span class="s1">'MEGHALAYA'</span><span class="p">:</span> <span class="s1">'Meghalaya'</span><span class="p">,</span><span class="s1">'Meghalaya'</span><span class="p">:</span> <span class="s1">'Meghalaya'</span><span class="p">,</span>
    <span class="s1">'ASSAM'</span><span class="p">:</span> <span class="s1">'Assam'</span><span class="p">,</span><span class="s1">'Assam'</span><span class="p">:</span> <span class="s1">'Assam'</span><span class="p">,</span>
    <span class="s1">'WEST BENGAL'</span><span class="p">:</span> <span class="s1">'West Bengal'</span><span class="p">,</span><span class="s1">'West Bengal'</span><span class="p">:</span> <span class="s1">'West Bengal'</span><span class="p">,</span>
    <span class="s1">'JHARKHAND'</span><span class="p">:</span> <span class="s1">'Jharkhand'</span><span class="p">,</span><span class="s1">'Jharkhand'</span><span class="p">:</span> <span class="s1">'Jharkhand'</span><span class="p">,</span>
    <span class="s1">'ODISHA'</span><span class="p">:</span> <span class="s1">'Odisha'</span><span class="p">,</span><span class="s1">'Odisha'</span><span class="p">:</span> <span class="s1">'Odisha'</span><span class="p">,</span>
    <span class="s1">'CHHATTISGARH'</span><span class="p">:</span> <span class="s1">'Chhattisgarh'</span><span class="p">,</span><span class="s1">'Chhattisgarh'</span><span class="p">:</span> <span class="s1">'Chhattisgarh'</span><span class="p">,</span>
    <span class="s1">'MADHYA PRADESH'</span><span class="p">:</span> <span class="s1">'Madhya Pradesh'</span><span class="p">,</span><span class="s1">'Madhya Pradesh'</span><span class="p">:</span> <span class="s1">'Madhya Pradesh'</span><span class="p">,</span>
    <span class="s1">'GUJARAT'</span><span class="p">:</span> <span class="s1">'Gujarat'</span><span class="p">,</span><span class="s1">'Gujarat'</span><span class="p">:</span> <span class="s1">'Gujarat'</span><span class="p">,</span>
    <span class="s1">'MAHARASHTRA'</span><span class="p">:</span> <span class="s1">'Maharashtra'</span><span class="p">,</span><span class="s1">'Maharashtra'</span><span class="p">:</span> <span class="s1">'Maharashtra'</span><span class="p">,</span>
    <span class="s1">'KARNATAKA'</span><span class="p">:</span> <span class="s1">'Karnataka'</span><span class="p">,</span><span class="s1">'Karnataka'</span><span class="p">:</span> <span class="s1">'Karnataka'</span><span class="p">,</span>
    <span class="s1">'Goa'</span><span class="p">:</span> <span class="s1">'Goa'</span><span class="p">,</span><span class="s1">'Lakshadweep'</span><span class="p">:</span> <span class="s1">'Lakshadweep'</span><span class="p">,</span>
    <span class="s1">'KERALA'</span><span class="p">:</span> <span class="s1">'Kerala'</span><span class="p">,</span><span class="s1">'Kerala'</span><span class="p">:</span> <span class="s1">'Kerala'</span><span class="p">,</span>
    <span class="s1">'TAMIL NADU'</span><span class="p">:</span> <span class="s1">'Tamil Nadu'</span><span class="p">,</span><span class="s1">'Tamil Nadu'</span><span class="p">:</span> <span class="s1">'Tamil Nadu'</span><span class="p">,</span><span class="s1">'Puducherry'</span><span class="p">:</span> <span class="s1">'Puducherry'</span><span class="p">,</span>
    <span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">:</span> <span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span><span class="s1">'A &amp; N Islands'</span><span class="p">:</span> <span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span>
    <span class="s1">'TELANGANA'</span><span class="p">:</span> <span class="s1">'Telangana'</span><span class="p">,</span><span class="s1">'Telangana'</span><span class="p">:</span> <span class="s1">'Telangana'</span><span class="p">,</span>
    <span class="s1">'ANDHRA PRADESH'</span><span class="p">:</span> <span class="s1">'Andhra Pradesh'</span><span class="p">,</span><span class="s1">'Andhra Pradesh'</span><span class="p">:</span> <span class="s1">'Andhra Pradesh'</span><span class="p">,</span>
    <span class="s1">'LADAKH'</span><span class="p">:</span> <span class="s1">'Ladakh'</span><span class="p">,</span><span class="s1">'Ladakh'</span><span class="p">:</span> <span class="s1">'Ladakh'</span><span class="p">,</span>
    <span class="s1">'Dadra &amp; Nagar Haveli And Daman &amp; Diu'</span><span class="p">:</span> <span class="s1">'D &amp; N Haveli'</span><span class="p">,</span> <span class="s1">'D &amp; N Haveli and Daman &amp; Diu'</span><span class="p">:</span> <span class="s1">'D &amp; N Haveli'</span><span class="p">,</span> <span class="s1">'DADRA &amp; NAGAR HAVELI'</span><span class="p">:</span> <span class="s1">'D &amp; N Haveli'</span>
<span class="p">}</span>

<span class="n">Village_ID_df</span><span class="p">[</span><span class="s1">'State'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="p">[</span><span class="s1">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">state_name_mapping</span><span class="p">)</span>
<span class="n">Village_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[29]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582655</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582656</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582657</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582658</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992</td>
<td>39</td>
<td>496</td>
</tr>
</tbody>
</table>
<p>582659 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=85ac98c3-402c-4130-a1a1-292094f227eb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 582659 entries, 0 to 582658
Data columns (total 9 columns):
 #   Column               Non-Null Count   Dtype 
---  ------               --------------   ----- 
 0   State                582659 non-null  object
 1   StateId              582659 non-null  Int64 
 2   District             582659 non-null  object
 3   DistrictId           582659 non-null  Int64 
 4   Village              582659 non-null  object
 5   Villageid            582659 non-null  Int64 
 6   Census Village Code  582658 non-null  object
 7   Census_State         582659 non-null  Int64 
 8   Census_District      582659 non-null  Int64 
dtypes: Int64(5), object(4)
memory usage: 42.8+ MB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ee3e607e-b8a0-43b2-b4d8-f5181d6c852e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">Village_ID_df</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Census Village Code'</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">Village_ID_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Village_ID_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>3</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582655</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582656</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582657</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993</td>
<td>39</td>
<td>496</td>
</tr>
<tr>
<th>582658</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992</td>
<td>39</td>
<td>496</td>
</tr>
</tbody>
</table>
<p>582659 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=cb2278b6-ef4e-4546-9b83-87a01ff330ba">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Village_ID_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/Village_ID_df.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=1b4e6e9f-d849-4ed6-8c71-59327c2dc2e9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=9ec1170e-4738-4b25-aa73-b3b6f12a1f36">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><a id="enriching-water-quality"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
We now utilize our custom-built extensive <b>Village ID mapping DataFrame</b> to provide all the required information to the <b>Water Quality Data</b>.
<p>This process involves:</p>
<ul>
<li><b>Matching Village IDs:</b> The <b>Village ID</b> column in the Water Quality Data is matched with the corresponding <b>Village ID</b> in the mapping DataFrame.</li>
<li><b>Enriching the Data:</b> Using the mapping DataFrame, additional columns such as <b>State Name, State ID, District Name, District ID, and Census Village Code</b> are added to the Water Quality Data.</li>
<li><b>Verification:</b> After merging, verify that each row in the Water Quality Data has all the necessary columns populated accurately using the mapping.</li>
</ul>
<p>This step ensures that the Water Quality Data is now enriched with all the required metadata, ready for advanced analysis and modeling.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=14df5c6a-9079-43c2-acba-32d463d489fe">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">vid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/Village_ID_df.csv"</span><span class="p">)</span>
<span class="n">vid</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">vid</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">])</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">'VillageId'</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">'first'</span><span class="p">)</span>
<span class="n">vid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[36]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111.0</td>
<td>1</td>
<td>1</td>
<td>134907</td>
</tr>
<tr>
<th>1</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102.0</td>
<td>1</td>
<td>1</td>
<td>134908</td>
</tr>
<tr>
<th>2</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115.0</td>
<td>1</td>
<td>1</td>
<td>134909</td>
</tr>
<tr>
<th>3</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106.0</td>
<td>1</td>
<td>1</td>
<td>134912</td>
</tr>
<tr>
<th>4</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168.0</td>
<td>1</td>
<td>1</td>
<td>134913</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994.0</td>
<td>39</td>
<td>496</td>
<td>92207</td>
</tr>
<tr>
<th>582655</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996.0</td>
<td>39</td>
<td>496</td>
<td>92208</td>
</tr>
<tr>
<th>582656</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995.0</td>
<td>39</td>
<td>496</td>
<td>92209</td>
</tr>
<tr>
<th>582657</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993.0</td>
<td>39</td>
<td>496</td>
<td>92210</td>
</tr>
<tr>
<th>582658</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992.0</td>
<td>39</td>
<td>496</td>
<td>92211</td>
</tr>
</tbody>
</table>
<p>582659 rows × 10 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=e7c456d1-64e1-41a1-ae3a-d942471036cd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1bdad153-8690-47c6-80c4-613549c7c5b5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"Census Village Code"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111.0</td>
<td>1</td>
<td>1</td>
<td>134907</td>
</tr>
<tr>
<th>1</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102.0</td>
<td>1</td>
<td>1</td>
<td>134908</td>
</tr>
<tr>
<th>2</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115.0</td>
<td>1</td>
<td>1</td>
<td>134909</td>
</tr>
<tr>
<th>3</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106.0</td>
<td>1</td>
<td>1</td>
<td>134912</td>
</tr>
<tr>
<th>4</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168.0</td>
<td>1</td>
<td>1</td>
<td>134913</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994.0</td>
<td>39</td>
<td>496</td>
<td>92207</td>
</tr>
<tr>
<th>582655</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996.0</td>
<td>39</td>
<td>496</td>
<td>92208</td>
</tr>
<tr>
<th>582656</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995.0</td>
<td>39</td>
<td>496</td>
<td>92209</td>
</tr>
<tr>
<th>582657</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993.0</td>
<td>39</td>
<td>496</td>
<td>92210</td>
</tr>
<tr>
<th>582658</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992.0</td>
<td>39</td>
<td>496</td>
<td>92211</td>
</tr>
</tbody>
</table>
<p>582659 rows × 10 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=9fe80943-708a-4d87-a3c1-dec846a2c9a6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2812d46a-e3a2-4479-a509-ef9770d90449">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/JJM-NRDWP-Drinking_WQ_Data.csv"</span><span class="p">)</span>
<span class="c1"># Ensure HabitationId is numeric in both DataFrames</span>
<span class="c1"># Convert HabitationId to numeric (integer)</span>
<span class="n">vid</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">vid</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">WQ_combined_df</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">WQ_combined_df</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>

<span class="c1"># Drop rows where HabitationId is NaN after conversion</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">])</span>
<span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">])</span>

<span class="c1"># Perform a left join</span>
<span class="n">WQ_combined_mdf</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
<span class="n">WQ_combined_mdf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[38]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2642</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>MALLIPUDI</td>
<td>2642</td>
<td>582966.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>2647</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>K.G.PUDI</td>
<td>2647</td>
<td>582989.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>2648</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>SSR PURAM</td>
<td>2648</td>
<td>582990.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>2649</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>PKR PURAM</td>
<td>2649</td>
<td>582991.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>2650</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>RAMASWAMIPETA</td>
<td>2650</td>
<td>582992.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9405769</th>
<td>677747</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>CHOOHARPUR</td>
<td>677747</td>
<td>1906383.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405770</th>
<td>677750</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>JATPURA BAGUN</td>
<td>677750</td>
<td>1906386.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405771</th>
<td>677751</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>KHARAGWARI</td>
<td>677751</td>
<td>1906387.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405772</th>
<td>677753</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>MIRZAPUR</td>
<td>677753</td>
<td>1906391.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405773</th>
<td>694320</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Mau</td>
<td>518</td>
<td>GARAVA</td>
<td>694320</td>
<td>1225958.0</td>
<td>9</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>9405774 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=edc1f9da-2034-4326-8bdf-e54c08721a6d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_mdf</span><span class="p">[</span><span class="s1">'State'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[39]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array(['Andhra Pradesh', 'Telangana', 'Assam', 'Bihar', 'Gujarat',
       'Haryana', 'Himachal Pradesh', 'Karnataka', 'Madhya Pradesh',
       'Maharashtra', 'Meghalaya', 'Odisha', 'Punjab', 'Rajasthan',
       'Uttar Pradesh', 'West Bengal', 'Chhattisgarh', 'Jharkhand',
       'Uttarakhand', 'Manipur', 'Arunachal Pradesh', 'Kerala',
       'Tamil Nadu', 'Mizoram', 'Puducherry', 'Tripura', 'Goa',
       'Nagaland', 'Jammu &amp; Kashmir', 'Sikkim', 'Ladakh',
       'Andaman &amp; Nicobar Islands', 'Lakshadweep'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=56895df9-f3c0-4df1-8d16-2d86a4286a4c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_mdf</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">WQ_combined_mdf</span> <span class="o">=</span> <span class="n">WQ_combined_mdf</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_mdf</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">WQ_combined_mdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>0
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2642</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>MALLIPUDI</td>
<td>2642</td>
<td>582966.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>2647</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>K.G.PUDI</td>
<td>2647</td>
<td>582989.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>2648</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>SSR PURAM</td>
<td>2648</td>
<td>582990.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>2649</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>PKR PURAM</td>
<td>2649</td>
<td>582991.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>2650</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>RAMASWAMIPETA</td>
<td>2650</td>
<td>582992.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9405769</th>
<td>677747</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>CHOOHARPUR</td>
<td>677747</td>
<td>1906383.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405770</th>
<td>677750</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>JATPURA BAGUN</td>
<td>677750</td>
<td>1906386.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405771</th>
<td>677751</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>KHARAGWARI</td>
<td>677751</td>
<td>1906387.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405772</th>
<td>677753</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>MIRZAPUR</td>
<td>677753</td>
<td>1906391.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405773</th>
<td>694320</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Mau</td>
<td>518</td>
<td>GARAVA</td>
<td>694320</td>
<td>1225958.0</td>
<td>9</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>9405774 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=a298b42d-6472-41c7-9d33-b7a339b31c05">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_mdf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/WQ_INDIA_JJM-NRDWP_VL.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=1f8523ad-a2df-49b6-b615-68e44f7f0b70">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=682265bb-47d9-4950-aa4f-8f77fd39c505">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Fuzzy Matching the Unmatched NRDWP Data and merging it back with preprocessed NRDWP - JJM Data
</div>
<p><a id="unmatched-data-preprocessing"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<b>Fuzzy Matching unmatched NRDWP Data</b><br/>
Now the final step is to preprocess the Unmerged NRDWP data which we left in <b>Section</b>.We now first merge the state wise unmerged data into single file called <code>stateunmatched_csv</code>. Now as this unmerged data does not have any scope of matching etc via IDs so we use a method called Fuzzy Method i.e we match the contatenated 'DistrictName', 'BlockName', 'PanchayatName', 'VillageName' from the stateunmatched_csv to concatenated 'DistrictName', 'BlockName', 'PanchayatName', 'VillageName' of a prepared VillageName_ID_df which is concatenated B1_df and NRDWP_B1.
<p>Now the final step is to preprocess the Unmerged NRDWP data which we left in <b>Section</b>. We now first merge the state-wise unmerged data into a single file called <code>stateunmatched_csv</code>. Since this unmerged data does not contain any IDs that can help with direct matching, we use a technique called <b>Fuzzy Matching</b>. This involves comparing concatenated location strings from both datasets to identify likely matches even when there are minor spelling or formatting differences.</p>
<p>For instance, we create a new column called <code>B1Village</code> in both the <code>stateunmatched_csv</code> and the <code>VillageName_ID_df</code> by combining the <code>DistrictName</code>, <code>BlockName</code>, <code>PanchayatName</code>, and <code>VillageName</code>. This allows us to perform string-level matching instead of relying on IDs.</p>
<p>Suppose in the <code>stateunmatched_csv</code> we have an entry like:<br>
<i>"Mirzapur_Marihan_Katka_Katka Khurd"</i>,<br>
and in the reference <code>VillageName_ID_df</code> we have:<br>
<i>"Mirzapur_Marihan_Katka_Katka Kurd"</i>.</br></br></br></p>
<p>Even though the last word is slightly different (<i>Khurd</i> vs <i>Kurd</i>), fuzzy matching identifies this as a likely match because the overall similarity is high. Another example might be a name like <i>"Pratapgarh_Kunda_Govindpur_Govind Pur"</i> being matched with <i>"Pratapgarh_Kunda_Govindpur_Govindpur"</i> — where spacing differences are resolved through the fuzzy logic.</p>
<p>The process uses a similarity score, typically above a threshold like 92%, to accept a match. If no match is found above this threshold, the entry is flagged as unmatched. This method helps recover a significant number of village-level records which otherwise would be lost due to small inconsistencies in names across datasets.</p>
<p>Through this step, a new mapping of original vs. matched village strings along with similarity scores is created for each state and saved as a supplementary file, ensuring traceability and transparency in the preprocessing step.</p>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=fc897dfc-0c40-4c90-825e-1b462633a7ca">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=4d216e2c-1c70-4191-9726-0ebe198322c3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Preprocessing Unmatched NRDWP Data
</div>
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Consolidating B1 and NRDWP B1 Datasets
</div>
<p><a id="consolidating-datasets"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
To begin preprocessing, we first gather all the unmerged NRDWP data from different states. A list called <code>statelist</code> is defined, containing the names of all states and union territories, including alternate spellings like <i>'CHATTISGARH'</i> and <i>'CHHATTISGARH'</i> to ensure complete coverage. For each state in this list, we load its corresponding unmatched data file stored under the <code>Supplementary Results</code> folder. These individual state files are then combined into a single DataFrame called <code>stateunmatched_csv</code>. This consolidated dataset represents all village-level records that could not be matched directly in earlier steps and are now ready for fuzzy matching.

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=e51a836c-6424-45b6-ba26-087c64113b64">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">statelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span><span class="s1">'ARUNACHAL PRADESH'</span><span class="p">,</span><span class="s1">'ASSAM'</span><span class="p">,</span><span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span><span class="s1">'BIHAR'</span><span class="p">,</span><span class="s1">'CHATTISGARH'</span><span class="p">,</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span><span class="s1">'GOA'</span><span class="p">,</span>
              <span class="s1">'GUJARAT'</span><span class="p">,</span> <span class="s1">'HARYANA'</span><span class="p">,</span> <span class="s1">'HIMACHAL PRADESH'</span><span class="p">,</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span> <span class="s1">'JAMMU AND KASHMIR'</span><span class="p">,</span> <span class="s1">'JHARKHAND'</span><span class="p">,</span> <span class="s1">'KARNATAKA'</span><span class="p">,</span> <span class="s1">'KERALA'</span><span class="p">,</span> 
              <span class="s1">'MADHYA PRADESH'</span><span class="p">,</span> <span class="s1">'MAHARASHTRA'</span><span class="p">,</span> <span class="s1">'MANIPUR'</span><span class="p">,</span>  <span class="s1">'MEGHALAYA'</span><span class="p">,</span>  <span class="s1">'MIZORAM'</span><span class="p">,</span>  <span class="s1">'NAGALAND'</span><span class="p">,</span>  <span class="s1">'ODISHA'</span><span class="p">,</span> <span class="s1">'ORISSA'</span><span class="p">,</span> <span class="s1">'PUDUCHERRY'</span><span class="p">,</span>
              <span class="s1">'PUNJAB'</span><span class="p">,</span> <span class="s1">'RAJASTHAN'</span><span class="p">,</span> <span class="s1">'SIKKIM'</span><span class="p">,</span> <span class="s1">'TAMIL NADU'</span><span class="p">,</span> <span class="s1">'TELANGANA'</span><span class="p">,</span> <span class="s1">'TRIPURA'</span><span class="p">,</span> <span class="s1">'UTTAR PRADESH'</span><span class="p">,</span> <span class="s1">'UTTARAKHAND'</span><span class="p">,</span> <span class="s1">'WEST BENGAL'</span><span class="p">]</span>

<span class="c1"># statelist = sorted(list(NRDWP_mcdf.StateName.unique()))</span>

<span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Iterate over each state</span>
<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">statelist</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_Unmatched_NRDWP_data.csv"</span>
    <span class="n">state_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">stateunmatched_csv</span><span class="p">,</span> <span class="n">state_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># statematched_csv.to_csv("Supplementary Results/NRDWP_India_Matched.csv", index=False)</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)</td>
<td>RODDAM (53)</td>
<td>BOKKASAMPALLE(06)</td>
<td>VENKATAPURAM(006 )</td>
<td>E.VENKATAPURAM(1216653006010600)</td>
<td>Delivery Point</td>
<td>1677231</td>
<td>NaN</td>
<td>272.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>ANUPALLI HW(1014054021021500)</td>
<td>Deep Tubewell</td>
<td>30856</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>ANUPALLI HW(1014054021021500)</td>
<td>Deep Tubewell</td>
<td>30856</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>ANUPALLI HW(1014054021021500)</td>
<td>Deep Tubewell</td>
<td>30856</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>ANUPALLI(1014054021011500)</td>
<td>Deep Tubewell</td>
<td>30855</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>239567</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>KURMAN PUR</td>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>20.0</td>
<td>3.52</td>
<td>NaN</td>
<td>1.13</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>239568</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>KURMAN PUR</td>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>30.0</td>
<td>0.37</td>
<td>NaN</td>
<td>1.16</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>239569</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.54</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2018</td>
<td>6</td>
<td>NaN</td>
</tr>
<tr>
<th>239570</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>25.0</td>
<td>0.64</td>
<td>NaN</td>
<td>0.94</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
</tr>
<tr>
<th>239571</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0</td>
<td>2.0</td>
<td>0.83</td>
<td>NaN</td>
<td>1.55</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>239572 rows × 21 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=495190c2-3687-4b2f-8713-1ea732a5d81c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span><span class="s1">'VillageName'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[51]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)</td>
<td>RODDAM (53)</td>
<td>BOKKASAMPALLE(06)</td>
<td>VENKATAPURAM(006 )</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
</tr>
<tr>
<th>10</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>MAPAKSHI-PART(023)</td>
</tr>
<tr>
<th>12</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>BANDAPALLE(018 )</td>
</tr>
<tr>
<th>19</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>DIGUVAMASAPALLE(011 )</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>239255</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>SUKANTA PALLY</td>
</tr>
<tr>
<th>239257</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>UTTARGUMA</td>
</tr>
<tr>
<th>239270</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
</tr>
<tr>
<th>239468</th>
<td>WEST BENGAL</td>
<td>PURBA MEDINIPUR</td>
<td>BHAGABANPUR-II</td>
<td>GARBARI-I</td>
<td>TIORKHALI</td>
</tr>
<tr>
<th>239476</th>
<td>WEST BENGAL</td>
<td>ALIPURDUAR</td>
<td>FALAKATA</td>
<td>PARANGERPAR</td>
<td>PARANGARPAR</td>
</tr>
</tbody>
</table>
<p>9358 rows × 5 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4e7203f4-4973-49ca-b3e3-135bfda7aa47">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="s2">"Complete India B1"</span>
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Traverse all files and subdirectories</span>
<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Combine all dataframes</span>
<span class="n">B1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">B1_df</span> <span class="o">=</span> <span class="n">B1_df</span><span class="p">[[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'District'</span><span class="p">,</span> <span class="s1">'Block'</span><span class="p">,</span> <span class="s1">'Panchayat'</span><span class="p">,</span> <span class="s1">'Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span>
<span class="n">B1_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">B1_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">B1_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'District'</span><span class="p">,</span> <span class="s1">'Block'</span><span class="p">,</span> <span class="s1">'Panchayat'</span><span class="p">,</span> <span class="s1">'Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">B1_df</span> <span class="o">=</span> <span class="n">B1_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">B1_df</span> <span class="o">=</span> <span class="n">B1_df</span><span class="p">[[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'District'</span><span class="p">,</span> <span class="s1">'Block'</span><span class="p">,</span> <span class="s1">'Panchayat'</span><span class="p">,</span> <span class="s1">'Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>

<span class="n">B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[52]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>District</th>
<th>Block</th>
<th>Panchayat</th>
<th>Village</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>7699460</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Gauri</td>
<td>484363</td>
</tr>
<tr>
<th>7699459</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Garna</td>
<td>484365</td>
</tr>
<tr>
<th>7699458</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dubduar</td>
<td>484361</td>
</tr>
<tr>
<th>7699457</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dakshin Bishnupur</td>
<td>484362</td>
</tr>
<tr>
<th>7699456</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Bishahar</td>
<td>484359</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7699536</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>SITANAGAR</td>
<td>Sitanagar (EFA)</td>
<td>699426</td>
</tr>
<tr>
<th>7699533</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Shyam Nagar (EFA)</td>
<td>693102</td>
</tr>
<tr>
<th>7699532</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Radha Nagar (EFA)</td>
<td>701808</td>
</tr>
<tr>
<th>7699529</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>LAXMIPUR</td>
<td>Laxmipur (EFA)</td>
<td>699425</td>
</tr>
<tr>
<th>7699528</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>GANDHI NAGAR</td>
<td>Gandhi Nagar (EFA)</td>
<td>693101</td>
</tr>
</tbody>
</table>
<p>1487070 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=1e142b51-b990-4516-a821-21c5df31673a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5c4318cd-a6ec-48b0-a88a-bc07a9173c44">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Creating B1Village Composite Identifier
</div>
</div><a id="creating-composite-identifier"></a>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
To prepare the data for village-level matching, we begin by consolidating two major datasets—one from the <i>Complete India B1</i> folder and another from the <i>NRDWP B1</i> folder. Each folder contains multiple CSV files, possibly organized into subdirectories. Using <code>os.walk</code>, we recursively load all CSV files into separate lists of DataFrames, which are then concatenated into <code>B1_df</code> and <code>NRDWP_B1</code> respectively. From each combined dataset, only the relevant administrative columns such as State, District, Block, Panchayat, Village, and Village ID are retained. The <code>Villageid</code> field is explicitly converted to numeric format, with errors coerced to handle inconsistencies. Finally, the datasets are cleaned by sorting them hierarchically and removing duplicate rows to ensure a clean base for matching village records across different sources.

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=7d6fdbef-6953-4577-9096-a5b77abb25fb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="s2">"NRDWP B1"</span>
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Traverse all files and subdirectories</span>
<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.csv'</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Combine all dataframes</span>
<span class="n">NRDWP_B1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(NRDWP_B1.columns)</span>

<span class="n">NRDWP_B1</span> <span class="o">=</span> <span class="n">NRDWP_B1</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span>
<span class="n">NRDWP_B1</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">NRDWP_B1</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">NRDWP_B1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># NRDWP_B1 = NRDWP_B1.dropna(subset=['Villageid'])</span>
<span class="n">NRDWP_B1</span> <span class="o">=</span> <span class="n">NRDWP_B1</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>

<span class="n">NRDWP_B1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[54]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>1697330</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Tenra</td>
<td>484484</td>
</tr>
<tr>
<th>307793</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Sitgram</td>
<td>484482</td>
</tr>
<tr>
<th>1695154</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Shitalpur</td>
<td>484481</td>
</tr>
<tr>
<th>1697328</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Shialtor</td>
<td>484483</td>
</tr>
<tr>
<th>1676902</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Paikpara</td>
<td>484480</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>621726</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Laxmi Nagar</td>
<td>Joginder Nagar</td>
<td>608878</td>
</tr>
<tr>
<th>621723</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Laxmi Nagar</td>
<td>Gandhi Nagar</td>
<td>608875</td>
</tr>
<tr>
<th>621727</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Govind Nagar</td>
<td>Govinda Nagar</td>
<td>608881</td>
</tr>
<tr>
<th>621721</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>Chingen (incl.fc At Magar Nalla)</td>
<td>608871</td>
</tr>
<tr>
<th>621728</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>608882</td>
</tr>
</tbody>
</table>
<p>482123 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=94d9b8ee-ec83-4e01-b7e5-6c1b3d7f5075">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'State'</span><span class="p">:</span> <span class="s1">'StateName'</span><span class="p">,</span>
    <span class="s1">'District'</span><span class="p">:</span> <span class="s1">'DistrictName'</span><span class="p">,</span>
    <span class="s1">'Block'</span><span class="p">:</span> <span class="s1">'BlockName'</span><span class="p">,</span>
    <span class="s1">'Panchayat'</span><span class="p">:</span> <span class="s1">'PanchayatName'</span><span class="p">,</span>
    <span class="s1">'Village'</span><span class="p">:</span> <span class="s1">'VillageName'</span>
<span class="p">}</span>

<span class="c1"># Rename the columns in JJM_with_ID_df</span>
<span class="n">B1_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_mapping</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">B1_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[55]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>7699460</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Gauri</td>
<td>484363</td>
</tr>
<tr>
<th>7699459</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Garna</td>
<td>484365</td>
</tr>
<tr>
<th>7699458</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dubduar</td>
<td>484361</td>
</tr>
<tr>
<th>7699457</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dakshin Bishnupur</td>
<td>484362</td>
</tr>
<tr>
<th>7699456</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Bishahar</td>
<td>484359</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7699536</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>SITANAGAR</td>
<td>Sitanagar (EFA)</td>
<td>699426</td>
</tr>
<tr>
<th>7699533</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Shyam Nagar (EFA)</td>
<td>693102</td>
</tr>
<tr>
<th>7699532</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Radha Nagar (EFA)</td>
<td>701808</td>
</tr>
<tr>
<th>7699529</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>LAXMIPUR</td>
<td>Laxmipur (EFA)</td>
<td>699425</td>
</tr>
<tr>
<th>7699528</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>GANDHI NAGAR</td>
<td>Gandhi Nagar (EFA)</td>
<td>693101</td>
</tr>
</tbody>
</table>
<p>1487070 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=86b4a58c-229c-4f7e-81ab-7ab0076a58ba">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">B1_df</span><span class="p">,</span> <span class="n">NRDWP_B1</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[56]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Gauri</td>
<td>484363</td>
</tr>
<tr>
<th>1</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Garna</td>
<td>484365</td>
</tr>
<tr>
<th>2</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dubduar</td>
<td>484361</td>
</tr>
<tr>
<th>3</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Dakshin Bishnupur</td>
<td>484362</td>
</tr>
<tr>
<th>4</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Gouri</td>
<td>Bishahar</td>
<td>484359</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1969188</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Laxmi Nagar</td>
<td>Joginder Nagar</td>
<td>608878</td>
</tr>
<tr>
<th>1969189</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Laxmi Nagar</td>
<td>Gandhi Nagar</td>
<td>608875</td>
</tr>
<tr>
<th>1969190</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Govind Nagar</td>
<td>Govinda Nagar</td>
<td>608881</td>
</tr>
<tr>
<th>1969191</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>Chingen (incl.fc At Magar Nalla)</td>
<td>608871</td>
</tr>
<tr>
<th>1969192</th>
<td>Andaman &amp; Nicobar Islands</td>
<td>Nicobars</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>Campbell Bay</td>
<td>608882</td>
</tr>
</tbody>
</table>
<p>1969193 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=42de8932-783e-4fb4-98bd-1e6ac604d505">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[57]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>1487070</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Tenra</td>
<td>484484</td>
</tr>
<tr>
<th>1487071</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Sitgram</td>
<td>484482</td>
</tr>
<tr>
<th>1487072</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Shitalpur</td>
<td>484481</td>
</tr>
<tr>
<th>1487073</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Shialtor</td>
<td>484483</td>
</tr>
<tr>
<th>1487074</th>
<td>West Bengal</td>
<td>Uttar Dinajpur</td>
<td>Raiganj</td>
<td>Sitgram</td>
<td>Paikpara</td>
<td>484480</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1487065</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>SITANAGAR</td>
<td>Sitanagar (EFA)</td>
<td>699426</td>
</tr>
<tr>
<th>1487066</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Shyam Nagar (EFA)</td>
<td>693102</td>
</tr>
<tr>
<th>1487067</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>RADHANAGAR</td>
<td>Radha Nagar (EFA)</td>
<td>701808</td>
</tr>
<tr>
<th>1487068</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>LAXMIPUR</td>
<td>Laxmipur (EFA)</td>
<td>699425</td>
</tr>
<tr>
<th>1487069</th>
<td>A &amp; N Islands</td>
<td>NORTH AND MIDDLE ANDAMAN</td>
<td>DIGLIPUR</td>
<td>GANDHI NAGAR</td>
<td>Gandhi Nagar (EFA)</td>
<td>693101</td>
</tr>
</tbody>
</table>
<p>1524665 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=edb4b503-d86b-4429-8383-6f84782e0688">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
To enable efficient village-level matching, key columns such as <i>DistrictName</i>, <i>BlockName</i>, <i>PanchayatName</i>, and <i>VillageName</i> are first converted to string format to standardize the data and avoid type-related mismatches. Any rows with missing values in these columns are removed to ensure integrity during the matching process. Next, a composite identifier named <code>B1Village</code> is created by concatenating the four administrative levels using underscores. This unique key serves as a uniform identifier for each village across datasets. Once this identifier is generated, the original columns used to construct it are dropped from the <code>VillageName_ID_df</code> DataFrame to simplify the structure and focus on matching based on the newly created <code>B1Village</code> field.
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f05ef5b9-eca5-4cf8-8070-8df101dcb8a4">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">columns_to_convert</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_convert</span><span class="p">:</span>
    <span class="n">VillageName_ID_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">columns_to_convert</span><span class="p">)</span>  <span class="c1"># Drop rows with NaN values in these columns</span>

<span class="n">VillageName_ID_df</span><span class="p">[</span><span class="s1">'B1Village'</span><span class="p">]</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="p">[[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="s1">'_'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop the original columns</span>
<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">])</span>
<span class="n">VillageName_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[58]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Villageid</th>
<th>B1Village</th>
</tr>
</thead>
<tbody>
<tr>
<th>1487070</th>
<td>West Bengal</td>
<td>484484</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Tenra</td>
</tr>
<tr>
<th>1487071</th>
<td>West Bengal</td>
<td>484482</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Sitgram</td>
</tr>
<tr>
<th>1487072</th>
<td>West Bengal</td>
<td>484481</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Shitalpur</td>
</tr>
<tr>
<th>1487073</th>
<td>West Bengal</td>
<td>484483</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Shialtor</td>
</tr>
<tr>
<th>1487074</th>
<td>West Bengal</td>
<td>484480</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Paikpara</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1487065</th>
<td>A &amp; N Islands</td>
<td>699426</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_SITANAGAR_Si...</td>
</tr>
<tr>
<th>1487066</th>
<td>A &amp; N Islands</td>
<td>693102</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_RADHANAGAR_S...</td>
</tr>
<tr>
<th>1487067</th>
<td>A &amp; N Islands</td>
<td>701808</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_RADHANAGAR_R...</td>
</tr>
<tr>
<th>1487068</th>
<td>A &amp; N Islands</td>
<td>699425</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_LAXMIPUR_Lax...</td>
</tr>
<tr>
<th>1487069</th>
<td>A &amp; N Islands</td>
<td>693101</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_GANDHI NAGAR...</td>
</tr>
</tbody>
</table>
<p>1524665 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=fb6c490f-f6d2-47df-935a-9a401d2d362e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[59]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)</td>
<td>RODDAM (53)</td>
<td>BOKKASAMPALLE(06)</td>
<td>VENKATAPURAM(006 )</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
</tr>
<tr>
<th>10</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>MAPAKSHI-PART(023)</td>
</tr>
<tr>
<th>12</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>BANDAPALLE(018 )</td>
</tr>
<tr>
<th>19</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>DIGUVAMASAPALLE(011 )</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>239255</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>SUKANTA PALLY</td>
</tr>
<tr>
<th>239257</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>UTTARGUMA</td>
</tr>
<tr>
<th>239270</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
</tr>
<tr>
<th>239468</th>
<td>WEST BENGAL</td>
<td>PURBA MEDINIPUR</td>
<td>BHAGABANPUR-II</td>
<td>GARBARI-I</td>
<td>TIORKHALI</td>
</tr>
<tr>
<th>239476</th>
<td>WEST BENGAL</td>
<td>ALIPURDUAR</td>
<td>FALAKATA</td>
<td>PARANGERPAR</td>
<td>PARANGARPAR</td>
</tr>
</tbody>
</table>
<p>9358 rows × 5 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=cf27ee46-3642-440d-8544-796e0a7eaa7f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">columns_to_convert</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_convert</span><span class="p">:</span>
    <span class="n">stateunmatched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">columns_to_convert</span><span class="p">)</span>  <span class="c1"># Drop rows with NaN values in these columns</span>

<span class="n">stateunmatched_csv</span><span class="p">[</span><span class="s1">'B1Village'</span><span class="p">]</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="s1">'_'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop the original columns</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[60]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>B1Village</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)</td>
<td>RODDAM (53)</td>
<td>BOKKASAMPALLE(06)</td>
<td>VENKATAPURAM(006 )</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
</tr>
<tr>
<th>10</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>MAPAKSHI-PART(023)</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
</tr>
<tr>
<th>12</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>BANDAPALLE(018 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
</tr>
<tr>
<th>19</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>DIGUVAMASAPALLE(011 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>239255</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>SUKANTA PALLY</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_SUKANTA PALLY</td>
</tr>
<tr>
<th>239257</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>UTTARGUMA</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_UTTARGUMA</td>
</tr>
<tr>
<th>239270</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>DAKSHIN DINAJPUR_HARIRAMPUR_SAIYEDPUR_KURMANPU...</td>
</tr>
<tr>
<th>239468</th>
<td>WEST BENGAL</td>
<td>PURBA MEDINIPUR</td>
<td>BHAGABANPUR-II</td>
<td>GARBARI-I</td>
<td>TIORKHALI</td>
<td>PURBA MEDINIPUR_BHAGABANPUR-II_GARBARI-I_TIORK...</td>
</tr>
<tr>
<th>239476</th>
<td>WEST BENGAL</td>
<td>ALIPURDUAR</td>
<td>FALAKATA</td>
<td>PARANGERPAR</td>
<td>PARANGARPAR</td>
<td>ALIPURDUAR_FALAKATA_PARANGERPAR_PARANGARPAR</td>
</tr>
</tbody>
</table>
<p>9358 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c3c95db3-5adf-4436-8719-794bbb2e4798">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">StateName</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[61]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array(['West Bengal', 'WEST BENGAL', 'Uttarakhand', 'Uttar Pradesh',
       'UTTARAKHAND', 'UTTAR PRADESH', 'Tripura', 'Telangana',
       'Tamil Nadu', 'TELANGANA', 'TAMIL NADU', 'Sikkim', 'SIKKIM',
       'Rajasthan', 'RAJASTHAN', 'Punjab', 'Puducherry', 'PUNJAB',
       'Odisha', 'ODISHA', 'Nagaland', 'NAGALAND', 'Mizoram', 'Meghalaya',
       'Manipur', 'Maharashtra', 'Madhya Pradesh', 'MIZORAM', 'MEGHALAYA',
       'MANIPUR', 'MAHARASHTRA', 'MADHYA PRADESH', 'Lakshadweep',
       'Ladakh', 'LADAKH', 'Kerala', 'Karnataka', 'KERALA', 'KARNATAKA',
       'Jharkhand', 'Jammu &amp; Kashmir', 'JHARKHAND', 'JAMMU &amp; KASHMIR',
       'Himachal Pradesh', 'Haryana', 'HIMACHAL PRADESH', 'HARYANA',
       'Gujarat', 'Goa', 'GUJARAT',
       'Dadra &amp; Nagar Haveli And Daman &amp; Diu', 'DADRA &amp; NAGAR HAVELI',
       'D &amp; N Haveli and Daman &amp; Diu', 'Chhattisgarh', 'CHHATTISGARH',
       'Bihar', 'BIHAR', 'Assam', 'Arunachal Pradesh', 'Andhra Pradesh',
       'Andaman &amp; Nicobar Islands', 'ASSAM', 'ARUNACHAL PRADESH',
       'ANDHRA PRADESH', 'A &amp; N Islands'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9c07a04f-087d-4073-bab3-75aa33b2e4cc">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span><span class="o">.</span><span class="n">StateName</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[62]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array(['ANDHRA PRADESH', 'ARUNACHAL PRADESH', 'ASSAM',
       'Andaman &amp; Nicobar Islands', 'BIHAR', 'CHATTISGARH',
       'CHHATTISGARH', 'GUJARAT', 'HARYANA', 'HIMACHAL PRADESH',
       'JAMMU &amp; KASHMIR', 'JAMMU AND KASHMIR', 'JHARKHAND', 'KARNATAKA',
       'KERALA', 'MADHYA PRADESH', 'MAHARASHTRA', 'MANIPUR', 'MEGHALAYA',
       'MIZORAM', 'NAGALAND', 'ODISHA', 'ORISSA', 'PUNJAB', 'RAJASTHAN',
       'SIKKIM', 'TAMIL NADU', 'TELANGANA', 'TRIPURA', 'UTTAR PRADESH',
       'UTTARAKHAND', 'WEST BENGAL'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d3fa15e3-c657-4735-b9e3-069e51b819d1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    State Name Standardization
</div>
<p><a id="state-name-standardization"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
To ensure consistency in state names across datasets, a mapping dictionary is created to unify various representations of state names to a standardized format. This accounts for differences in casing, abbreviations, alternate spellings, and administrative naming conventions (e.g., <i>“Jammu and Kashmir”</i> and <i>“JAMMU AND KASHMIR”</i> are both mapped to <i>“JAMMU &amp; KASHMIR”</i>). The mapping is applied to the <code>StateName</code> column in both <code>VillageName_ID_df</code> and <code>stateunmatched_csv</code> DataFrames using the <code>map()</code> function, and any values not found in the dictionary are preserved using <code>fillna()</code>. This standardization step is crucial for accurate merging and comparison of data across multiple sources that may use inconsistent naming conventions.

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f0b96825-7bfc-4407-bbf9-91ff3208dbd7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a mapping dictionary to unify state names</span>
<span class="n">state_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'West Bengal'</span><span class="p">:</span> <span class="s1">'WEST BENGAL'</span><span class="p">,</span> <span class="s1">'Uttarakhand'</span><span class="p">:</span> <span class="s1">'UTTARAKHAND'</span><span class="p">,</span> <span class="s1">'Uttar Pradesh'</span><span class="p">:</span> <span class="s1">'UTTAR PRADESH'</span><span class="p">,</span>
    <span class="s1">'Tripura'</span><span class="p">:</span> <span class="s1">'TRIPURA'</span><span class="p">,</span> <span class="s1">'Telangana'</span><span class="p">:</span> <span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span> <span class="s1">'TELANGANA'</span> <span class="p">:</span> <span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span> <span class="s1">'Tamil Nadu'</span><span class="p">:</span> <span class="s1">'TAMIL NADU'</span><span class="p">,</span>
    <span class="s1">'Sikkim'</span><span class="p">:</span> <span class="s1">'SIKKIM'</span><span class="p">,</span> <span class="s1">'Rajasthan'</span><span class="p">:</span> <span class="s1">'RAJASTHAN'</span><span class="p">,</span> <span class="s1">'Punjab'</span><span class="p">:</span> <span class="s1">'PUNJAB'</span><span class="p">,</span>
    <span class="s1">'Puducherry'</span><span class="p">:</span> <span class="s1">'PUDUCHERRY'</span><span class="p">,</span> <span class="s1">'Odisha'</span><span class="p">:</span> <span class="s1">'ODISHA'</span><span class="p">,</span> <span class="s1">'Nagaland'</span><span class="p">:</span> <span class="s1">'NAGALAND'</span><span class="p">,</span>
    <span class="s1">'Mizoram'</span><span class="p">:</span> <span class="s1">'MIZORAM'</span><span class="p">,</span> <span class="s1">'Meghalaya'</span><span class="p">:</span> <span class="s1">'MEGHALAYA'</span><span class="p">,</span> <span class="s1">'Manipur'</span><span class="p">:</span> <span class="s1">'MANIPUR'</span><span class="p">,</span>
    <span class="s1">'Maharashtra'</span><span class="p">:</span> <span class="s1">'MAHARASHTRA'</span><span class="p">,</span> <span class="s1">'Madhya Pradesh'</span><span class="p">:</span> <span class="s1">'MADHYA PRADESH'</span><span class="p">,</span>
    <span class="s1">'Lakshadweep'</span><span class="p">:</span> <span class="s1">'LAKSHADWEEP'</span><span class="p">,</span> <span class="s1">'Ladakh'</span><span class="p">:</span> <span class="s1">'LADAKH'</span><span class="p">,</span> <span class="s1">'Kerala'</span><span class="p">:</span> <span class="s1">'KERALA'</span><span class="p">,</span>
    <span class="s1">'Karnataka'</span><span class="p">:</span> <span class="s1">'KARNATAKA'</span><span class="p">,</span> <span class="s1">'Jharkhand'</span><span class="p">:</span> <span class="s1">'JHARKHAND'</span><span class="p">,</span><span class="s1">'Jammu and Kashmir'</span><span class="p">:</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span>
    <span class="s1">'Jammu &amp; Kashmir'</span><span class="p">:</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span> <span class="s1">'Himachal Pradesh'</span><span class="p">:</span> <span class="s1">'HIMACHAL PRADESH'</span><span class="p">,</span>
    <span class="s1">'Haryana'</span><span class="p">:</span> <span class="s1">'HARYANA'</span><span class="p">,</span> <span class="s1">'Gujarat'</span><span class="p">:</span> <span class="s1">'GUJARAT'</span><span class="p">,</span> <span class="s1">'Goa'</span><span class="p">:</span> <span class="s1">'GOA'</span><span class="p">,</span>
    <span class="s1">'Dadra &amp; Nagar Haveli And Daman &amp; Diu'</span><span class="p">:</span> <span class="s1">'DADRA &amp; NAGAR HAVELI'</span><span class="p">,</span>
    <span class="s1">'D &amp; N Haveli and Daman &amp; Diu'</span><span class="p">:</span> <span class="s1">'DADRA &amp; NAGAR HAVELI'</span><span class="p">,</span>
    <span class="s1">'Chhattisgarh'</span><span class="p">:</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span> <span class="s1">'Bihar'</span><span class="p">:</span> <span class="s1">'BIHAR'</span><span class="p">,</span> <span class="s1">'Assam'</span><span class="p">:</span> <span class="s1">'ASSAM'</span><span class="p">,</span>
    <span class="s1">'Arunachal Pradesh'</span><span class="p">:</span> <span class="s1">'ARUNACHAL PRADESH'</span><span class="p">,</span> <span class="s1">'Andhra Pradesh'</span><span class="p">:</span> <span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span>
    <span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">:</span> <span class="s1">'A &amp; N ISLANDS'</span><span class="p">,</span> <span class="s1">'ORISSA'</span><span class="p">:</span> <span class="s1">'ODISHA'</span><span class="p">,</span>
    <span class="s1">'CHATTISGARH'</span><span class="p">:</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span> <span class="s1">'JAMMU AND KASHMIR'</span><span class="p">:</span> <span class="s1">'JAMMU &amp; KASHMIR'</span>
<span class="p">}</span>

<span class="c1"># Apply the mapping to both dataframes</span>
<span class="n">VillageName_ID_df</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_mapping</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">VillageName_ID_df</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">])</span>
<span class="n">stateunmatched_csv</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_mapping</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">stateunmatched_csv</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">])</span>

<span class="c1"># Verify the results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">VillageName_ID_df</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stateunmatched_csv</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>['WEST BENGAL' 'UTTARAKHAND' 'UTTAR PRADESH' 'TRIPURA' 'ANDHRA PRADESH'
 'TAMIL NADU' 'SIKKIM' 'RAJASTHAN' 'PUNJAB' 'PUDUCHERRY' 'ODISHA'
 'NAGALAND' 'MIZORAM' 'MEGHALAYA' 'MANIPUR' 'MAHARASHTRA' 'MADHYA PRADESH'
 'LAKSHADWEEP' 'LADAKH' 'KERALA' 'KARNATAKA' 'JHARKHAND' 'JAMMU &amp; KASHMIR'
 'HIMACHAL PRADESH' 'HARYANA' 'GUJARAT' 'GOA' 'DADRA &amp; NAGAR HAVELI'
 'CHHATTISGARH' 'BIHAR' 'ASSAM' 'ARUNACHAL PRADESH' 'A &amp; N ISLANDS'
 'A &amp; N Islands']
['ANDHRA PRADESH' 'ARUNACHAL PRADESH' 'ASSAM' 'A &amp; N ISLANDS' 'BIHAR'
 'CHHATTISGARH' 'GUJARAT' 'HARYANA' 'HIMACHAL PRADESH' 'JAMMU &amp; KASHMIR'
 'JHARKHAND' 'KARNATAKA' 'KERALA' 'MADHYA PRADESH' 'MAHARASHTRA' 'MANIPUR'
 'MEGHALAYA' 'MIZORAM' 'NAGALAND' 'ODISHA' 'PUNJAB' 'RAJASTHAN' 'SIKKIM'
 'TAMIL NADU' 'TRIPURA' 'UTTAR PRADESH' 'UTTARAKHAND' 'WEST BENGAL']
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=25c43a75-a385-4c3e-84b0-11eb7f4b415b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/VillageName_ID_df.csv"</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[64]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Villageid</th>
<th>B1Village</th>
</tr>
</thead>
<tbody>
<tr>
<th>1487070</th>
<td>WEST BENGAL</td>
<td>484484</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Tenra</td>
</tr>
<tr>
<th>1487071</th>
<td>WEST BENGAL</td>
<td>484482</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Sitgram</td>
</tr>
<tr>
<th>1487072</th>
<td>WEST BENGAL</td>
<td>484481</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Shitalpur</td>
</tr>
<tr>
<th>1487073</th>
<td>WEST BENGAL</td>
<td>484483</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Shialtor</td>
</tr>
<tr>
<th>1487074</th>
<td>WEST BENGAL</td>
<td>484480</td>
<td>Uttar Dinajpur_Raiganj_Sitgram_Paikpara</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1487065</th>
<td>A &amp; N Islands</td>
<td>699426</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_SITANAGAR_Si...</td>
</tr>
<tr>
<th>1487066</th>
<td>A &amp; N Islands</td>
<td>693102</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_RADHANAGAR_S...</td>
</tr>
<tr>
<th>1487067</th>
<td>A &amp; N Islands</td>
<td>701808</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_RADHANAGAR_R...</td>
</tr>
<tr>
<th>1487068</th>
<td>A &amp; N Islands</td>
<td>699425</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_LAXMIPUR_Lax...</td>
</tr>
<tr>
<th>1487069</th>
<td>A &amp; N Islands</td>
<td>693101</td>
<td>NORTH AND MIDDLE ANDAMAN_DIGLIPUR_GANDHI NAGAR...</td>
</tr>
</tbody>
</table>
<p>1524665 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=940b0770-3cb9-485b-aea8-0048af5f0b6d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [65]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/stateunmatched_csv.csv"</span><span class="p">)</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[65]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>B1Village</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)</td>
<td>RODDAM (53)</td>
<td>BOKKASAMPALLE(06)</td>
<td>VENKATAPURAM(006 )</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>ANUPALLE(021 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
</tr>
<tr>
<th>10</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>ANUPALLE(15)</td>
<td>MAPAKSHI-PART(023)</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
</tr>
<tr>
<th>12</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>BANDAPALLE(018 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
</tr>
<tr>
<th>19</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)</td>
<td>CHITTOOR(54)</td>
<td>L.B. PURM(13)</td>
<td>DIGUVAMASAPALLE(011 )</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>239255</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>SUKANTA PALLY</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_SUKANTA PALLY</td>
</tr>
<tr>
<th>239257</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>UTTARGUMA</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_UTTARGUMA</td>
</tr>
<tr>
<th>239270</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>DAKSHIN DINAJPUR_HARIRAMPUR_SAIYEDPUR_KURMANPU...</td>
</tr>
<tr>
<th>239468</th>
<td>WEST BENGAL</td>
<td>PURBA MEDINIPUR</td>
<td>BHAGABANPUR-II</td>
<td>GARBARI-I</td>
<td>TIORKHALI</td>
<td>PURBA MEDINIPUR_BHAGABANPUR-II_GARBARI-I_TIORK...</td>
</tr>
<tr>
<th>239476</th>
<td>WEST BENGAL</td>
<td>ALIPURDUAR</td>
<td>FALAKATA</td>
<td>PARANGERPAR</td>
<td>PARANGARPAR</td>
<td>ALIPURDUAR_FALAKATA_PARANGERPAR_PARANGARPAR</td>
</tr>
</tbody>
</table>
<p>9358 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=aa58341d-bb15-48d1-9267-ab5f56528745">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=57d4fefc-5ce5-48df-9794-befe15744366">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/stateunmatched_csv.csv"</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/VillageName_ID_df.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=bd576348-5da5-4b6e-8053-8f269d29f9e0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Fuzzy String Matching Implementation
</div>
<p><a id="fuzzy-string-matching"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
To reconcile mismatches between village identifiers across datasets, fuzzy string matching is used to align entries based on textual similarity. A custom function using the Levenshtein ratio computes the similarity between village identifiers (<code>B1Village</code>) from the water quality dataset and the reference shapefile, restricted to matches within the same state. If the similarity score exceeds a specified threshold (92), the best match is recorded. This process ensures consistent village identifiers for accurate spatial merging, and the matched results are saved state-wise and collectively in a final correction file.
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=6dd15e4c-8fee-4514-be29-c25e908ad456">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="kn">import</span> <span class="n">process</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">Levenshtein</span> <span class="kn">import</span> <span class="n">ratio</span>

<span class="k">def</span> <span class="nf">get_best_match</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">score_threshold</span><span class="o">=</span><span class="mi">92</span><span class="p">):</span>
    <span class="n">best_match</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">ratio</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">choice</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
            <span class="n">best_match</span> <span class="o">=</span> <span class="n">choice</span>
            <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">best_match</span><span class="p">,</span> <span class="n">best_score</span><span class="p">]</span> <span class="k">if</span> <span class="n">best_score</span> <span class="o">&gt;=</span> <span class="n">score_threshold</span> <span class="k">else</span> <span class="kc">None</span>


<span class="c1"># Step 2: Extract unique Districts from both dataframes for fuzzy matching</span>
<span class="n">unique_WQ_District</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'B1Village'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">unique_Shapefile_District</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'B1Village'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Initialize a list to store the new District corrections</span>
<span class="n">district_corrections</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Track which States have been processed to avoid duplicate print statements</span>
<span class="n">processed_State</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># Step 3: Iterate over remaining WQ Districts and perform fuzzy matching</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">unique_WQ_District</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">State</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span>
    <span class="n">District_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'B1Village'</span><span class="p">]</span>
    
    <span class="c1"># Get all unique District names from the shapefile for the same State</span>
    <span class="n">Shapefile_District_names</span> <span class="o">=</span> <span class="n">unique_Shapefile_District</span><span class="p">[</span><span class="n">unique_Shapefile_District</span><span class="p">[</span><span class="s1">'StateName'</span><span class="p">]</span> <span class="o">==</span> <span class="n">State</span><span class="p">][</span><span class="s1">'B1Village'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="c1"># Print progress only if the State hasn't been processed yet</span>
    <span class="k">if</span> <span class="n">State</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processed_State</span><span class="p">:</span>
        <span class="n">corrections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">district_corrections</span><span class="p">)</span>
        <span class="n">corrections_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">State</span><span class="si">}</span><span class="s2">_corrections_df.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">corrections_df</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Shapefile_District_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Fuzzy matching in State: </span><span class="si">{</span><span class="n">State</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Top 5 Districts in State: </span><span class="si">{</span><span class="n">Shapefile_District_names</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">processed_State</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
    
    <span class="c1"># Find the best match for the current District name</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">get_best_match</span><span class="p">(</span><span class="n">District_name</span><span class="p">,</span> <span class="n">Shapefile_District_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">matched_District</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">matched_District</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Store the new correction</span>
    <span class="n">district_corrections</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">'StateName'</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span>
        <span class="s1">'Original District'</span><span class="p">:</span> <span class="n">District_name</span><span class="p">,</span>
        <span class="s1">'Matched District'</span><span class="p">:</span> <span class="n">matched_District</span><span class="p">,</span>
        <span class="s1">'Score'</span><span class="p">:</span> <span class="n">score</span>
    <span class="p">})</span>
    
    <span class="c1"># corrections_df = pd.DataFrame(district_corrections)</span>
    <span class="c1"># display(corrections_df)</span>


<span class="c1"># Step 4: Combine the reference corrections with the new corrections</span>
<span class="n">district_corrections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">district_corrections</span><span class="p">)</span>

<span class="c1"># Step 5: Save the combined corrections to a new file</span>
<span class="n">district_corrections_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/District_corrections.csv"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 6: Output the new corrections DataFrame for verification</span>
<span class="n">district_corrections_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: ANDHRA PRADESH
Top 5 Districts in State: ['Yadadri Bhuvanagiri_Yadagirigutta_Wangapally_Wangapally', 'Yadadri Bhuvanagiri_Yadagirigutta_Thallagudem_Thallagudem', 'Yadadri Bhuvanagiri_Yadagirigutta_Saidapur_Saidapur', 'Yadadri Bhuvanagiri_Yadagirigutta_Saduvally_Saduvally', 'Yadadri Bhuvanagiri_Yadagirigutta_Ramajipet_Ramajipet']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>508</th>
<td>ANDHRA PRADESH</td>
<td>NELLORE(09)_NAIDUPETA   (42)_PUDERU(19) _RAVUL...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>509</th>
<td>ANDHRA PRADESH</td>
<td>VIZIANAGARAM(02)_KURUPAM(03)_TITTIRI(11) (10)_...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>510</th>
<td>ANDHRA PRADESH</td>
<td>PRAKASAM(08)_YERRAGONDA PALEM(01)_RESERVE FORE...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>511</th>
<td>ANDHRA PRADESH</td>
<td>PRAKASAM(08)_YERRAGONDA PALEM(01)_RESERVE FORE...</td>
<td>None</td>
<td>0</td>
</tr>
<tr>
<th>512</th>
<td>ANDHRA PRADESH</td>
<td>VISAKHAPATNAM(03)_G.K.VEEDHI(13)_MONDIGEDDA(16...</td>
<td>None</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>513 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: ARUNACHAL PRADESH
Top 5 Districts in State: ['West Siang_Liromoba-Yomcha_UPPER YOMCHA/ YOMCHA HQ_YOMCHA H.Q.', 'West Siang_Liromoba-Yomcha_UPPER YOMCHA/ YOMCHA HQ_LIPU YOMCHA', 'West Siang_Liromoba-Yomcha_TEGO GAMLIN_TEGO GAMLIN', 'West Siang_Liromoba-Yomcha_SARI LIKAR_SARI LIKAR', 'West Siang_Liromoba-Yomcha_RISE/ DORDI/ LEGI/ BOPU/ LIRUM_RISE']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1435</th>
<td>ARUNACHAL PRADESH</td>
<td>KURUNG KUMEY_TALI CD BLOCK_ZARA_NEW ZARA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1436</th>
<td>ARUNACHAL PRADESH</td>
<td>WEST SIANG_MECHUKHA_TATO-II_ROAD LABOUR CAMP</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1437</th>
<td>ARUNACHAL PRADESH</td>
<td>CHANGLANG_KHAGAM MIAO_MIAO SINGPHO_MIAO HQ BL-...</td>
<td>CHANGLANG_KHAGAM MIAO_MIAO SINGPHO_MIAO HQ BL-...</td>
<td>100.0</td>
</tr>
<tr>
<th>1438</th>
<td>ARUNACHAL PRADESH</td>
<td>LOWER SUBANSIRI_ZIRO-II CD BLOCK_POTIN_EMCHI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1439</th>
<td>ARUNACHAL PRADESH</td>
<td>PAPUM PARE_SAGALEE_RUSUK_MUGLANG</td>
<td>PAPUM PARE_SAGALEE_RUSUK_MUGLANG</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>1440 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: ASSAM
Top 5 Districts in State: ['West Karbi Anglong_Socheng_Socheng (part)_Umpoo', 'West Karbi Anglong_Socheng_Socheng (part)_Umpaweng(langhemphi)', 'West Karbi Anglong_Socheng_Socheng (part)_Socheng', 'West Karbi Anglong_Socheng_Socheng (part)_Rongtara (297675)', 'West Karbi Anglong_Socheng_Socheng (part)_Rongmandiu']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1786</th>
<td>ASSAM</td>
<td>Tinsukia_HAPJAN_BANDARKHITI_BANDARKHATI NO.2</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1787</th>
<td>ASSAM</td>
<td>Tinsukia_SAIKHOWA_KHOBANG_TIPUK 100 FS</td>
<td>Tinsukia_SAIKHOWA_KHOBANG_TIPUK 102(M) FS</td>
<td>93.670886</td>
</tr>
<tr>
<th>1788</th>
<td>ASSAM</td>
<td>Baksha_TAMULPUR_No 4 Pachim Kumarikata VCDC_Am...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1789</th>
<td>ASSAM</td>
<td>Kamrup_Boko-Bongaon_No 9 Dakhin Pub Boko_RANI</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1790</th>
<td>ASSAM</td>
<td>SIVASAGAR_SAPEKHATI_UDOYSHREE_MEDELA JAN NO.3</td>
<td>None</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
<p>1791 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: A &amp; N ISLANDS
Top 5 Districts in State: ['South Andamans_Prothrapur_Sippighat_Teylorabad(rv)', 'South Andamans_Prothrapur_Sippighat_Sippighat (rv)', 'South Andamans_Prothrapur_Sippighat_Bimilitan (rv)', 'South Andamans_Prothrapur_Shyam Nagar (vijaynagar)_Shyam Nagar (rv)', 'South Andamans_Prothrapur_Shyam Nagar (vijaynagar)_Radha Nagar (rv)']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1787</th>
<td>ASSAM</td>
<td>Tinsukia_SAIKHOWA_KHOBANG_TIPUK 100 FS</td>
<td>Tinsukia_SAIKHOWA_KHOBANG_TIPUK 102(M) FS</td>
<td>93.670886</td>
</tr>
<tr>
<th>1788</th>
<td>ASSAM</td>
<td>Baksha_TAMULPUR_No 4 Pachim Kumarikata VCDC_Am...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1789</th>
<td>ASSAM</td>
<td>Kamrup_Boko-Bongaon_No 9 Dakhin Pub Boko_RANI</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1790</th>
<td>ASSAM</td>
<td>SIVASAGAR_SAPEKHATI_UDOYSHREE_MEDELA JAN NO.3</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1791</th>
<td>A &amp; N ISLANDS</td>
<td>NORTH AND MIDDLE ANDAMAN_RANGAT_KADAMTALA_PORL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
<p>1792 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: BIHAR
Top 5 Districts in State: ['Vaishali_Vaishali_Vaishali_Vaishali', 'Vaishali_Vaishali_Salempur_Sohai', 'Vaishali_Vaishali_Salempur_Salempur', 'Vaishali_Vaishali_Salempur_Bariarpur', 'Vaishali_Vaishali_Salempur_Bardahia']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2487</th>
<td>BIHAR</td>
<td>ARARIA_JOKIHAT_DUBBA_DAULATPUR</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2488</th>
<td>BIHAR</td>
<td>GAYA_GURUA_GUNERI_PACMMAH</td>
<td>GAYA_GURUA_GUNERI_PACMMAH</td>
<td>100.0</td>
</tr>
<tr>
<th>2489</th>
<td>BIHAR</td>
<td>KATIHAR_BALRAMPUR_ACHRAN_ACHRAN</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2490</th>
<td>BIHAR</td>
<td>PASHCHIM CHAMPARAN_BAIRIA_ALPHA_baghambarpur</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2491</th>
<td>BIHAR</td>
<td>GOPALGANJ_BHORE_BAGAHAWA MISHIR_BARAI BAGAHWA</td>
<td>GOPALGANJ_BHORE_BAGAHAWA MISHIR_BARAI BAGAHWA</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>2492 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: CHHATTISGARH
Top 5 Districts in State: ['Uttar Bastar Kanker_Narharpur_Umradah_Umaradah', 'Uttar Bastar Kanker_Narharpur_Thanabodi_Thanabodi', 'Uttar Bastar Kanker_Narharpur_Surhi_Surahi', 'Uttar Bastar Kanker_Narharpur_Shriguhan_Shriguhan', 'Uttar Bastar Kanker_Narharpur_Shamtara_Shamtara']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2780</th>
<td>CHHATTISGARH</td>
<td>NARAYANPUR_ORCHHA(ABHUJMAD)_NEDNAR_KODNAR AL</td>
<td>NARAYANPUR_ORCHHA(ABHUJMAD)_NEDNAR_KODKANAR</td>
<td>94.252874</td>
</tr>
<tr>
<th>2781</th>
<td>CHHATTISGARH</td>
<td>NARAYANPUR_ORCHHA(ABHUJMAD)_NEDNAR_TOYAMETA</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2782</th>
<td>CHHATTISGARH</td>
<td>BILASPUR_BILHA_PENDARVA_SAMBALPURI</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2783</th>
<td>CHHATTISGARH</td>
<td>JASHPUR_BAGICHA_BUTANGA_RANGPUR</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2784</th>
<td>CHHATTISGARH</td>
<td>JASHPUR_JASHPUR_BALACHHAPER_CHHOTA BANAI</td>
<td>JASHPUR_JASHPUR_BALACHHAPER_CHHOTA BANAI</td>
<td>100.000000</td>
</tr>
</tbody>
</table>
<p>2785 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: GUJARAT
Top 5 Districts in State: ['Valsad_Vapi_Vatar_Vatar', 'Valsad_Vapi_Salvav_Salvav', 'Valsad_Vapi_Rata_Rata', 'Valsad_Vapi_Pandor Vankachh_Vankachh', 'Valsad_Vapi_Pandor Vankachh_Pandor']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>3195</th>
<td>GUJARAT</td>
<td>GANDHINAGAR_DEHGAM_HARSOLI_JIVAJINI MUVA</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3196</th>
<td>GUJARAT</td>
<td>GANDHINAGAR_DEHGAM_NAVALPUR_NAVALPUR</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3197</th>
<td>GUJARAT</td>
<td>GANDHINAGAR_GANDHINAGAR_VAVOL_VASANA HADMAT</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3198</th>
<td>GUJARAT</td>
<td>GANDHINAGAR_MANSA_VIJAYANAGAR_VIJAYNAGAR</td>
<td>GANDHINAGAR_MANSA_VIJAYANAGAR_VIJAYANAGAR</td>
<td>98.765432</td>
</tr>
<tr>
<th>3199</th>
<td>GUJARAT</td>
<td>JUNAGADH_JUNAGADH_DERAVAN_BHAVNATH</td>
<td>JUNAGADH_JUNAGADH_DERAVAN_BHAVNATH</td>
<td>100.000000</td>
</tr>
</tbody>
</table>
<p>3200 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: HARYANA
Top 5 Districts in State: ['Yamunanagar_Saraswati Nagar_Uncha Chandana_Uncha Chandana', 'Yamunanagar_Saraswati Nagar_Topra Khurd_Topra Khurd', 'Yamunanagar_Saraswati Nagar_Taprapur_Taprapur', 'Yamunanagar_Saraswati Nagar_Talakaur_Talakaur', 'Yamunanagar_Saraswati Nagar_Talakaur_Gautam Nagar']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>3701</th>
<td>HARYANA</td>
<td>YAMUNANAGAR_KHIZRABAD_NAGALPATTI MILK_NAGAL CH...</td>
<td>YAMUNANAGAR_KHIZRABAD_NAGALPATTI MILK_NAGAL CH...</td>
<td>100.0</td>
</tr>
<tr>
<th>3702</th>
<td>HARYANA</td>
<td>YAMUNANAGAR_MUSTAFABAD_FARIDPUR_AHMADPUR-MUSTA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3703</th>
<td>HARYANA</td>
<td>YAMUNANAGAR_RADAUR_CHOTTA BASS_CHHOTA BANS</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3704</th>
<td>HARYANA</td>
<td>YAMUNANAGAR_RADAUR_JATHLANA_DHAKWALA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3705</th>
<td>HARYANA</td>
<td>YAMUNANAGAR_RADAUR_KARHERA M.T._NAKUM</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>3706 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: HIMACHAL PRADESH
Top 5 Districts in State: ['Una_Una_Upper Dehlan_Upper Dehlan', 'Una_Una_Upper Dehlan_Bans Npimsra', 'Una_Una_Udaipur_Udheypur', 'Una_Una_Teuri_Tieuri -ii', 'Una_Una_Teuri_Teuri-i']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4015</th>
<td>HIMACHAL PRADESH</td>
<td>KANGRA_BAIJNATH_KASBA PAPROLA _KASBA PAPROLA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4016</th>
<td>HIMACHAL PRADESH</td>
<td>KANGRA_NURPUR_CHARURI_CHARURI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4017</th>
<td>HIMACHAL PRADESH</td>
<td>SIRMAUR_NAHAN_KOTLA MOLAR_CHAMIYANA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4018</th>
<td>HIMACHAL PRADESH</td>
<td>SIRMAUR_PACHHAD_SURLA JANOT_Surla Janot</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4019</th>
<td>HIMACHAL PRADESH</td>
<td>SIRMAUR_PAONTA SAHIB_CHHACHHETTI_AJAULI</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>4020 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: JAMMU &amp; KASHMIR
Top 5 Districts in State: ['Udhampur_Udhampur_Tirshi_Tirshi', 'Udhampur_Udhampur_Tirshi_Narrore', 'Udhampur_Udhampur_Tirshi_Narore', 'Udhampur_Udhampur_Sunthan_Sounthan', 'Udhampur_Udhampur_Sunadi_Sunadi']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4137</th>
<td>JAMMU &amp; KASHMIR</td>
<td>DODA_THATHRI_KANSOO_KANSOO</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4138</th>
<td>JAMMU &amp; KASHMIR</td>
<td>KUPWARA_TEETHWAL_IBKOTE_IBKOTE</td>
<td>KUPWARA_TEETHWAL_IBKOTE_IBKOTE</td>
<td>100.0</td>
</tr>
<tr>
<th>4139</th>
<td>JAMMU &amp; KASHMIR</td>
<td>DODA_BHALESSA_GANDOH_TRINKHAL</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4140</th>
<td>JAMMU &amp; KASHMIR</td>
<td>DODA_BHALESSA_TANTI_CHANGER</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4141</th>
<td>JAMMU &amp; KASHMIR</td>
<td>KUPWARA_KRALPORA_MANCHTRA_MANCHTRA</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>4142 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: JHARKHAND
Top 5 Districts in State: ['West Singhbhum_Tonto_Tonto_Udalkam', 'West Singhbhum_Tonto_Tonto_Topa Bera', 'West Singhbhum_Tonto_Tonto_Tonto', 'West Singhbhum_Tonto_Tonto_Tensra', 'West Singhbhum_Tonto_Tonto_Lisimoti']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4417</th>
<td>JHARKHAND</td>
<td>PALAMU_PIPRA_BHABHANDI_BATAUA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4418</th>
<td>JHARKHAND</td>
<td>PALAMU_PIPRA_BHABHANDI_KUMHAIA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4419</th>
<td>JHARKHAND</td>
<td>PALAMU_PIPRA_BHABHANDI_MAJURAHA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4420</th>
<td>JHARKHAND</td>
<td>SAHIBGANJ_BARHAIT_FULBHANGA_LAXMIBATHAN</td>
<td>SAHIBGANJ_BARHAIT_FULBHANGA_LAXMIBATHAN</td>
<td>100.0</td>
</tr>
<tr>
<th>4421</th>
<td>JHARKHAND</td>
<td>PALAMU_PATAN_KISUNPUR_CHANDEYA</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>4422 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: KARNATAKA
Top 5 Districts in State: ['Yadgir_Yadgir_Yeleri_Yeleri', 'Yadgir_Yadgir_Yeleri_Nawabruz', 'Yadgir_Yadgir_Yargol_Yargol', 'Yadgir_Yadgir_Yampada_Yampad', 'Yadgir_Yadgir_Yampada_Tatalgera']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4557</th>
<td>KARNATAKA</td>
<td>BELGAUM_ATHANI_NAGANUR P.K._Dodawad</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4558</th>
<td>KARNATAKA</td>
<td>BELGAUM_BELGAUM_NEW VANTAMURI_NEW VANTAMURI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4559</th>
<td>KARNATAKA</td>
<td>BELGAUM_SAUNDATTI_MALLUR_INGALAGI</td>
<td>BELGAUM_SAUNDATTI_MALLUR_INGALAGI</td>
<td>100.0</td>
</tr>
<tr>
<th>4560</th>
<td>KARNATAKA</td>
<td>BELGAUM_SAUNDATTI_MURAGOD_SUBBAPUR</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4561</th>
<td>KARNATAKA</td>
<td>BELGAUM_SAUNDATTI_TALLUR_JEEVAPUR</td>
<td>BELGAUM_SAUNDATTI_TALLUR_JEEVAPUR</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>4562 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: KERALA
Top 5 Districts in State: ['Wayanad_Sulthan Bathery_Noolpuzha_Noolpuzha', 'Wayanad_Sulthan Bathery_Noolpuzha_Kuppadi', 'Wayanad_Sulthan Bathery_Noolpuzha_Kidanganad', 'Wayanad_Sulthan Bathery_Nenmeni_Nenmeni', 'Wayanad_Sulthan Bathery_Nenmeni_Cheeral']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4654</th>
<td>KERALA</td>
<td>KOTTAYAM_KANJIRAPPALLY_KANJIRAPALLY_VIZHIKKITHODU</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4655</th>
<td>KERALA</td>
<td>KOTTAYAM_KANJIRAPPALLY_MANIMALA_KARIKKATOOR</td>
<td>KOTTAYAM_KANJIRAPPALLY_MANIMALA_KARIKKATOOR</td>
<td>100.0</td>
</tr>
<tr>
<th>4656</th>
<td>KERALA</td>
<td>KOTTAYAM_KANJIRAPPALLY_PARATHODE_PULKKUNNU</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4657</th>
<td>KERALA</td>
<td>KOTTAYAM_KANJIRAPPALLY_PARATHODE_VEGATHANAM</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4658</th>
<td>KERALA</td>
<td>KOTTAYAM_KANJIRAPPALLY_PARATHODE_VELICHIYANI</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>4659 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: MADHYA PRADESH
Top 5 Districts in State: ['Vidisha_Vidisha_Tharr_Tharr', 'Vidisha_Vidisha_Thanner_Thanner', 'Vidisha_Vidisha_Thanner_Salaikhedi', 'Vidisha_Vidisha_Thanner_Porukhedi', 'Vidisha_Vidisha_Sunpura_Udaigiri']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>5589</th>
<td>MADHYA PRADESH</td>
<td>UMARIA_KARKELI_KODIA 1_PAHARIGUDA</td>
<td>UMARIA_KARKELI_KODIA 22_PAHARIGUDA</td>
<td>95.522388</td>
</tr>
<tr>
<th>5590</th>
<td>MADHYA PRADESH</td>
<td>UMARIA_KARKELI_MAJHOULI KHURD_MAGAR1</td>
<td>UMARIA_KARKELI_MAJHOULI KHURD_MAGAR</td>
<td>98.591549</td>
</tr>
<tr>
<th>5591</th>
<td>MADHYA PRADESH</td>
<td>UMARIA_KARKELI_PINORA_BELAPANI</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>5592</th>
<td>MADHYA PRADESH</td>
<td>RAISEN_UDAIPURA_DUNGARIYA JAGIR_BALARPUR</td>
<td>RAISEN_UDAIPURA_DUNGARIYA JAGIR_BALARPUR</td>
<td>100.000000</td>
</tr>
<tr>
<th>5593</th>
<td>MADHYA PRADESH</td>
<td>SEHORE_SEHORE_HINOTI_SIKANDARPUR</td>
<td>SEHORE_SEHORE_HINOTI_SIKANDARPUR</td>
<td>100.000000</td>
</tr>
</tbody>
</table>
<p>5594 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: MAHARASHTRA
Top 5 Districts in State: ['Yavatmal_Zari Jamni_Zamkola_Zamkola', 'Yavatmal_Zari Jamni_Zamkola_Yesapur', 'Yavatmal_Zari Jamni_Zamkola_Junoni', 'Yavatmal_Zari Jamni_Yedshi_Yedashi', 'Yavatmal_Zari Jamni_Yedlapur_Yedalapur']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6236</th>
<td>MAHARASHTRA</td>
<td>WARDHA_WARDHA_NERI (PUNARVASAN)_NERI (Punarvasan)</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6237</th>
<td>MAHARASHTRA</td>
<td>DHULE_DHULE_AVADHAN_AWADHAN</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6238</th>
<td>MAHARASHTRA</td>
<td>LATUR_AHMADPUR_WARWANTI_MARSHIWANI TANDA</td>
<td>LATUR_AHMADPUR_WARWANTI_WARWANTI TANDA</td>
<td>92.307692</td>
</tr>
<tr>
<th>6239</th>
<td>MAHARASHTRA</td>
<td>PALGHAR_WADA_WADA_WADA (CT)</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6240</th>
<td>MAHARASHTRA</td>
<td>PUNE_HAVELI_DHAYARI_Dhayari (Part)  (N.V.)</td>
<td>None</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
<p>6241 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: MANIPUR
Top 5 Districts in State: ['Ukhrul_Ukhrul_Yaolen_Yaolen', 'Ukhrul_Ukhrul_Wunghon_Wunghon', 'Ukhrul_Ukhrul_Ukhrul_Ukhrul', 'Ukhrul_Ukhrul_Tushen (tushar)_Tushem', 'Ukhrul_Ukhrul_T.m.kasom_Tm Kasom']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6313</th>
<td>MANIPUR</td>
<td>CHURACHANDPUR_SAMULAMLAN_P.BOLJANG_P.BOLJANG</td>
<td>CHURACHANDPUR_SAMULAMLAN_PHOLJANG_PHOLJANG</td>
<td>93.023256</td>
</tr>
<tr>
<th>6314</th>
<td>MANIPUR</td>
<td>CHURACHANDPUR_TUIBONG_GANGPIJANG_GANGPIJANG</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6315</th>
<td>MANIPUR</td>
<td>SENAPATI_MAO MARAM_Khabung_Khabung</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6316</th>
<td>MANIPUR</td>
<td>UKHRUL_UKHRUL_SHIHAI KAHAOPHUNG_SHIHAI KAHAOPHUNG</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>6317</th>
<td>MANIPUR</td>
<td>UKHRUL_UKHRUL_TUSHEM_TUSHEM</td>
<td>None</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
<p>6318 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: MEGHALAYA
Top 5 Districts in State: ['West Khasi Hills_Nongstoin_Waregro_Waregro', 'West Khasi Hills_Nongstoin_Wahlyngdoh_Wahlyngdoh', 'West Khasi Hills_Nongstoin_Wahjynriew_Wahjynriew', 'West Khasi Hills_Nongstoin_Urkhli_Urkhli', 'West Khasi Hills_Nongstoin_Urkali_Urkali']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6519</th>
<td>MEGHALAYA</td>
<td>EAST KHASI HILLS_MAWPHLANG_LEN MAWTAP_LENMAWTAP</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6520</th>
<td>MEGHALAYA</td>
<td>WEST KHASI HILLS_MAWSHYNRUT_TYNRONG UMKREM_TYN...</td>
<td>WEST KHASI HILLS_MAWSHYNRUT_TYNRONG UMKREM_TYN...</td>
<td>100.0</td>
</tr>
<tr>
<th>6521</th>
<td>MEGHALAYA</td>
<td>EAST GARO HILLS_SAMANDA_PATALGRE (NENGSRANG PA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6522</th>
<td>MEGHALAYA</td>
<td>NORTH GARO HILLS_RESUBELPARA_BAKENANG NALSA_Ba...</td>
<td>NORTH GARO HILLS_RESUBELPARA_BAKENANG NALSA_Ba...</td>
<td>100.0</td>
</tr>
<tr>
<th>6523</th>
<td>MEGHALAYA</td>
<td>NORTH GARO HILLS_RESUBELPARA_UPPER BOLSONG B M...</td>
<td>NORTH GARO HILLS_RESUBELPARA_UPPER BOLSONG B M...</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>6524 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: MIZORAM
Top 5 Districts in State: ['Siaha_Tuipang_Zawngling_Zawngling', 'Siaha_Tuipang_Vahai_Vahai', 'Siaha_Tuipang_Tuisih_Tuisih', 'Siaha_Tuipang_Tuipang V_Tuipang V', 'Siaha_Tuipang_Tuipang L_Tuipang L']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6630</th>
<td>MIZORAM</td>
<td>SAIHA_SANGAU_VARTEK_VARTEK</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6631</th>
<td>MIZORAM</td>
<td>SAIHA_TUIPANG_LEIHRI_LEIHRI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6632</th>
<td>MIZORAM</td>
<td>SAIHA_TUIPANG_ZEROPOINT_ZERO POINT</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6633</th>
<td>MIZORAM</td>
<td>SERCHHIP_SERCHHIP_Baktawng T_Baktawng T</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6634</th>
<td>MIZORAM</td>
<td>LAWNGTLAI_SANGAU_FUNGKAH_Fungkah</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>6635 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: NAGALAND
Top 5 Districts in State: ['Zunheboto_Zunheboto_Yezami_Yezami', 'Zunheboto_Zunheboto_Yemishe_Yemishe', 'Zunheboto_Zunheboto_Sukhalu_Sukhalu', 'Zunheboto_Zunheboto_Shotomi_Shotomi', 'Zunheboto_Zunheboto_Sheipu_Sheipu']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6720</th>
<td>NAGALAND</td>
<td>DIMAPUR_CHUMUKEDIMA_CHUMUKEDIMA_SIGNAL ANGAMI ...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6721</th>
<td>NAGALAND</td>
<td>DIMAPUR_CHUMUKEDIMA_CHUMUKEDIMA_THAHEKHU BLOCK V</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6722</th>
<td>NAGALAND</td>
<td>DIMAPUR_MEDZIPHEMA_MED_CHUMUKEDIMA   A</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6723</th>
<td>NAGALAND</td>
<td>DIMAPUR_MEDZIPHEMA_MED_SANGTAMTILA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>6724</th>
<td>NAGALAND</td>
<td>MOKOKCHUNG_ONGPANGKONG(N)_ONPKNG(N)_LONGSA GMS...</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>6725 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: ODISHA
Top 5 Districts in State: ['Sundargarh_Tangarpali_Ujalpur_Ujalpur', 'Sundargarh_Tangarpali_Ujalpur_Tumbapali', 'Sundargarh_Tangarpali_Ujalpur_Khuntamunda', 'Sundargarh_Tangarpali_Ujalpur_Jhariapali', 'Sundargarh_Tangarpali_Ujalpur_Fuldhudi']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7225</th>
<td>ODISHA</td>
<td>SAMBALPUR_RAIRAKHOL_CHARMAL_BAGDOLI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7226</th>
<td>ODISHA</td>
<td>SUBARNAPUR_BIRMAHARAJPUR_JATESINGHA_KEUTIPALI</td>
<td>SUBARNAPUR_BIRMAHARAJPUR_JATESINGHA_KEUTIPALI</td>
<td>100.0</td>
</tr>
<tr>
<th>7227</th>
<td>ODISHA</td>
<td>SUBARNAPUR_SONEPUR_KHALIAPALI_MAYURUDAN</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7228</th>
<td>ODISHA</td>
<td>SUNDARGARH_BALISANKARA_BIRKALDIHI_PUTUDIHI</td>
<td>SUNDARGARH_BALISANKARA_BIRKALDIHI_PUTUDIHI</td>
<td>100.0</td>
</tr>
<tr>
<th>7229</th>
<td>ODISHA</td>
<td>SUNDARGARH_SADAR,SUNDARGARH_KIREI_KANDHABAHAL</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>7230 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: PUNJAB
Top 5 Districts in State: ['Tarn Taran_Valtoha-15_Wan Tara Singh_Wan Tara Singh', 'Tarn Taran_Valtoha-15_Varnala_Varnala', 'Tarn Taran_Valtoha-15_Thathi Jaimal Singh_Thathi Jaimal Singh', 'Tarn Taran_Valtoha-15_Sarai Valtoha_Sarai Valtoha', 'Tarn Taran_Valtoha-15_Sankatra_Sankatra']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7604</th>
<td>PUNJAB</td>
<td>SAS NAGAR_KHARAR_HARLALPUR_HARLALPUR</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7605</th>
<td>PUNJAB</td>
<td>SAS NAGAR_KHARAR_KHUNI MAJRA_KHUNI MAJRA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7606</th>
<td>PUNJAB</td>
<td>BATHINDA_RAMPURA_BUGRAN_BUGRAN</td>
<td>BATHINDA_RAMPURA_BUGRAN_BUGRAN</td>
<td>100.0</td>
</tr>
<tr>
<th>7607</th>
<td>PUNJAB</td>
<td>KAPURTHALA_KAPURTHALA_KESAR PUR_GAUNSWALA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7608</th>
<td>PUNJAB</td>
<td>KAPURTHALA_KAPURTHALA_PHIALY_TALWANDI PAKHAN</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>7609 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: RAJASTHAN
Top 5 Districts in State: ['Udaipur_Vallabhnagar_Vallabhnagar_Vallabhanagar', 'Udaipur_Vallabhnagar_Vallabhnagar_Uda Khera', 'Udaipur_Vallabhnagar_Vallabhnagar_Kali Pahari', 'Udaipur_Vallabhnagar_Vallabhnagar_Gumanpura', 'Udaipur_Vallabhnagar_Vallabhnagar_Bhana Mangra']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7956</th>
<td>RAJASTHAN</td>
<td>UDAIPUR_BADGAON_BHUWANA_JHARONO KI SARAI</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7957</th>
<td>RAJASTHAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI CHOLAWATAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI CHOLAWATAN</td>
<td>100.0</td>
</tr>
<tr>
<th>7958</th>
<td>RAJASTHAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI JASAWATAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI JASAWATAN</td>
<td>100.0</td>
</tr>
<tr>
<th>7959</th>
<td>RAJASTHAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI THEDA</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI THEDA</td>
<td>100.0</td>
</tr>
<tr>
<th>7960</th>
<td>RAJASTHAN</td>
<td>PALI_RAIPUR_BAR_Rel Magra</td>
<td>PALI_RAIPUR_BAR_Rel Magra</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>7961 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: SIKKIM
Top 5 Districts in State: ['West_Yuksom_Yoksom_Yoksom', 'West_Yuksom_Yoksom_Dubdi', 'West_Yuksom_Thingling-khecheoperi_Tsozo', 'West_Yuksom_Thingling-khecheoperi_Thingling - Ii', 'West_Yuksom_Thingling-khecheoperi_Thingling - I']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>7959</th>
<td>RAJASTHAN</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI THEDA</td>
<td>JODHPUR_BHOPALGARH_BHOPALGARH_BASNI THEDA</td>
<td>100.0</td>
</tr>
<tr>
<th>7960</th>
<td>RAJASTHAN</td>
<td>PALI_RAIPUR_BAR_Rel Magra</td>
<td>PALI_RAIPUR_BAR_Rel Magra</td>
<td>100.0</td>
</tr>
<tr>
<th>7961</th>
<td>SIKKIM</td>
<td>SOUTH_NAMCHI_SINGITHANG_SINGHITHANG</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7962</th>
<td>SIKKIM</td>
<td>WEST_SORENG_TAKOTHANG_TAKOTHANG</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>7963</th>
<td>SIKKIM</td>
<td>WEST_GYALSHING_BANGTEN SAPONG_SRINAGI</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>7964 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: TAMIL NADU
Top 5 Districts in State: ['Virudhunagar_Watrap_Vellapottal_Vellaipottal', 'Virudhunagar_Watrap_Valayapatti_Kunnur', 'Virudhunagar_Watrap_Valayankula,m_Ayan Karisalkulam', 'Virudhunagar_Watrap_Vadugapatti_Vadugapatti', 'Virudhunagar_Watrap_VADUGAPATTI_VADUGAPATTI']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>8147</th>
<td>ANDHRA PRADESH</td>
<td>SURYAPET(25)_SURYAPET(26)_RAYANI GUDEM(12)_PIL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8148</th>
<td>ANDHRA PRADESH</td>
<td>SURYAPET(25)_TIRMALAGIRI(07)_ANANTHARAM(14)_AN...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8149</th>
<td>ANDHRA PRADESH</td>
<td>SURYAPET(25)_TIRMALAGIRI(07)_MALIPURAM(10)_MAL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8150</th>
<td>ANDHRA PRADESH</td>
<td>SURYAPET(25)_TIRMALAGIRI(07)_NANDAPURAM(02)_NA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8151</th>
<td>ANDHRA PRADESH</td>
<td>SURYAPET(25)_TIRMALAGIRI(07)_TIRMALAGIRI(03)_T...</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>8152 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: TRIPURA
Top 5 Districts in State: ['West Tripura_Old Agartala_West Radhamohanpur_Radhamohanpur', 'West Tripura_Old Agartala_West Noagaon_Purba Noagaon', 'West Tripura_Old Agartala_West Noabadi_Radhakishorenagar', 'West Tripura_Old Agartala_West Champamura_Uttar Champamura', 'West Tripura_Old Agartala_Uttar Champamura_Old Agartala']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>8173</th>
<td>TRIPURA</td>
<td>WEST TRIPURA_MOHANPUR_LANKAMURA_LANKAMURA JALA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8174</th>
<td>TRIPURA</td>
<td>WEST TRIPURA_MOHANPUR_TARANAGAR_MOHANPUR BAZAR</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8175</th>
<td>TRIPURA</td>
<td>WEST TRIPURA_MOHANPUR_TULABAGAN_TULABAGAN</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8176</th>
<td>TRIPURA</td>
<td>SEPAHIJALA_JAMPAIJALA_MOHANPUR_MOHANPUR PARA</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8177</th>
<td>TRIPURA</td>
<td>DHALAI  _AMBASSA_AMBASSA_AMBASSA COLONEY</td>
<td>None</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>8178 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: UTTAR PRADESH
Top 5 Districts in State: ['Varanasi_Sewapuri_Varema_Varema', 'Varanasi_Sewapuri_Varema_Patarchakk', 'Varanasi_Sewapuri_Varani_Varani', 'Varanasi_Sewapuri_Varani_Sapehata', 'Varanasi_Sewapuri_Vankadh_Vankadh']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>8847</th>
<td>UTTAR PRADESH</td>
<td>MAU_MUHAMMADABAD GOHANA_JAMALPUR_PHARIDPUR</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>8848</th>
<td>UTTAR PRADESH</td>
<td>SANT KABEER NAGAR_BAGHAULI_BAKHIRA URF BAGHNAG...</td>
<td>SANT KABEER NAGAR_BAGHAULI_BAKHIRA URF BAGHNAG...</td>
<td>100.0</td>
</tr>
<tr>
<th>8849</th>
<td>UTTAR PRADESH</td>
<td>SHRAVASTI_JAMUNAHA_BELRI_KUNDWA</td>
<td>SHRAVASTI_JAMUNAHA_BELRI_KUNDWA</td>
<td>100.0</td>
</tr>
<tr>
<th>8850</th>
<td>UTTAR PRADESH</td>
<td>UNNAO_SIKANDERPUR SAROSI_RAUTAPUR_KATARI RAUTAPUR</td>
<td>UNNAO_SIKANDERPUR SAROSI_RAUTAPUR_KATARI RAUTAPUR</td>
<td>100.0</td>
</tr>
<tr>
<th>8851</th>
<td>UTTAR PRADESH</td>
<td>VARANASI_CHIRAI GAON_LEDHUPUR_LADHUPUR</td>
<td>VARANASI_CHIRAI GAON_LEDHUPUR_LADHUPUR</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>8852 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: UTTARAKHAND
Top 5 Districts in State: ['Uttarkashi_Purola_Vesti Palli_Vesti Valli', 'Uttarkashi_Purola_Vesti Palli_Vesti Palli', 'Uttarkashi_Purola_Thadunga_Thadung', 'Uttarkashi_Purola_Syaluka_Syaluka', 'Uttarkashi_Purola_Sweel_Sweel']
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9010</th>
<td>UTTARAKHAND</td>
<td>GARHWAL_EKESHWAR_SANGLAKOTHE_SERA CHAUK</td>
<td>GARHWAL_EKESHWAR_SANGLAKOTHE_SERA CHAUK</td>
<td>100.0</td>
</tr>
<tr>
<th>9011</th>
<td>UTTARAKHAND</td>
<td>NAINITAL_BHIMTAL_BHAGTURA_BHARATPUR</td>
<td>NAINITAL_BHIMTAL_BHAGTURA_BHARATPUR</td>
<td>100.0</td>
</tr>
<tr>
<th>9012</th>
<td>UTTARAKHAND</td>
<td>PITHORAGARH_BIN_CHHANA PANDEY_GURNA R.F.</td>
<td>PITHORAGARH_BIN_CHHANA PANDEY_GURNA R.F.</td>
<td>100.0</td>
</tr>
<tr>
<th>9013</th>
<td>UTTARAKHAND</td>
<td>TEHRI GARHWAL_KIRTINAGAR_BADIYAR_DHAR KOT</td>
<td>TEHRI GARHWAL_KIRTINAGAR_BADIYAR_DHAR KOT</td>
<td>100.0</td>
</tr>
<tr>
<th>9014</th>
<td>UTTARAKHAND</td>
<td>TEHRI GARHWAL_KIRTINAGAR_BAINJWARI_VEJWADI</td>
<td>TEHRI GARHWAL_KIRTINAGAR_BAINJWARI_VEJWADI</td>
<td>100.0</td>
</tr>
</tbody>
</table>
<p>9015 rows × 4 columns</p>
</div>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Fuzzy matching in State: WEST BENGAL
Top 5 Districts in State: ['Uttar Dinajpur_Raiganj_Sitgram_Tenra', 'Uttar Dinajpur_Raiganj_Sitgram_Sitgram', 'Uttar Dinajpur_Raiganj_Sitgram_Shitalpur', 'Uttar Dinajpur_Raiganj_Sitgram_Shialtor', 'Uttar Dinajpur_Raiganj_Sitgram_Paikpara']
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[67]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Original District</th>
<th>Matched District</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ANDHRA PRADESH</td>
<td>ANANTAPUR(12)_RODDAM (53)_BOKKASAMPALLE(06)_VE...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>1</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_ANUPALL...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>2</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_ANUPALLE(15)_MAPAKSH...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>3</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_BANDAP...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>4</th>
<td>ANDHRA PRADESH</td>
<td>CHITTOOR(10)_CHITTOOR(54)_L.B. PURM(13)_DIGUVA...</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9039</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_SUKANTA PALLY</td>
<td>None</td>
<td>0.000000</td>
</tr>
<tr>
<th>9040</th>
<td>WEST BENGAL</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_UTTARGUMA</td>
<td>NORTH 24 PARAGANAS_HABRA-II_GUMA-I_GUMA</td>
<td>93.975904</td>
</tr>
<tr>
<th>9041</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR_HARIRAMPUR_SAIYEDPUR_KURMANPU...</td>
<td>DAKSHIN DINAJPUR_HARIRAMPUR_SAIYEDPUR_KURMANPU...</td>
<td>100.000000</td>
</tr>
<tr>
<th>9042</th>
<td>WEST BENGAL</td>
<td>PURBA MEDINIPUR_BHAGABANPUR-II_GARBARI-I_TIORK...</td>
<td>PURBA MEDINIPUR_BHAGABANPUR-II_GARBARI-I_TIORK...</td>
<td>92.592593</td>
</tr>
<tr>
<th>9043</th>
<td>WEST BENGAL</td>
<td>ALIPURDUAR_FALAKATA_PARANGERPAR_PARANGARPAR</td>
<td>ALIPURDUAR_FALAKATA_PARANGERPAR_PARANGARPAR</td>
<td>100.000000</td>
</tr>
</tbody>
</table>
<p>9044 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b08936e7-7aef-4a9a-858f-900dae66b9e3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Integrating Fuzzy-Matched Identifiers
</div>
<p><a id="integrating-fuzzy-matched"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
The final step integrates the fuzzy-matched village identifiers with their unique IDs. First, duplicates are removed from the reference village dataset to ensure one-to-one mapping. The merged DataFrame links the corrected village names from the fuzzy match with their corresponding <code>Villageid</code>. Subsequently, the composite identifier (<code>B1Village</code>) is split back into its constituent administrative units—District, Block, Panchayat, and Village—for granular referencing. This structured format allows accurate mapping and downstream analysis aligned with spatial or administrative boundaries.
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1b5f8ef1-ab7b-4ecd-8b0b-27268e60e726">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
<span class="n">district_corrections_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/District_corrections.csv"</span><span class="p">)</span>
<span class="n">district_corrections_df</span> <span class="o">=</span> <span class="n">district_corrections_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/VillageName_ID_df.csv"</span><span class="p">)</span>
<span class="n">VillageName_ID_df</span> <span class="o">=</span> <span class="n">VillageName_ID_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="s2">"B1Village"</span><span class="p">,</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">district_corrections_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">VillageName_ID_df</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'B1Village'</span><span class="p">]],</span> <span class="n">left_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s2">"Matched District"</span><span class="p">],</span> <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s2">"B1Village"</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">"inner"</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">'StateName'</span><span class="p">,</span> <span class="s1">'B1Village'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span>
<span class="n">split_columns</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'B1Village'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">split_columns</span>

<span class="c1"># Drop the original 'B1Village' column if not needed</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'B1Village'</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[68]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>Villageid</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ARUNACHAL PRADESH</td>
<td>26986</td>
<td>UPPER SUBANSIRI</td>
<td>BARIRIJO</td>
<td>BORA RUPOK</td>
<td>BORA RUPOK</td>
</tr>
<tr>
<th>1</th>
<td>ARUNACHAL PRADESH</td>
<td>26739</td>
<td>UPPER SUBANSIRI</td>
<td>TALIHA</td>
<td>JARING-V</td>
<td>MERING MARA</td>
</tr>
<tr>
<th>2</th>
<td>ARUNACHAL PRADESH</td>
<td>586525</td>
<td>ANJAW</td>
<td>CHAGLAGAM</td>
<td>KROMNA</td>
<td>TELELENKAP-METALIANG</td>
</tr>
<tr>
<th>3</th>
<td>ARUNACHAL PRADESH</td>
<td>28034</td>
<td>ANJAW</td>
<td>HAYULIANG</td>
<td>GAMLIANG</td>
<td>DOILIANG</td>
</tr>
<tr>
<th>4</th>
<td>ARUNACHAL PRADESH</td>
<td>622251</td>
<td>ANJAW</td>
<td>HAYULIANG</td>
<td>HAYULIANG</td>
<td>MELE</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1745</th>
<td>WEST BENGAL</td>
<td>486482</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>BHABANIPUR BEJPUKUR (I)</td>
</tr>
<tr>
<th>1746</th>
<td>WEST BENGAL</td>
<td>662392</td>
<td>NORTH 24 PARAGANAS</td>
<td>HABRA-II</td>
<td>GUMA-I</td>
<td>GUMA</td>
</tr>
<tr>
<th>1747</th>
<td>WEST BENGAL</td>
<td>486479</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
</tr>
<tr>
<th>1748</th>
<td>WEST BENGAL</td>
<td>632639</td>
<td>PURBA MEDINIPUR</td>
<td>BHAGABANPUR-II</td>
<td>GARBARI-I</td>
<td>TIORKHALI DAKSHIN</td>
</tr>
<tr>
<th>1749</th>
<td>WEST BENGAL</td>
<td>482146</td>
<td>ALIPURDUAR</td>
<td>FALAKATA</td>
<td>PARANGERPAR</td>
<td>PARANGARPAR</td>
</tr>
</tbody>
</table>
<p>1750 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=0a148d1e-f861-4170-917c-a1961f063773">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Final Merge of Unmatched Records
</div>
<p><a id="final-merge-unmatched"></a></p>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
The final merge integrates previously unmatched NRDWP records from individual state files with the corrected village identifiers. For each state, unmatched data is read and concatenated into a unified DataFrame. This is then inner-joined with the cleaned and fuzzy-matched records on the complete administrative hierarchy—District, Block, Panchayat, and Village. The result is a harmonized dataset where previously unmatched village-level NRDWP entries are now mapped to unique <code>Villageid</code>s, enabling downstream integration with geospatial or demographic datasets.
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4b3796c7-f37b-418b-8d55-346fadcb4699">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Ignore all warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="n">statelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ANDHRA PRADESH'</span><span class="p">,</span><span class="s1">'ARUNACHAL PRADESH'</span><span class="p">,</span><span class="s1">'ASSAM'</span><span class="p">,</span><span class="s1">'Andaman &amp; Nicobar Islands'</span><span class="p">,</span><span class="s1">'BIHAR'</span><span class="p">,</span><span class="s1">'CHATTISGARH'</span><span class="p">,</span> <span class="s1">'CHHATTISGARH'</span><span class="p">,</span><span class="s1">'GOA'</span><span class="p">,</span>
              <span class="s1">'GUJARAT'</span><span class="p">,</span> <span class="s1">'HARYANA'</span><span class="p">,</span> <span class="s1">'HIMACHAL PRADESH'</span><span class="p">,</span> <span class="s1">'JAMMU &amp; KASHMIR'</span><span class="p">,</span> <span class="s1">'JAMMU AND KASHMIR'</span><span class="p">,</span> <span class="s1">'JHARKHAND'</span><span class="p">,</span> <span class="s1">'KARNATAKA'</span><span class="p">,</span> <span class="s1">'KERALA'</span><span class="p">,</span> 
              <span class="s1">'MADHYA PRADESH'</span><span class="p">,</span> <span class="s1">'MAHARASHTRA'</span><span class="p">,</span> <span class="s1">'MANIPUR'</span><span class="p">,</span>  <span class="s1">'MEGHALAYA'</span><span class="p">,</span>  <span class="s1">'MIZORAM'</span><span class="p">,</span>  <span class="s1">'NAGALAND'</span><span class="p">,</span>  <span class="s1">'ODISHA'</span><span class="p">,</span> <span class="s1">'ORISSA'</span><span class="p">,</span> <span class="s1">'PUDUCHERRY'</span><span class="p">,</span>
              <span class="s1">'PUNJAB'</span><span class="p">,</span> <span class="s1">'RAJASTHAN'</span><span class="p">,</span> <span class="s1">'SIKKIM'</span><span class="p">,</span> <span class="s1">'TAMIL NADU'</span><span class="p">,</span> <span class="s1">'TELANGANA'</span><span class="p">,</span> <span class="s1">'TRIPURA'</span><span class="p">,</span> <span class="s1">'UTTAR PRADESH'</span><span class="p">,</span> <span class="s1">'UTTARAKHAND'</span><span class="p">,</span> <span class="s1">'WEST BENGAL'</span><span class="p">]</span>

<span class="c1"># statelist = sorted(list(NRDWP_mcdf.StateName.unique()))</span>

<span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Iterate over each state</span>
<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">statelist</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Supplementary Results/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">_Unmatched_NRDWP_data.csv"</span>
    <span class="n">state_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">stateunmatched_csv</span><span class="p">,</span> <span class="n">state_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># statematched_csv.to_csv("Supplementary Results/NRDWP_India_Matched.csv", index=False)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span>
<span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DistrictName'</span><span class="p">,</span> <span class="s1">'BlockName'</span><span class="p">,</span> <span class="s1">'PanchayatName'</span><span class="p">,</span> <span class="s1">'VillageName'</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">"inner"</span><span class="p">)</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[69]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>StateName</th>
<th>DistrictName</th>
<th>BlockName</th>
<th>PanchayatName</th>
<th>VillageName</th>
<th>HabitationName</th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>...</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>ARUNACHAL PRADESH</td>
<td>ANJAW</td>
<td>CHAGLAGAM</td>
<td>KROMNA</td>
<td>TELELENKAP-METALIANG</td>
<td>TELELENKAP-METALIANG</td>
<td>Delivery Point</td>
<td>1606750</td>
<td>45.0</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0.20</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011</td>
<td>3</td>
<td>NaN</td>
<td>586525</td>
</tr>
<tr>
<th>1</th>
<td>ARUNACHAL PRADESH</td>
<td>EAST KAMENG</td>
<td>PAKKE KESSANG</td>
<td>PALIN</td>
<td>PALIN</td>
<td>PALIN</td>
<td>Stream</td>
<td>65376</td>
<td>45.0</td>
<td>250.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>1.00</td>
<td>NaN</td>
<td>0.20</td>
<td>200.0</td>
<td>2011</td>
<td>2</td>
<td>NaN</td>
<td>662975</td>
</tr>
<tr>
<th>2</th>
<td>ARUNACHAL PRADESH</td>
<td>UPPER SUBANSIRI</td>
<td>SIYUM</td>
<td>KAMPONG YORBE</td>
<td>TARING</td>
<td>TARING</td>
<td>Stream</td>
<td>66524</td>
<td>15.6</td>
<td>12.3</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0.26</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>2011</td>
<td>3</td>
<td>NaN</td>
<td>26946</td>
</tr>
<tr>
<th>3</th>
<td>ARUNACHAL PRADESH</td>
<td>UPPER SUBANSIRI</td>
<td>TALIHA</td>
<td>EBA-III</td>
<td>KODAK</td>
<td>KODAK</td>
<td>Stream</td>
<td>66328</td>
<td>21.3</td>
<td>7.4</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0.04</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>12</td>
<td>NaN</td>
<td>26777</td>
</tr>
<tr>
<th>4</th>
<td>ARUNACHAL PRADESH</td>
<td>UPPER SUBANSIRI</td>
<td>TALIHA</td>
<td>EBA-V</td>
<td>DARBA</td>
<td>DARBA</td>
<td>Stream</td>
<td>66339</td>
<td>8.8</td>
<td>9.9</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0.02</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>12</td>
<td>NaN</td>
<td>26785</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29172</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>KURMAN PUR</td>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>20.0</td>
<td>3.52</td>
<td>NaN</td>
<td>1.13</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29173</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>KURMAN PUR</td>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>5.0</td>
<td>30.0</td>
<td>0.37</td>
<td>NaN</td>
<td>1.16</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29174</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.54</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2018</td>
<td>6</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29175</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>25.0</td>
<td>0.64</td>
<td>NaN</td>
<td>0.94</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29176</th>
<td>WEST BENGAL</td>
<td>DAKSHIN DINAJPUR</td>
<td>HARIRAMPUR</td>
<td>SAIYEDPUR</td>
<td>KURMANPUR        (I)</td>
<td>VITIHAR</td>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.0</td>
<td>2.0</td>
<td>0.83</td>
<td>NaN</td>
<td>1.55</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
</tbody>
</table>
<p>29177 rows × 22 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=ba4961ab-540d-4789-b7a8-cf876eaab17e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2d9ef9dd-c703-4fe3-983f-9ca494779b80">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 28px;">
    Final Preprocessing Steps
</div>
<a id="final-preprocessing-steps"></a>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
After matching the previously unmatched NRDWP village records with their corresponding <code>Villageid</code>s, we now apply the same preprocessing steps used for earlier matched datasets. This includes converting pollutant values to numeric, aggregating values at the village-month level (computing both mean and maximum), and extracting the most frequent water source type. Duplicates are removed to ensure each village-month pair is unique. The processed dataset is then merged with the <code>Village_ID_df.csv</code> to append additional metadata and finally integrated with the master water quality dataset <code>WQ_INDIA_JJM-NRDWP_VL.csv</code>. This comprehensive dataset now covers both previously matched and newly resolved NRDWP entries, standardized and ready for downstream analysis.

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=96b1672a-7c27-435c-8976-52069d78c241">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">stateunmatched_csv</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="p">[[</span><span class="s1">'TypeOfSource'</span><span class="p">,</span> <span class="s1">'HabitationId'</span><span class="p">,</span> <span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span> <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> 
                      <span class="s1">'Manganese'</span><span class="p">,</span> <span class="s1">'Sulphates'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span><span class="s1">'Month'</span><span class="p">,</span> <span class="s1">'VillageId'</span><span class="p">,</span> <span class="s1">'Villageid'</span><span class="p">]]</span>
<span class="n">stateunmatched_csv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[70]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>TypeOfSource</th>
<th>HabitationId</th>
<th>Nitrate</th>
<th>Chloride</th>
<th>Fluoride</th>
<th>Arsenic</th>
<th>E.Coli</th>
<th>Total Coliform</th>
<th>Iron</th>
<th>Magnesium</th>
<th>Manganese</th>
<th>Sulphates</th>
<th>Year</th>
<th>Month</th>
<th>VillageId</th>
<th>Villageid</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Delivery Point</td>
<td>1606750</td>
<td>45.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.20</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011</td>
<td>3</td>
<td>NaN</td>
<td>586525</td>
</tr>
<tr>
<th>1</th>
<td>Stream</td>
<td>65376</td>
<td>45.0</td>
<td>250.0</td>
<td>0.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.00</td>
<td>NaN</td>
<td>0.20</td>
<td>200.0</td>
<td>2011</td>
<td>2</td>
<td>NaN</td>
<td>662975</td>
</tr>
<tr>
<th>2</th>
<td>Stream</td>
<td>66524</td>
<td>15.6</td>
<td>12.3</td>
<td>0.52</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.26</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>2011</td>
<td>3</td>
<td>NaN</td>
<td>26946</td>
</tr>
<tr>
<th>3</th>
<td>Stream</td>
<td>66328</td>
<td>21.3</td>
<td>7.4</td>
<td>0.60</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.04</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>12</td>
<td>NaN</td>
<td>26777</td>
</tr>
<tr>
<th>4</th>
<td>Stream</td>
<td>66339</td>
<td>8.8</td>
<td>9.9</td>
<td>0.40</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.02</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2010</td>
<td>12</td>
<td>NaN</td>
<td>26785</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29172</th>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>0.54</td>
<td>NaN</td>
<td>0.0</td>
<td>20.0</td>
<td>3.52</td>
<td>NaN</td>
<td>1.13</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29173</th>
<td>Shallow Tubewell</td>
<td>1288897</td>
<td>NaN</td>
<td>NaN</td>
<td>0.49</td>
<td>NaN</td>
<td>5.0</td>
<td>30.0</td>
<td>0.37</td>
<td>NaN</td>
<td>1.16</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29174</th>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>0.67</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>0.54</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2018</td>
<td>6</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29175</th>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>0.58</td>
<td>NaN</td>
<td>0.0</td>
<td>25.0</td>
<td>0.64</td>
<td>NaN</td>
<td>0.94</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
<tr>
<th>29176</th>
<td>Shallow Tubewell</td>
<td>1288896</td>
<td>NaN</td>
<td>NaN</td>
<td>0.87</td>
<td>NaN</td>
<td>0.0</td>
<td>2.0</td>
<td>0.83</td>
<td>NaN</td>
<td>1.55</td>
<td>NaN</td>
<td>2019</td>
<td>3</td>
<td>NaN</td>
<td>486479</td>
</tr>
</tbody>
</table>
<p>29177 rows × 16 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4d7aa32a-cf73-4ce3-82de-372c2b49a8b5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Defining the pollutant columns</span>
<span class="n">pollutant_columns</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'Nitrate'</span><span class="p">,</span> <span class="s1">'Chloride'</span><span class="p">,</span> <span class="s1">'Fluoride'</span><span class="p">,</span> <span class="s1">'Arsenic'</span><span class="p">,</span> <span class="s1">'E.Coli'</span><span class="p">,</span>
                      <span class="s1">'Total Coliform'</span><span class="p">,</span> <span class="s1">'Iron'</span><span class="p">,</span> <span class="s1">'Magnesium'</span><span class="p">,</span> <span class="s1">'Manganese'</span><span class="p">,</span> <span class="s1">'Sulphates'</span><span class="p">]</span>

<span class="c1"># Converting all Pollutans column to Numeric</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">:</span>
    <span class="n">stateunmatched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">stateunmatched_csv</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>
        
<span class="c1"># Defining the aggregation logic</span>
<span class="n">aggregation_logic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">aggregation_logic</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="p">[</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'max'</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pollutant_columns</span><span class="p">}</span>
<span class="n">aggregation_logic</span><span class="p">[</span><span class="s1">'TypeOfSource'</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># Most frequent value</span>

<span class="c1"># Performing the aggregation</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">stateunmatched_csv</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Villageid'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggregation_logic</span><span class="p">)</span>

<span class="c1"># Flattening the multi-level column index after aggregation</span>
<span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="c1"># Rename the columns for clarity</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'TypeOfSource &lt;lambda&gt;'</span> <span class="p">:</span> <span class="s1">'Source_type'</span><span class="p">})</span>

<span class="c1"># Reset the index for a flat dataframe</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">aggregated_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Villageid</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Total Coliform max</th>
<th>Iron mean</th>
<th>Iron max</th>
<th>Magnesium mean</th>
<th>Magnesium max</th>
<th>Manganese mean</th>
<th>Manganese max</th>
<th>Sulphates mean</th>
<th>Sulphates max</th>
<th>Source_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>26777</td>
<td>2010</td>
<td>12</td>
<td>21.3</td>
<td>21.3</td>
<td>7.40</td>
<td>7.40</td>
<td>0.600</td>
<td>0.60</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0400</td>
<td>0.04</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>1</th>
<td>26777</td>
<td>2011</td>
<td>12</td>
<td>23.8</td>
<td>26.8</td>
<td>9.70</td>
<td>10.90</td>
<td>0.615</td>
<td>0.72</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.2775</td>
<td>0.31</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>2</th>
<td>26777</td>
<td>2014</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.0200</td>
<td>0.02</td>
<td>NaN</td>
<td>NaN</td>
<td>0.02</td>
<td>0.02</td>
<td>NaN</td>
<td>NaN</td>
<td>Delivery Point</td>
</tr>
<tr>
<th>3</th>
<td>26779</td>
<td>2011</td>
<td>12</td>
<td>26.4</td>
<td>26.4</td>
<td>9.06</td>
<td>9.06</td>
<td>0.320</td>
<td>0.32</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.2500</td>
<td>0.25</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>4</th>
<td>26780</td>
<td>2011</td>
<td>12</td>
<td>18.9</td>
<td>18.9</td>
<td>10.40</td>
<td>10.40</td>
<td>0.610</td>
<td>0.61</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.2200</td>
<td>0.22</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>3237</th>
<td>703102</td>
<td>2017</td>
<td>11</td>
<td>35.0</td>
<td>35.0</td>
<td>34.00</td>
<td>34.00</td>
<td>0.500</td>
<td>0.50</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>31.0</td>
<td>31.0</td>
<td>NaN</td>
<td>NaN</td>
<td>20.0</td>
<td>20.0</td>
<td>Deep Tubewell</td>
</tr>
<tr>
<th>3238</th>
<td>703697</td>
<td>2014</td>
<td>11</td>
<td>45.0</td>
<td>45.0</td>
<td>250.00</td>
<td>250.00</td>
<td>1.000</td>
<td>1.00</td>
<td>0.01</td>
<td>...</td>
<td>NaN</td>
<td>0.3000</td>
<td>0.30</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>3239</th>
<td>703697</td>
<td>2015</td>
<td>8</td>
<td>NaN</td>
<td>NaN</td>
<td>300.00</td>
<td>300.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>3240</th>
<td>703697</td>
<td>2015</td>
<td>12</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
<tr>
<th>3241</th>
<td>703697</td>
<td>2017</td>
<td>7</td>
<td>45.0</td>
<td>45.0</td>
<td>380.00</td>
<td>380.00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>0.3000</td>
<td>0.30</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Stream</td>
</tr>
</tbody>
</table>
<p>3242 rows × 24 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c113962b-c8d5-4d05-a702-ed746ea9f0c3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">vid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/Village_ID_df.csv"</span><span class="p">)</span>
<span class="n">vid</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">vid</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'VillageId'</span><span class="p">])</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">'VillageId'</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">'first'</span><span class="p">)</span>
<span class="n">vid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[73]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>HATMULLA</td>
<td>134907</td>
<td>111.0</td>
<td>1</td>
<td>1</td>
<td>134907</td>
</tr>
<tr>
<th>1</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>PARRAYPORA</td>
<td>134908</td>
<td>102.0</td>
<td>1</td>
<td>1</td>
<td>134908</td>
</tr>
<tr>
<th>2</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>NAGRI MALPORA</td>
<td>134909</td>
<td>115.0</td>
<td>1</td>
<td>1</td>
<td>134909</td>
</tr>
<tr>
<th>3</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>OGABAL</td>
<td>134912</td>
<td>106.0</td>
<td>1</td>
<td>1</td>
<td>134912</td>
</tr>
<tr>
<th>4</th>
<td>Jammu &amp; Kashmir</td>
<td>14</td>
<td>KUPWARA</td>
<td>172</td>
<td>KANDI KHAS</td>
<td>134913</td>
<td>168.0</td>
<td>1</td>
<td>1</td>
<td>134913</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>582654</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BEDPA</td>
<td>92207</td>
<td>524994.0</td>
<td>39</td>
<td>496</td>
<td>92207</td>
</tr>
<tr>
<th>582655</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>KHEDPA</td>
<td>92208</td>
<td>524996.0</td>
<td>39</td>
<td>496</td>
<td>92208</td>
</tr>
<tr>
<th>582656</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>SINDONI</td>
<td>92209</td>
<td>524995.0</td>
<td>39</td>
<td>496</td>
<td>92209</td>
</tr>
<tr>
<th>582657</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>BESDA</td>
<td>92210</td>
<td>524993.0</td>
<td>39</td>
<td>496</td>
<td>92210</td>
</tr>
<tr>
<th>582658</th>
<td>D &amp; N Haveli</td>
<td>7</td>
<td>DADRA AND NAGAR HAVELI</td>
<td>102</td>
<td>VANSDA</td>
<td>92211</td>
<td>524992.0</td>
<td>39</td>
<td>496</td>
<td>92211</td>
</tr>
</tbody>
</table>
<p>582659 rows × 10 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=14089927-3c39-4566-aaf5-70629c5b658c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [74]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ensure HabitationId is numeric in both DataFrames</span>
<span class="c1"># Convert HabitationId to numeric (integer)</span>
<span class="n">vid</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">vid</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>
<span class="n">aggregated_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">aggregated_df</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'Int64'</span><span class="p">)</span>

<span class="c1"># Drop rows where HabitationId is NaN after conversion</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">])</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'Villageid'</span><span class="p">])</span>

<span class="c1"># Perform a left join</span>
<span class="n">aggregated_df</span> <span class="o">=</span> <span class="n">aggregated_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"Villageid"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
<span class="n">aggregated_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[74]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Villageid</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
<th>VillageId</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>26777</td>
<td>2010</td>
<td>12</td>
<td>21.3</td>
<td>21.3</td>
<td>7.40</td>
<td>7.40</td>
<td>0.600</td>
<td>0.60</td>
<td>NaN</td>
<td>...</td>
<td>Stream</td>
<td>Arunachal Pradesh</td>
<td>3</td>
<td>UPPER SUBANSIRI</td>
<td>30</td>
<td>KODAK</td>
<td>262966.0</td>
<td>12</td>
<td>249</td>
<td>26777</td>
</tr>
<tr>
<th>1</th>
<td>26777</td>
<td>2011</td>
<td>12</td>
<td>23.8</td>
<td>26.8</td>
<td>9.70</td>
<td>10.90</td>
<td>0.615</td>
<td>0.72</td>
<td>NaN</td>
<td>...</td>
<td>Stream</td>
<td>Arunachal Pradesh</td>
<td>3</td>
<td>UPPER SUBANSIRI</td>
<td>30</td>
<td>KODAK</td>
<td>262966.0</td>
<td>12</td>
<td>249</td>
<td>26777</td>
</tr>
<tr>
<th>2</th>
<td>26777</td>
<td>2014</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Arunachal Pradesh</td>
<td>3</td>
<td>UPPER SUBANSIRI</td>
<td>30</td>
<td>KODAK</td>
<td>262966.0</td>
<td>12</td>
<td>249</td>
<td>26777</td>
</tr>
<tr>
<th>3</th>
<td>26779</td>
<td>2011</td>
<td>12</td>
<td>26.4</td>
<td>26.4</td>
<td>9.06</td>
<td>9.06</td>
<td>0.320</td>
<td>0.32</td>
<td>NaN</td>
<td>...</td>
<td>Stream</td>
<td>Arunachal Pradesh</td>
<td>3</td>
<td>UPPER SUBANSIRI</td>
<td>30</td>
<td>MOTUNG</td>
<td>262974.0</td>
<td>12</td>
<td>249</td>
<td>26779</td>
</tr>
<tr>
<th>4</th>
<td>26780</td>
<td>2011</td>
<td>12</td>
<td>18.9</td>
<td>18.9</td>
<td>10.40</td>
<td>10.40</td>
<td>0.610</td>
<td>0.61</td>
<td>NaN</td>
<td>...</td>
<td>Stream</td>
<td>Arunachal Pradesh</td>
<td>3</td>
<td>UPPER SUBANSIRI</td>
<td>30</td>
<td>NOGI</td>
<td>262975.0</td>
<td>12</td>
<td>249</td>
<td>26780</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2342</th>
<td>674768</td>
<td>2013</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Shallow Tubewell</td>
<td>Maharashtra</td>
<td>18</td>
<td>NAGPUR</td>
<td>298</td>
<td>CHANDRAPUR</td>
<td>1887291.0</td>
<td>27</td>
<td>505</td>
<td>674768</td>
</tr>
<tr>
<th>2343</th>
<td>674768</td>
<td>2013</td>
<td>3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Shallow Tubewell</td>
<td>Maharashtra</td>
<td>18</td>
<td>NAGPUR</td>
<td>298</td>
<td>CHANDRAPUR</td>
<td>1887291.0</td>
<td>27</td>
<td>505</td>
<td>674768</td>
</tr>
<tr>
<th>2344</th>
<td>674768</td>
<td>2013</td>
<td>6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Shallow Tubewell</td>
<td>Maharashtra</td>
<td>18</td>
<td>NAGPUR</td>
<td>298</td>
<td>CHANDRAPUR</td>
<td>1887291.0</td>
<td>27</td>
<td>505</td>
<td>674768</td>
</tr>
<tr>
<th>2345</th>
<td>675030</td>
<td>2013</td>
<td>3</td>
<td>56.0</td>
<td>56.0</td>
<td>410.00</td>
<td>410.00</td>
<td>4.710</td>
<td>4.71</td>
<td>NaN</td>
<td>...</td>
<td>Deep Tubewell</td>
<td>Rajasthan</td>
<td>27</td>
<td>NAGAUR</td>
<td>403</td>
<td>ACHHOTAI</td>
<td>1889982.0</td>
<td>8</td>
<td>112</td>
<td>675030</td>
</tr>
<tr>
<th>2346</th>
<td>675030</td>
<td>2016</td>
<td>5</td>
<td>225.0</td>
<td>225.0</td>
<td>970.00</td>
<td>970.00</td>
<td>2.800</td>
<td>2.80</td>
<td>NaN</td>
<td>...</td>
<td>Deep Tubewell</td>
<td>Rajasthan</td>
<td>27</td>
<td>NAGAUR</td>
<td>403</td>
<td>ACHHOTAI</td>
<td>1889982.0</td>
<td>8</td>
<td>112</td>
<td>675030</td>
</tr>
</tbody>
</table>
<p>2347 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=b71b7780-f785-47d2-b667-2491bba10deb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [75]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"Supplementary Results/WQ_INDIA_JJM-NRDWP_VL.csv"</span><span class="p">)</span>
<span class="n">WQ_combined_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[75]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2642</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>MALLIPUDI</td>
<td>2642</td>
<td>582966.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>2647</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>K.G.PUDI</td>
<td>2647</td>
<td>582989.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>2648</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>SSR PURAM</td>
<td>2648</td>
<td>582990.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>2649</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>PKR PURAM</td>
<td>2649</td>
<td>582991.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>2650</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>RAMASWAMIPETA</td>
<td>2650</td>
<td>582992.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9405769</th>
<td>677747</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>CHOOHARPUR</td>
<td>677747</td>
<td>1906383.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405770</th>
<td>677750</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>JATPURA BAGUN</td>
<td>677750</td>
<td>1906386.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405771</th>
<td>677751</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>KHARAGWARI</td>
<td>677751</td>
<td>1906387.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405772</th>
<td>677753</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>MIRZAPUR</td>
<td>677753</td>
<td>1906391.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405773</th>
<td>694320</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Mau</td>
<td>518</td>
<td>GARAVA</td>
<td>694320</td>
<td>1225958.0</td>
<td>9</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>9405774 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=db52cfe9-1365-4072-9992-4b2b7c7e3fe7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [76]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">WQ_combined_df</span><span class="p">,</span> <span class="n">aggregated_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Month'</span><span class="p">,</span> <span class="s1">'VillageId'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>

<span class="n">WQ_combined_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[76]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2642</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>MALLIPUDI</td>
<td>2642</td>
<td>582966.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>2647</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>K.G.PUDI</td>
<td>2647</td>
<td>582989.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>2648</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>SSR PURAM</td>
<td>2648</td>
<td>582990.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>2649</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>PKR PURAM</td>
<td>2649</td>
<td>582991.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>2650</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>RAMASWAMIPETA</td>
<td>2650</td>
<td>582992.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9405769</th>
<td>677747</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>CHOOHARPUR</td>
<td>677747</td>
<td>1906383.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405770</th>
<td>677750</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>JATPURA BAGUN</td>
<td>677750</td>
<td>1906386.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405771</th>
<td>677751</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>KHARAGWARI</td>
<td>677751</td>
<td>1906387.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405772</th>
<td>677753</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>MIRZAPUR</td>
<td>677753</td>
<td>1906391.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405773</th>
<td>694320</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Mau</td>
<td>518</td>
<td>GARAVA</td>
<td>694320</td>
<td>1225958.0</td>
<td>9</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>9408121 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d0184909-fec8-4cbf-9acb-a3eaa6a37f0e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [77]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">WQ_combined_df</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s2">"first"</span><span class="p">)</span>
<span class="n">duplicate_count</span> <span class="o">=</span> <span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"VillageId"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Count duplicates</span>
<span class="nb">print</span><span class="p">(</span><span class="n">duplicate_count</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">WQ_combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>62
0
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>VillageId</th>
<th>Year</th>
<th>Month</th>
<th>Nitrate mean</th>
<th>Nitrate max</th>
<th>Chloride mean</th>
<th>Chloride max</th>
<th>Fluoride mean</th>
<th>Fluoride max</th>
<th>Arsenic mean</th>
<th>...</th>
<th>Source_type</th>
<th>State</th>
<th>StateId</th>
<th>District</th>
<th>DistrictId</th>
<th>Village</th>
<th>Villageid</th>
<th>Census Village Code</th>
<th>Census_State</th>
<th>Census_District</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2642</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>530.000000</td>
<td>530.0</td>
<td>0.400000</td>
<td>0.4</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>MALLIPUDI</td>
<td>2642</td>
<td>582966.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>1</th>
<td>2647</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>124.285714</td>
<td>330.0</td>
<td>0.657143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>K.G.PUDI</td>
<td>2647</td>
<td>582989.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>2</th>
<td>2648</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>125.714286</td>
<td>250.0</td>
<td>0.457143</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>SSR PURAM</td>
<td>2648</td>
<td>582990.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>3</th>
<td>2649</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>153.333333</td>
<td>180.0</td>
<td>0.800000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>PKR PURAM</td>
<td>2649</td>
<td>582991.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>4</th>
<td>2650</td>
<td>2009</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>617.500000</td>
<td>1310.0</td>
<td>0.500000</td>
<td>0.8</td>
<td>NaN</td>
<td>...</td>
<td>Delivery Point</td>
<td>Andhra Pradesh</td>
<td>2</td>
<td>VIZIANAGARAM</td>
<td>4</td>
<td>RAMASWAMIPETA</td>
<td>2650</td>
<td>582992.0</td>
<td>37</td>
<td>543</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>9405769</th>
<td>677747</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>CHOOHARPUR</td>
<td>677747</td>
<td>1906383.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405770</th>
<td>677750</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>JATPURA BAGUN</td>
<td>677750</td>
<td>1906386.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405771</th>
<td>677751</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>KHARAGWARI</td>
<td>677751</td>
<td>1906387.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405772</th>
<td>677753</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>MORADABAD</td>
<td>460</td>
<td>MIRZAPUR</td>
<td>677753</td>
<td>1906391.0</td>
<td>9</td>
<td>135</td>
</tr>
<tr>
<th>9405773</th>
<td>694320</td>
<td>2025</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>Delivery points</td>
<td>Uttar Pradesh</td>
<td>31</td>
<td>Mau</td>
<td>518</td>
<td>GARAVA</td>
<td>694320</td>
<td>1225958.0</td>
<td>9</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>9408090 rows × 33 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=24f6f0f6-858b-4606-ac63-d870d92a71ac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div style="text-align: left; color: navy; font-weight: bold; font-size: 38px;">
    Completed JJM-NRDWP Dataset with Correct IDs
</div>
<a id="completed-dataset"></a>
<div style="font-size: 25px; line-height: 1.8; text-align: justify;">
<i><b>Finally we have obtained the right final version of Preprocessed JJM-NRDWP data is prepared with correct IDs and ready for all further analysis</b></i>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=89bbf76d-9941-4942-9890-f2ab492ab580">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [80]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">WQ_combined_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"WQ_INDIA_JJM-NRDWP_VLC.csv"</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=5f361117-ed00-4dd9-bfd3-ff3cbf604521">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=bb38db17-188b-4220-9d30-4df25a653086">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=2d83d58c-94ef-432b-bc61-bda95e38de69">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=bd9774b2-8d3a-4a83-b31c-bc3c2915f4b7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=6c934679-d3c7-4b36-aa93-b0d1594b1ec5">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div></div></div></div></div></main>
</body>
</html>
